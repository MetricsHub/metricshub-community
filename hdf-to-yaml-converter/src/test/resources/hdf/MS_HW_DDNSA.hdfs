////////////////////////////////////////////////////////////////
//
//    H a r d w a r e   D e f i n i t i o n   F i l e
//
//                       f o r
//
//                 Hardware Sentry
//
//               by Sentry Software (c)
//
//
//      Supports: DataDirect Networks (DDN) Storage Appliance
//                Connects to DDN's SNMP Agent
//


//
// Header
//

hdf.DisplayName="DataDirect Networks (DDN) Storage Appliance (SNMP)"
hdf.TypicalPlatform="DataDirect Networks (DDN)"
hdf.ReliesOn="DDN SNMP Agent"
hdf.Version="1.0"
hdf.Comments="This connector discovers the enclosure and the disks of DDN (DataDirect Networks) Storage Appliances as well as the various environment sensors (temperatures, fans, power supplies). It relies on the SNMP protocol."
hdf.RemoteSupport="true"
hdf.LocalSupport="false"
hdf.AppliesToOS="Storage"

//
// Detection
//

// Verify that the DDN SNMP Storage Appliance agent responds to our requests
Detection.Criteria(1).Type="SNMP"
Detection.Criteria(1).SnmpGetNext="1.3.6.1.4.1.6894.2"


//
// Enclosure
//

//
// Discovery

// Source(1) = Hardcoded table
// DeviceID;Vendor;model;
Enclosure.Discovery.Source(1)="DDNSA;Data Direct Networks;Storage Appliance;"

// InstanceTable = Source(1)
Enclosure.Discovery.InstanceTable=%Enclosure.Discovery.Source(1)%
Enclosure.Discovery.Instance.DeviceID=InstanceTable.Column(1)
Enclosure.Discovery.Instance.Vendor=InstanceTable.Column(2)
Enclosure.Discovery.Instance.Model=InstanceTable.Column(3)
Enclosure.Discovery.Instance.Type="Storage"

//
// PHYSICAL DISKS
//

//
// Discovery

// Source(1) = tierTable SNMP Table
// PoolID;DiskWWN;DiskEnclosure;DiskSlot;
PhysicalDisk.Discovery.Source(1).Type="SnmpTable"
PhysicalDisk.Discovery.Source(1).SnmpTableOid="1.3.6.1.4.1.6894.2.9.1"
PhysicalDisk.Discovery.Source(1).SnmpTableSelectColumns="2,4,5,6"

// Add an underscore to the left of the DiskSlot
// PoolID;DiskWWN;DiskEnclosure;DiskSlot;
PhysicalDisk.Discovery.Source(1).Compute(1).Type="LeftConcat"
PhysicalDisk.Discovery.Source(1).Compute(1).Column=4
PhysicalDisk.Discovery.Source(1).Compute(1).String="_"

// Add the DiskEnclosure to the DiskSlot to make the Disk Identfier
// PoolID;DiskWWN;DiskEnclosure;DiskID;
PhysicalDisk.Discovery.Source(1).Compute(2).Type="LeftConcat"
PhysicalDisk.Discovery.Source(1).Compute(2).Column=4
PhysicalDisk.Discovery.Source(1).Compute(2).String=Column(3)

// Add WWN= to the WWN Column
// PoolID;DiskWWN;DiskEnclosure;DiskSlot;
PhysicalDisk.Discovery.Source(1).Compute(3).Type="LeftConcat"
PhysicalDisk.Discovery.Source(1).Compute(3).Column=2
PhysicalDisk.Discovery.Source(1).Compute(3).String="WWN: "

// Add PoolID= to the PoolID Column
// PoolID;DiskWWN;DiskEnclosure;DiskSlot;
PhysicalDisk.Discovery.Source(1).Compute(4).Type="LeftConcat"
PhysicalDisk.Discovery.Source(1).Compute(4).Column=1
PhysicalDisk.Discovery.Source(1).Compute(4).String="Pool ID: "

// InstanceTable = Source(1)
// PoolID;DiskWWN;DiskEnclosure;DiskID;
PhysicalDisk.Discovery.InstanceTable=%PhysicalDisk.Discovery.Source(1)%
PhysicalDisk.Discovery.Instance.DeviceID=InstanceTable.Column(4)
PhysicalDisk.Discovery.Instance.DisplayID=InstanceTable.Column(4)
PhysicalDisk.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(1)
PhysicalDisk.Discovery.Instance.AdditionalInformation2=InstanceTable.Column(2)
PhysicalDisk.Discovery.Instance.AttachedToDeviceID="DDNSA"


//
// Collect

// Collect type is multi-instance
PhysicalDisk.Collect.Type="MultiInstance"

// Source(1) = tierTable SNMP Table
// DiskEnclosure;DiskSlot;DiskState;
PhysicalDisk.Collect.Source(1).Type="SnmpTable"
PhysicalDisk.Collect.Source(1).SnmpTableOid="1.3.6.1.4.1.6894.2.9.1"
PhysicalDisk.Collect.Source(1).SnmpTableSelectColumns="5,6,7"

// Add an underscore to the left of the DiskSlot
// DiskEnclosure;DiskSlot;DiskState;
PhysicalDisk.Collect.Source(1).Compute(1).Type="LeftConcat"
PhysicalDisk.Collect.Source(1).Compute(1).Column=2
PhysicalDisk.Collect.Source(1).Compute(1).String="_"

// Add the DiskEnclosure to the DiskSlot to make the Disk Identfier
// DiskEnclosure;DiskID;DiskState;
PhysicalDisk.Collect.Source(1).Compute(2).Type="LeftConcat"
PhysicalDisk.Collect.Source(1).Compute(2).Column=2
PhysicalDisk.Collect.Source(1).Compute(2).String=Column(1)

// Duplicate the Status column
// DiskEnclosure;DiskID;DiskState;DiskState;
PhysicalDisk.Collect.Source(1).Compute(3).Type="DuplicateColumn"
PhysicalDisk.Collect.Source(1).Compute(3).Column=3

// Translate the first status column into a PATROLStatus
// DiskEnclosure;DiskID;PatrolStatus;DiskState;
PhysicalDisk.Collect.Source(1).Compute(4).Type="Translate"
PhysicalDisk.Collect.Source(1).Compute(4).Column=3
PhysicalDisk.Collect.Source(1).Compute(4).TranslationTable="diskStatusTranslationTable"

// The diskStatusTranslationTable
diskStatusTranslationTable(1)="OK"
diskStatusTranslationTable(2)="ALARM"
diskStatusTranslationTable(3)="WARN"
diskStatusTranslationTable(Default)="UNKNOWN"

// Translate the second status column into a more readable string
// DiskEnclosure;DiskID;PatrolStatus;StatusInformation;
PhysicalDisk.Collect.Source(1).Compute(5).Type="Translate"
PhysicalDisk.Collect.Source(1).Compute(5).Column=4
PhysicalDisk.Collect.Source(1).Compute(5).TranslationTable="diskStatusInformationTranslationTable"

// The diskStatusInformationTranslationTable
diskStatusInformationTranslationTable(1)="Healthy"
diskStatusInformationTranslationTable(2)="Failed"
diskStatusInformationTranslationTable(3)="Predicted Failure"
diskStatusInformationTranslationTable(Default)="Unknown Status"

// DiskEnclosure;DiskID;PatrolStatus;StatusInformation;
// ValueTable = Source(1)
PhysicalDisk.Collect.ValueTable=%PhysicalDisk.Collect.Source(1)%
PhysicalDisk.Collect.DeviceID=ValueTable.Column(2)
PhysicalDisk.Collect.Status=ValueTable.Column(3)
PhysicalDisk.Collect.StatusInformation=ValueTable.Column(4)

//
// PowerSupply.
//

//
// Discovery

// Source(1) =  SNMP Table
// EnclosureID;PositionInEnclosure;
PowerSupply.Discovery.Source(1).Type="SnmpTable"
PowerSupply.Discovery.Source(1).SnmpTableOid="1.3.6.1.4.1.6894.2.6.1"
PowerSupply.Discovery.Source(1).SnmpTableSelectColumns="2,3"

// Add an underscore to the left of the PositionInEnclosure
// EnclosureID;PositionInEnclosure;
PowerSupply.Discovery.Source(1).Compute(1).Type="LeftConcat"
PowerSupply.Discovery.Source(1).Compute(1).Column=2
PowerSupply.Discovery.Source(1).Compute(1).String="_"

// Add the EnclosureID to the PositionInEnclosure to make the PSU Identfier
// EnclosureID;PowerSupplyID;
PowerSupply.Discovery.Source(1).Compute(2).Type="LeftConcat"
PowerSupply.Discovery.Source(1).Compute(2).Column=2
PowerSupply.Discovery.Source(1).Compute(2).String=Column(1)

// InstanceTable = Source(1)
// PoolID;DiskWWN;DiskEnclosure;DiskID;
PowerSupply.Discovery.InstanceTable=%PowerSupply.Discovery.Source(1)%
PowerSupply.Discovery.Instance.DeviceID=InstanceTable.Column(2)
PowerSupply.Discovery.Instance.DisplayID=InstanceTable.Column(2)
PowerSupply.Discovery.Instance.AttachedToDeviceID="DDNSA"


//
// Collect

// Collect type is multi-instance
PowerSupply.Collect.Type="MultiInstance"

// Source(1) =  SNMP Table
// EnclosureID;PositionInEnclosure;Status;
PowerSupply.Collect.Source(1).Type="SnmpTable"
PowerSupply.Collect.Source(1).SnmpTableOid="1.3.6.1.4.1.6894.2.6.1"
PowerSupply.Collect.Source(1).SnmpTableSelectColumns="2,3,4"

// Add an underscore to the left of the PositionInEnclosure
// EnclosureID;PositionInEnclosure;Status;
PowerSupply.Collect.Source(1).Compute(1).Type="LeftConcat"
PowerSupply.Collect.Source(1).Compute(1).Column=2
PowerSupply.Collect.Source(1).Compute(1).String="_"

// Add the EnclosureID to the PositionInEnclosure to make the PSU Identfier
// EnclosureID;PowerSupplyID;Status;
PowerSupply.Collect.Source(1).Compute(2).Type="LeftConcat"
PowerSupply.Collect.Source(1).Compute(2).Column=2
PowerSupply.Collect.Source(1).Compute(2).String=Column(1)

// Translate the  status column into a PATROLStatus
// DiskEnclosure;DiskID;PatrolStatus;
PowerSupply.Collect.Source(1).Compute(3).Type="Translate"
PowerSupply.Collect.Source(1).Compute(3).Column=3
PowerSupply.Collect.Source(1).Compute(3).TranslationTable="PSUandFANStatusTranslationTable"

// The PSUandFANStatusTranslationTable
PSUandFANStatusTranslationTable(1)="OK"
PSUandFANStatusTranslationTable(2)="ALARM"
PSUandFANStatusTranslationTable(Default)="UNKNOWN"

// DiskEnclosure;DiskID;PatrolStatus;StatusInformation;
// ValueTable = Source(1)
PowerSupply.Collect.ValueTable=%PowerSupply.Collect.Source(1)%
PowerSupply.Collect.DeviceID=ValueTable.Column(2)
PowerSupply.Collect.Status=ValueTable.Column(3)


//
// Fan.
//

//
// Discovery

// Source(1) =  SNMP Table
// EnclosureID;PositionInEnclosure;
Fan.Discovery.Source(1).Type="SnmpTable"
Fan.Discovery.Source(1).SnmpTableOid="1.3.6.1.4.1.6894.2.4.1"
Fan.Discovery.Source(1).SnmpTableSelectColumns="2,3"

// Add an underscore to the left of the PositionInEnclosure
// EnclosureID;PositionInEnclosure;
Fan.Discovery.Source(1).Compute(1).Type="LeftConcat"
Fan.Discovery.Source(1).Compute(1).Column=2
Fan.Discovery.Source(1).Compute(1).String="_"

// Add the EnclosureID to the PositionInEnclosure to make the PSU Identfier
// EnclosureID;PowerSupplyID;
Fan.Discovery.Source(1).Compute(2).Type="LeftConcat"
Fan.Discovery.Source(1).Compute(2).Column=2
Fan.Discovery.Source(1).Compute(2).String=Column(1)

// InstanceTable = Source(1)
// PoolID;DiskWWN;DiskEnclosure;DiskID;
Fan.Discovery.InstanceTable=%Fan.Discovery.Source(1)%
Fan.Discovery.Instance.DeviceID=InstanceTable.Column(2)
Fan.Discovery.Instance.DisplayID=InstanceTable.Column(2)
Fan.Discovery.Instance.AttachedToDeviceID="DDNSA"


//
// Collect

// Collect type is multi-instance
Fan.Collect.Type="MultiInstance"

// Source(1) =  SNMP Table
// EnclosureID;PositionInEnclosure;Status;
Fan.Collect.Source(1).Type="SnmpTable"
Fan.Collect.Source(1).SnmpTableOid="1.3.6.1.4.1.6894.2.4.1"
Fan.Collect.Source(1).SnmpTableSelectColumns="2,3,4"

// Add an underscore to the left of the PositionInEnclosure
// EnclosureID;PositionInEnclosure;Status;
Fan.Collect.Source(1).Compute(1).Type="LeftConcat"
Fan.Collect.Source(1).Compute(1).Column=2
Fan.Collect.Source(1).Compute(1).String="_"

// Add the EnclosureID to the PositionInEnclosure to make the PSU Identfier
// EnclosureID;PowerSupplyID;Status;
Fan.Collect.Source(1).Compute(2).Type="LeftConcat"
Fan.Collect.Source(1).Compute(2).Column=2
Fan.Collect.Source(1).Compute(2).String=Column(1)

// Translate the  status column into a PATROLStatus
// DiskEnclosure;DiskID;PatrolStatus;
Fan.Collect.Source(1).Compute(3).Type="Translate"
Fan.Collect.Source(1).Compute(3).Column=3
Fan.Collect.Source(1).Compute(3).TranslationTable="PSUandFANStatusTranslationTable"

// DiskEnclosure;DiskID;PatrolStatus;StatusInformation;
// ValueTable = Source(1)
Fan.Collect.ValueTable=%Fan.Collect.Source(1)%
Fan.Collect.DeviceID=ValueTable.Column(2)
Fan.Collect.Status=ValueTable.Column(3)

//
// Temperature.
//

//
// Discovery

// Source(1) =  SNMP Table
// EnclosureID;PositionInEnclosure;
Temperature.Discovery.Source(1).Type="SnmpTable"
Temperature.Discovery.Source(1).SnmpTableOid="1.3.6.1.4.1.6894.2.6.1"
Temperature.Discovery.Source(1).SnmpTableSelectColumns="2,3"

// Add an underscore to the left of the PositionInEnclosure
// EnclosureID;PositionInEnclosure;
Temperature.Discovery.Source(1).Compute(1).Type="LeftConcat"
Temperature.Discovery.Source(1).Compute(1).Column=2
Temperature.Discovery.Source(1).Compute(1).String="_"

// Add the EnclosureID to the PositionInEnclosure to make the PSU Identfier
// EnclosureID;PowerSupplyID;
Temperature.Discovery.Source(1).Compute(2).Type="LeftConcat"
Temperature.Discovery.Source(1).Compute(2).Column=2
Temperature.Discovery.Source(1).Compute(2).String=Column(1)

// InstanceTable = Source(1)
// PoolID;DiskWWN;DiskEnclosure;DiskID;
Temperature.Discovery.InstanceTable=%Temperature.Discovery.Source(1)%
Temperature.Discovery.Instance.DeviceID=InstanceTable.Column(2)
Temperature.Discovery.Instance.DisplayID=InstanceTable.Column(2)
Temperature.Discovery.Instance.AttachedToDeviceID="DDNSA"


//
// Collect

// Collect type is multi-instance
Temperature.Collect.Type="MultiInstance"

// Source(1) =  SNMP Table
// EnclosureID;PositionInEnclosure;Status;
Temperature.Collect.Source(1).Type="SnmpTable"
Temperature.Collect.Source(1).SnmpTableOid="1.3.6.1.4.1.6894.2.6.1"
Temperature.Collect.Source(1).SnmpTableSelectColumns="2,3,4"

// Add an underscore to the left of the PositionInEnclosure
// EnclosureID;PositionInEnclosure;Status;
Temperature.Collect.Source(1).Compute(1).Type="LeftConcat"
Temperature.Collect.Source(1).Compute(1).Column=2
Temperature.Collect.Source(1).Compute(1).String="_"

// Add the EnclosureID to the PositionInEnclosure to make the PSU Identfier
// EnclosureID;PowerSupplyID;Status;
Temperature.Collect.Source(1).Compute(2).Type="LeftConcat"
Temperature.Collect.Source(1).Compute(2).Column=2
Temperature.Collect.Source(1).Compute(2).String=Column(1)

// Translate the  status column into a PATROLStatus
// DiskEnclosure;DiskID;PatrolStatus;
Temperature.Collect.Source(1).Compute(3).Type="Translate"
Temperature.Collect.Source(1).Compute(3).Column=3
Temperature.Collect.Source(1).Compute(3).TranslationTable="TemperatureStatusTranslationTable"

// The TemperatureStatusTranslationTable
TemperatureStatusTranslationTable(1)="OK"
TemperatureStatusTranslationTable(2)="WARN"
TemperatureStatusTranslationTable(3)="ALARM"
TemperatureStatusTranslationTable(Default)="UNKNOWN"

// DiskEnclosure;DiskID;PatrolStatus;StatusInformation;
// ValueTable = Source(1)
Temperature.Collect.ValueTable=%Temperature.Collect.Source(1)%
Temperature.Collect.DeviceID=ValueTable.Column(2)
Temperature.Collect.Status=ValueTable.Column(3)
