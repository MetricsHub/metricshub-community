////////////////////////////////////////////////////////////////
//
//    H a r d w a r e   D e f i n i t i o n   F i l e
//
//                       f o r
//
//                 Hardware Sentry
//
//                 by Sentry Software (c)
//
//
//      Supports: Ethernet Switches
//                Provides enclosure for MIB-2 Connectors

//      N.B: If your connector uses MIB-2, Supersede this connector!
//
//


//
// Header
//

hdf.DisplayName="Generic Ethernet Switch"
hdf.TypicalPlatform="MIB-2 Supported Switch"
hdf.ReliesOn="MIB-2 SNMP"
hdf.Version="1.0"
hdf.Comments="This connector provides an enclosure for Ethernet switches that do not provide one of their own."
hdf.RemoteSupport="true"
hdf.AppliesToOS="Network"

hdf.Supersedes="MS_HW_MIB2.hdf"

// Include MIB2
#include MS_HW_MIB2.hhdf

// sysdecr
Enclosure.Discovery.Source(1).Type="SnmpTable"
Enclosure.Discovery.Source(1).SnmpTableOid="1.3.6.1.2.1.1"
Enclosure.Discovery.Source(1).SnmpTableSelectColumns="1"

Enclosure.Discovery.InstanceTable=%Enclosure.Discovery.Source(1)%
Enclosure.Discovery.Instance.DeviceID="EthernetSwitch"
Enclosure.Discovery.Instance.DisplayID=InstanceTable.Column(1)
Enclosure.Discovery.Instance.Type="Switch"

// Source(4) = ifTable SNMP Table
// PortID;OperationalStatus
NetworkCard.Discovery.Source(4).Type="SnmpTable"
NetworkCard.Discovery.Source(4).SnmpTableOid="1.3.6.1.2.1.2.2.1"
NetworkCard.Discovery.Source(4).SnmpTableSelectColumns="ID,8"

// Exclude OperationalStatus 6 = Component Not Present
NetworkCard.Discovery.Source(4).Compute(1).Type="ExcludeMatchingLines"
NetworkCard.Discovery.Source(4).Compute(1).Column=2
NetworkCard.Discovery.Source(4).Compute(1).ValueList="6"

// PortID;OperationalStatus;PortID;Description;TypeCode;MacAddress;AdminStatus;ID;Name;Alias;
NetworkCard.Discovery.Source(5).Type="TableJoint"
NetworkCard.Discovery.Source(5).LeftTable=%NetworkCard.Discovery.Source(4)%
NetworkCard.Discovery.Source(5).RightTable=%NetworkCard.Discovery.Source(3)%
NetworkCard.Discovery.Source(5).LeftKeyColumn=1
NetworkCard.Discovery.Source(5).RightKeyColumn=1

// PortID;OperationalStatus;PortID;Description;TypeCode;MacAddress;AdminStatus;ID;Name;Alias;
NetworkCard.Discovery.InstanceTable=%NetworkCard.Discovery.Source(5)%
NetworkCard.Discovery.Instance.DeviceID=InstanceTable.Column(1)
NetworkCard.Discovery.Instance.DisplayID=InstanceTable.Column(9)
NetworkCard.Discovery.Instance.PhysicalAddress=InstanceTable.Column(6)
NetworkCard.Discovery.Instance.PhysicalAddressType="MAC"
NetworkCard.Discovery.Instance.DeviceType=InstanceTable.Column(5)

NetworkCard.Discovery.Instance.AttachedToDeviceID="EthernetSwitch"
