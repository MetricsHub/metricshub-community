////////////////////////////////////////////////////////////////
//
//    H a r d w a r e   D e f i n i t i o n   F i l e
//
//                       f o r
//
//                 Hardware Sentry
//
//                 by Sentry Software (c)
//
//
//      Supports: Extreme Networks via *-MIB
//                Connects to SNMP agent
//
//


//
// Header
//

hdf.DisplayName="Extreme Networks (SNMP)"
hdf.TypicalPlatform="Extreme"
hdf.ReliesOn="SNMP Agent"
hdf.Version="1.0"
hdf.Comments="This connector discovers the Extreme Network Switch enclosure as well as various environment sensors (temperature, fans, power supplies). It relies on the SNMP protocol."
hdf.LocalSupport="false"
hdf.RemoteSupport="true"
hdf.AppliesToOS="Network"
hdf.Supersedes="MS_HW_GenericSwitchEnclosure.hdf,MS_HW_MIB2.hdf"

#include MS_HW_MIB2.hhdf

//
// DETECTION
//

// Detection Criteria 1
Detection.Criteria(1).Type="SNMP"
Detection.Criteria(1).SnmpGetNext="1.3.6.1.4.1.1916.1"


//
// Enclosure
//

Enclosure.Discovery.Source(1).Type="SnmpTable"
Enclosure.Discovery.Source(1).SnmpTableOid="1.3.6.1.4.1.1916.1.1.2.2.1"
Enclosure.Discovery.Source(1).SnmpTableSelectColumns="ID,2,6,5"

// Exclude not present
Enclosure.Discovery.Source(1).Compute(1).Type="ExcludeMatchingLines"
Enclosure.Discovery.Source(1).Compute(1).Column=4
Enclosure.Discovery.Source(1).Compute(1).RegExp="1"

// Id;Name;SerialNumber;
Enclosure.Discovery.InstanceTable=%Enclosure.Discovery.Source(1)%
Enclosure.Discovery.Instance.DeviceID=InstanceTable.Column(1)
Enclosure.Discovery.Instance.DisplayID=InstanceTable.Column(2)
Enclosure.Discovery.Instance.SerialNumber=InstanceTable.Column(3)
Enclosure.Discovery.Instance.Vendor="Extreme Networks"
Enclosure.Discovery.Instance.Type="Switch"

// Collect

Enclosure.Collect.Type="MultiInstance"

Enclosure.Collect.Source(1).Type="SnmpTable"
Enclosure.Collect.Source(1).SnmpTableOid="1.3.6.1.4.1.1916.1.1.2.2.1"
Enclosure.Collect.Source(1).SnmpTableSelectColumns="ID,5"

Enclosure.Collect.Source(1).Compute(1).Type="DuplicateColumn"
Enclosure.Collect.Source(1).Compute(1).Column=2

Enclosure.Collect.Source(1).Compute(2).Type="Translate"
Enclosure.Collect.Source(1).Compute(2).Column=2
Enclosure.Collect.Source(1).Compute(2).TranslationTable="SlotStatusTranslationTable"

Enclosure.Collect.Source(1).Compute(3).Type="Translate"
Enclosure.Collect.Source(1).Compute(3).Column=3
Enclosure.Collect.Source(1).Compute(3).TranslationTable="SlotStatusInformationTranslationTable"

// ID;PatrolStatus;StatusInformation;
Enclosure.Collect.ValueTable=%Enclosure.Collect.Source(1)%
Enclosure.Collect.DeviceID=ValueTable.Column(1)
Enclosure.Collect.Status=ValueTable.Column(2)
Enclosure.Collect.StatusInformation=ValueTable.Column(3)


//
// NetworkCard
//

// PortID;Description;TypeCode;MacAddress;AdminStatus;ID;Name;Alias;
NetworkCard.Discovery.InstanceTable=%NetworkCard.Discovery.Source(3)%
NetworkCard.Discovery.Instance.DeviceID=InstanceTable.Column(1)
NetworkCard.Discovery.Instance.DisplayID=InstanceTable.Column(7)
NetworkCard.Discovery.Instance.PhysicalAddress=InstanceTable.Column(4)
NetworkCard.Discovery.Instance.PhysicalAddressType="MAC"
NetworkCard.Discovery.Instance.DeviceType=InstanceTable.Column(3)


//
// PowerSupply
//

PowerSupply.Discovery.Source(1).Type="SnmpTable"
PowerSupply.Discovery.Source(1).SnmpTableOid="1.3.6.1.4.1.1916.1.1.1.27.1"
PowerSupply.Discovery.Source(1).SnmpTableSelectColumns="ID,ID,2,3,4"

// Exclude not present
PowerSupply.Discovery.Source(1).Compute(1).Type="ExcludeMatchingLines"
PowerSupply.Discovery.Source(1).Compute(1).Column=3
PowerSupply.Discovery.Source(1).Compute(1).RegExp="1"

// Create Display Name
PowerSupply.Discovery.Source(1).Compute(2).Type="LeftConcat"
PowerSupply.Discovery.Source(1).Compute(2).Column=2
PowerSupply.Discovery.Source(1).Compute(2).String="PSU "

// Translate PowerSupply Input to PowerSupplyPower and PowerSupplyType
// ID;Name;Status;PowerSupplyPower;PowerSupplyType;SerialNumber;
PowerSupply.Discovery.Source(1).Compute(3).Type="Translate"
PowerSupply.Discovery.Source(1).Compute(3).Column=4
PowerSupply.Discovery.Source(1).Compute(3).TranslationTable="PowerSupplyPowerTranslationTable"

// Add _MSHW_ to serial number to check for empty value
PowerSupply.Discovery.Source(1).Compute(4).Type="RightConcat"
PowerSupply.Discovery.Source(1).Compute(4).Column=6
PowerSupply.Discovery.Source(1).Compute(4).String="_MSHW_"

// Add Serial Number: Label for additionalInformation
PowerSupply.Discovery.Source(1).Compute(5).Type="LeftConcat"
PowerSupply.Discovery.Source(1).Compute(5).Column=6
PowerSupply.Discovery.Source(1).Compute(5).String="Serial Number: "

// Remove Serial Number: _MSHW_ (Serial Number was empty)
PowerSupply.Discovery.Source(1).Compute(6).Type="Replace"
PowerSupply.Discovery.Source(1).Compute(6).Column=6
PowerSupply.Discovery.Source(1).Compute(6).Replace="Serial Number: _MSHW_"
PowerSupply.Discovery.Source(1).Compute(6).ReplaceBy=""

PowerSupplyPowerTranslationTable(1)="110;AC"
PowerSupplyPowerTranslationTable(2)="220;AC"
PowerSupplyPowerTranslationTable(3)="48;DC"
PowerSupplyPowerTranslationTable(4)=";"
PowerSupplyPowerTranslationTable(Default)="UNKNOWN;UNKNOWN"

// ID;Name;Status;PowerSupplyPower;PowerSupplyType;SerialNumber;
PowerSupply.Discovery.InstanceTable=%PowerSupply.Discovery.Source(1)%
PowerSupply.Discovery.Instance.DeviceID=InstanceTable.Column(1)
PowerSupply.Discovery.Instance.DisplayID=InstanceTable.Column(2)
PowerSupply.Discovery.Instance.PowerSupplyPower=InstanceTable.Column(4)
PowerSupply.Discovery.Instance.PowerSupplyType=InstanceTable.Column(5)
PowerSupply.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(6)

// Collect

// Collect type = multi-instance
PowerSupply.Collect.Type="MultiInstance"

PowerSupply.Collect.Source(1).Type="SnmpTable"
PowerSupply.Collect.Source(1).SnmpTableOid="1.3.6.1.4.1.1916.1.1.1.27.1"
PowerSupply.Collect.Source(1).SnmpTableSelectColumns="ID,2"

PowerSupply.Collect.Source(1).Compute(1).Type="DuplicateColumn"
PowerSupply.Collect.Source(1).Compute(1).Column=2

PowerSupply.Collect.Source(1).Compute(2).Type="Translate"
PowerSupply.Collect.Source(1).Compute(2).Column=2
PowerSupply.Collect.Source(1).Compute(2).TranslationTable="PowerSupplyStatusTranslationTable"

PowerSupply.Collect.Source(1).Compute(3).Type="Translate"
PowerSupply.Collect.Source(1).Compute(3).Column=3
PowerSupply.Collect.Source(1).Compute(3).TranslationTable="PowerSupplyStatusInformationTranslationTable"

// ID;PatrolStatus;StatusInformation
PowerSupply.Collect.ValueTable=%PowerSupply.Collect.Source(1)%
PowerSupply.Collect.DeviceID=ValueTable.Column(1)
PowerSupply.Collect.Status=ValueTable.Column(2)
PowerSupply.Collect.StatusInformation=ValueTable.Column(3)


//
// Fan
//

Fan.Discovery.Source(1).Type="SnmpTable"
Fan.Discovery.Source(1).SnmpTableOid="1.3.6.1.4.1.1916.1.1.1.9.1"
Fan.Discovery.Source(1).SnmpTableSelectColumns="ID,ID"

Fan.Discovery.Source(1).Compute(1).Type="LeftConcat"
Fan.Discovery.Source(1).Compute(1).Column=2
Fan.Discovery.Source(1).Compute(1).String="Fan "

// Id;Name
Fan.Discovery.InstanceTable=%Fan.Discovery.Source(1)%
Fan.Discovery.Instance.DeviceID=InstanceTable.Column(1)
Fan.Discovery.Instance.DisplayID=InstanceTable.Column(2)

// Collect

// Collect type = multi-instance
Fan.Collect.Type="MultiInstance"

Fan.Collect.Source(1).Type="SnmpTable"
Fan.Collect.Source(1).SnmpTableOid="1.3.6.1.4.1.1916.1.1.1.9.1"
Fan.Collect.Source(1).SnmpTableSelectColumns="ID,2,2,4"

Fan.Collect.Source(1).Compute(1).Type="Translate"
Fan.Collect.Source(1).Compute(1).Column=2
Fan.Collect.Source(1).Compute(1).TranslationTable="FanStatusTranslationTable"

Fan.Collect.Source(1).Compute(2).Type="Translate"
Fan.Collect.Source(1).Compute(2).Column=3
Fan.Collect.Source(1).Compute(2).TranslationTable="FanStatusInformationTranslationTable"

// ID;PatrolStatus;StatusInformation
Fan.Collect.ValueTable=%Fan.Collect.Source(1)%
Fan.Collect.DeviceID=ValueTable.Column(1)
Fan.Collect.Status=ValueTable.Column(2)
Fan.Collect.StatusInformation=ValueTable.Column(3)
Fan.Collect.Speed=ValueTable.Column(4)


//
// Temperature
//

Temperature.Discovery.Source(1).Type="SnmpTable"
Temperature.Discovery.Source(1).SnmpTableOid="1.3.6.1.4.1.1916.1.1.1"
Temperature.Discovery.Source(1).SnmpTableSelectColumns="ID,7"

Temperature.Discovery.InstanceTable=%Temperature.Discovery.Source(1)%
Temperature.Discovery.Instance.DeviceID=InstanceTable.Column(1)
Temperature.Discovery.Instance.DisplayID="Internal Temperature"


// Collect

// Collect type = mono-instance
Temperature.Collect.Type="MultiInstance"

Temperature.Collect.Source(1).Type="SnmpTable"
Temperature.Collect.Source(1).SnmpTableOid="1.3.6.1.4.1.1916.1.1.1"
Temperature.Collect.Source(1).SnmpTableSelectColumns="ID,7,8"

// Duplicate the StatusCode column
// ID;StatusCode;StatusCode;Temperature
Temperature.Collect.Source(1).Compute(1).Type="DuplicateColumn"
Temperature.Collect.Source(1).Compute(1).Column=2

// Translate 1st StatusCode into PATROLSTatus
// PATROLStatus;StatusCode;
Temperature.Collect.Source(1).Compute(2).Type="Translate"
Temperature.Collect.Source(1).Compute(2).Column=2
Temperature.Collect.Source(1).Compute(2).TranslationTable="TemperatureStatusTranslationTable"

// PATROLStatus;StatusInformation;Temperature
Temperature.Collect.Source(1).Compute(3).Type="Translate"
Temperature.Collect.Source(1).Compute(3).Column=3
Temperature.Collect.Source(1).Compute(3).TranslationTable="TemperatureStatusInformationTranslationTable"

// ValueTable
Temperature.Collect.ValueTable=%Temperature.Collect.Source(1)%
Temperature.Collect.DeviceID=ValueTable.Column(1)
Temperature.Collect.Status=ValueTable.Column(2)
Temperature.Collect.StatusInformation=ValueTable.Column(3)
Temperature.Collect.Temperature=ValueTable.Column(4)


SlotStatusTranslationTable(2)="OK"
SlotStatusTranslationTable(3)="WARN"
SlotStatusTranslationTable(4)="ALARM"
SlotStatusTranslationTable(5)="OK"
SlotStatusTranslationTable(6)="OK"
SlotStatusTranslationTable(7)="UNKNOWN"
SlotStatusTranslationTable(8)="WARN"
SlotStatusTranslationTable(9)="OK"
SlotStatusTranslationTable(10)="WARN"
SlotStatusTranslationTable(11)="OK"
SlotStatusTranslationTable(12)="OK"
SlotStatusTranslationTable(13)="WARN"
SlotStatusTranslationTable(14)="OK"
SlotStatusTranslationTable(100)="ALARM"
SlotStatusTranslationTable(Default)="UNKNOWN"

SlotStatusInformationTranslationTable(2)="Testing"
SlotStatusInformationTranslationTable(3)="Mismatch"
SlotStatusInformationTranslationTable(4)="Failed"
SlotStatusInformationTranslationTable(5)="Operational"
SlotStatusInformationTranslationTable(6)="Powerdown"
SlotStatusInformationTranslationTable(7)="Unknown"
SlotStatusInformationTranslationTable(8)="present"
SlotStatusInformationTranslationTable(9)="poweron"
SlotStatusInformationTranslationTable(10)="post"
SlotStatusInformationTranslationTable(11)="downloading"
SlotStatusInformationTranslationTable(12)="booting"
SlotStatusInformationTranslationTable(13)="offline"
SlotStatusInformationTranslationTable(14)="initializing"
SlotStatusInformationTranslationTable(100)="invalid"
SlotStatusInformationTranslationTable(Default)="Unknown status"

PowerSupplyStatusTranslationTable(2)="OK"
PowerSupplyStatusTranslationTable(3)="ALARM"
PowerSupplyStatusTranslationTable(4)="OK"
PowerSupplyStatusTranslationTable(Default)="UNKNOWN"

PowerSupplyStatusInformationTranslationTable(2)="Present; OK"
PowerSupplyStatusInformationTranslationTable(3)="Present; Not OK"
PowerSupplyStatusInformationTranslationTable(4)="Present; Powered Off"
PowerSupplyStatusInformationTranslationTable(Default)="UNKNOWN"

FanStatusTranslationTable(1)="OK"
FanStatusTranslationTable(2)="ALARM"
FanStatusTranslationTable(Default)="UNKNOWN"

FanStatusInformationTranslationTable(1)=""
FanStatusInformationTranslationTable(2)="Not Operational"
FanStatusInformationTranslationTable(Default)="UNKNOWN"

TemperatureStatusTranslationTable(1)="ALARM"
TemperatureStatusTranslationTable(2)="OK"
TemperatureStatusTranslationTable(Default)="UNKNOWN"

TemperatureStatusInformationTranslationTable(1)="Over Temperature"
TemperatureStatusInformationTranslationTable(2)=""
TemperatureStatusInformationTranslationTable(Default)="Unknown Temperature Status"
