//
//
//                   C O N N E C T O R
//
//                         f o r
//
//                    Hardware Sentry
//
//                 by Sentry Software (c)
//
//               MS_HW_HuaweiOceanStorREST.hdf
//
//         Connects to:  Huawei DeviceManager REST API
//    NOTES:
//      Memory information is available but no hardware status. /deviceManager/rest/%Entry.Column(2)%/memory


// HEADER
hdf.DisplayName="Huawei OceanStor (REST)"
hdf.TypicalPlatform="Huawei OceanStor"
hdf.ReliesOn="Huawei DeviceManager REST API"
hdf.Version="1.0"
hdf.Comments="This connector discovers environmental sensors, Fans, Controllers, Power Supplies, Battery Backup Units, CPUs, LUNs, Physical Disks and NetworkCards for Huawei OceanStor storage devices. It relies on OceanStor V3 and above."
hdf.RemoteSupport="true"
hdf.LocalSupport="false"
hdf.AppliesToOS="Storage"

// Try and get a token
Detection.Criteria(1).Type="HTTP"
Detection.Criteria(1).Method="GET"
Detection.Criteria(1).URL="/"
Detection.Criteria(1).Header="Accept:*/*"
Detection.Criteria(1).ErrorMessage="Not an OceanStor V3 system or above."
Detection.Criteria(1).ResultContent="body"
Detection.Criteria(1).ExpectedResult="<html ng-app=""com.huawei.ism.ibase"">"


//
// Enclosure
//

// Discovery
Enclosure.Discovery.Source(1).Type="HTTP"
Enclosure.Discovery.Source(1).Method="POST"
Enclosure.Discovery.Source(1).Url="deviceManager/rest/xxxxx/sessions"
Enclosure.Discovery.Source(1).Header="Accept:application/json"
Enclosure.Discovery.Source(1).Body="{""password"":""%{PASSWORD}"",""username"":""%{USERNAME}"",""scope"": 0}"
Enclosure.Discovery.Source(1).ResultContent="all"

// Get Cookies
Enclosure.Discovery.Source(2)=%Enclosure.Discovery.Source(1)%
Enclosure.Discovery.Source(2).Compute(1).Type="Awk"
Enclosure.Discovery.Source(2).Compute(1).AwkScript=EmbeddedFile(2)

// Get body
Enclosure.Discovery.Source(3)=%Enclosure.Discovery.Source(1)%

Enclosure.Discovery.Source(3).Compute(1).Type="Awk"
Enclosure.Discovery.Source(3).Compute(1).AwkScript=EmbeddedFile(1)

Enclosure.Discovery.Source(3).Compute(2).Type="Json2Csv"
Enclosure.Discovery.Source(3).Compute(2).EntryKey="/data"
Enclosure.Discovery.Source(3).Compute(2).Properties="/deviceid;/iBaseToken;"

// append key to header value <key>:<value> ibaseToken:<token>
Enclosure.Discovery.Source(3).Compute(3).Type="LeftConcat"
Enclosure.Discovery.Source(3).Compute(3).Column=3
Enclosure.Discovery.Source(3).Compute(3).String="iBaseToken:"

// Stops sending invalid commands if session did not authenticate.
Enclosure.Discovery.Source(3).Compute(4).Type="ExcludeMatchingLines"
Enclosure.Discovery.Source(3).Compute(4).Column=3
Enclosure.Discovery.Source(3).Compute(4).RegExp="^iBaseToken:$"

// Keep iBaseToken as source 3
Enclosure.Discovery.Source(4)=%Enclosure.Discovery.Source(3)%

Enclosure.Discovery.Source(4).Compute(1).Type="KeepColumns"
Enclosure.Discovery.Source(4).Compute(1).ColumnNumbers="3"

Enclosure.Discovery.Source(4).Compute(2).Type="Awk"
Enclosure.Discovery.Source(4).Compute(2).AwkScript=EmbeddedFile(3)

// union iBaseToken, cookies and Acccept headers
Enclosure.Discovery.Source(5).Type="TableUnion"
Enclosure.Discovery.Source(5).Table1="Accept:Application/Json"
Enclosure.Discovery.Source(5).Table2=%Enclosure.Discovery.Source(2)%
Enclosure.Discovery.Source(5).Table3=%Enclosure.Discovery.Source(4)%

// System
Enclosure.Discovery.Source(6).Type="HTTP"
Enclosure.Discovery.Source(6).Method="GET"
Enclosure.Discovery.Source(6).ExecuteForEachEntryOf=%Enclosure.Discovery.Source(3)%
Enclosure.Discovery.Source(6).Url="/deviceManager/rest/%Entry.Column(2)%/system/"
Enclosure.Discovery.Source(6).Header=%Enclosure.Discovery.Source(5)%
Enclosure.Discovery.Source(6).EntryConcatMethod="JSONArrayExtended"

Enclosure.Discovery.Source(6).Compute(1).Type="Json2Csv"
Enclosure.Discovery.Source(6).Compute(1).EntryKey="/Entry/Value/data"
Enclosure.Discovery.Source(6).Compute(1).Properties="../../Column(2);/NAME;/PRODUCTMODE;/patchVersion;"

Enclosure.Discovery.Source(6).Compute(2).Type="Translate"
Enclosure.Discovery.Source(6).Compute(2).Column=4
Enclosure.Discovery.Source(6).Compute(2).TranslationTable="EnclosureProductModeTranslationTable"

// Logical Disk
Enclosure.Discovery.Source(7).Type="HTTP"
Enclosure.Discovery.Source(7).Method="GET"
Enclosure.Discovery.Source(7).ExecuteForEachEntryOf=%Enclosure.Discovery.Source(3)%
Enclosure.Discovery.Source(7).Url="/deviceManager/rest/%Entry.Column(2)%/lun"
Enclosure.Discovery.Source(7).Header=%Enclosure.Discovery.Source(5)%
Enclosure.Discovery.Source(7).ResultContent="body"
Enclosure.Discovery.Source(7).EntryConcatMethod="JSONArrayExtended"

// PhysicalDisk
Enclosure.Discovery.Source(8).Type="HTTP"
Enclosure.Discovery.Source(8).Method="GET"
Enclosure.Discovery.Source(8).ExecuteForEachEntryOf=%Enclosure.Discovery.Source(3)%
Enclosure.Discovery.Source(8).Url="/deviceManager/rest/%Entry.Column(2)%/disk"
Enclosure.Discovery.Source(8).Header=%Enclosure.Discovery.Source(5)%
Enclosure.Discovery.Source(8).ResultContent="body"
Enclosure.Discovery.Source(8).EntryConcatMethod="JSONArrayExtended"

// FC PORT
Enclosure.Discovery.Source(9).Type="HTTP"
Enclosure.Discovery.Source(9).Method="GET"
Enclosure.Discovery.Source(9).ExecuteForEachEntryOf=%Enclosure.Discovery.Source(3)%
Enclosure.Discovery.Source(9).Url="/deviceManager/rest/%Entry.Column(2)%/fc_port"
Enclosure.Discovery.Source(9).Header=%Enclosure.Discovery.Source(5)%
Enclosure.Discovery.Source(9).ResultContent="body"
Enclosure.Discovery.Source(9).EntryConcatMethod="JSONArrayExtended"

// SAS PORT
Enclosure.Discovery.Source(10).Type="HTTP"
Enclosure.Discovery.Source(10).Method="GET"
Enclosure.Discovery.Source(10).ExecuteForEachEntryOf=%Enclosure.Discovery.Source(3)%
Enclosure.Discovery.Source(10).Url="/deviceManager/rest/%Entry.Column(2)%/sas_port"
Enclosure.Discovery.Source(10).Header=%Enclosure.Discovery.Source(5)%
Enclosure.Discovery.Source(10).ResultContent="body"
Enclosure.Discovery.Source(10).EntryConcatMethod="JSONArrayExtended"

// ETH PORT
Enclosure.Discovery.Source(11).Type="HTTP"
Enclosure.Discovery.Source(11).Method="GET"
Enclosure.Discovery.Source(11).ExecuteForEachEntryOf=%Enclosure.Discovery.Source(3)%
Enclosure.Discovery.Source(11).Url="/deviceManager/rest/%Entry.Column(2)%/eth_port"
Enclosure.Discovery.Source(11).Header=%Enclosure.Discovery.Source(5)%
Enclosure.Discovery.Source(11).ResultContent="body"
Enclosure.Discovery.Source(11).EntryConcatMethod="JSONArrayExtended"

// DiskController
Enclosure.Discovery.Source(12).Type="HTTP"
Enclosure.Discovery.Source(12).Method="GET"
Enclosure.Discovery.Source(12).ExecuteForEachEntryOf=%Enclosure.Discovery.Source(3)%
Enclosure.Discovery.Source(12).Url="/deviceManager/rest/%Entry.Column(2)%/controller"
Enclosure.Discovery.Source(12).Header=%Enclosure.Discovery.Source(5)%
Enclosure.Discovery.Source(12).ResultContent="body"
Enclosure.Discovery.Source(12).EntryConcatMethod="JSONArrayExtended"

// Fan
Enclosure.Discovery.Source(13).Type="HTTP"
Enclosure.Discovery.Source(13).Method="GET"
Enclosure.Discovery.Source(13).ExecuteForEachEntryOf=%Enclosure.Discovery.Source(3)%
Enclosure.Discovery.Source(13).Url="/deviceManager/rest/%Entry.Column(2)%/fan"
Enclosure.Discovery.Source(13).Header=%Enclosure.Discovery.Source(5)%
Enclosure.Discovery.Source(13).ResultContent="body"
Enclosure.Discovery.Source(13).EntryConcatMethod="JSONArrayExtended"

// power
Enclosure.Discovery.Source(14).Type="HTTP"
Enclosure.Discovery.Source(14).Method="GET"
Enclosure.Discovery.Source(14).ExecuteForEachEntryOf=%Enclosure.Discovery.Source(3)%
Enclosure.Discovery.Source(14).Url="/deviceManager/rest/%Entry.Column(2)%/power"
Enclosure.Discovery.Source(14).Header=%Enclosure.Discovery.Source(5)%
Enclosure.Discovery.Source(14).ResultContent="body"
Enclosure.Discovery.Source(14).EntryConcatMethod="JSONArrayExtended"

// backup_power
Enclosure.Discovery.Source(15).Type="HTTP"
Enclosure.Discovery.Source(15).Method="GET"
Enclosure.Discovery.Source(15).ExecuteForEachEntryOf=%Enclosure.Discovery.Source(3)%
Enclosure.Discovery.Source(15).Url="/deviceManager/rest/%Entry.Column(2)%/backup_power"
Enclosure.Discovery.Source(15).Header=%Enclosure.Discovery.Source(5)%
Enclosure.Discovery.Source(15).ResultContent="body"
Enclosure.Discovery.Source(15).EntryConcatMethod="JSONArrayExtended"

// cpu
Enclosure.Discovery.Source(16).Type="HTTP"
Enclosure.Discovery.Source(16).Method="GET"
Enclosure.Discovery.Source(16).ExecuteForEachEntryOf=%Enclosure.Discovery.Source(3)%
Enclosure.Discovery.Source(16).Url="/deviceManager/rest/%Entry.Column(2)%/cpu"
Enclosure.Discovery.Source(16).Header=%Enclosure.Discovery.Source(5)%
Enclosure.Discovery.Source(16).ResultContent="body"
Enclosure.Discovery.Source(16).EntryConcatMethod="JSONArrayExtended"

// enclosure
Enclosure.Discovery.Source(17).Type="HTTP"
Enclosure.Discovery.Source(17).Method="GET"
Enclosure.Discovery.Source(17).ExecuteForEachEntryOf=%Enclosure.Discovery.Source(3)%
Enclosure.Discovery.Source(17).Url="/deviceManager/rest/%Entry.Column(2)%/enclosure"
Enclosure.Discovery.Source(17).Header=%Enclosure.Discovery.Source(5)%
Enclosure.Discovery.Source(17).ResultContent="body"
Enclosure.Discovery.Source(17).EntryConcatMethod="JSONArrayExtended"

// End Session
Enclosure.Discovery.Source(18).Type="HTTP"
Enclosure.Discovery.Source(18).Method="DELETE"
Enclosure.Discovery.Source(18).ExecuteForEachEntryOf=%Enclosure.Discovery.Source(3)%
Enclosure.Discovery.Source(18).Url="/deviceManager/rest/%Entry.Column(2)%/sessions"
Enclosure.Discovery.Source(18).Header=%Enclosure.Discovery.Source(5)%

Enclosure.Discovery.Source(19)=%Enclosure.Discovery.Source(17)%

Enclosure.Discovery.Source(19).Compute(1).Type="Json2Csv"
Enclosure.Discovery.Source(19).Compute(1).EntryKey="/Entry/Value/data"
Enclosure.Discovery.Source(19).Compute(1).Properties="../Column(2);/MODEL;/SERIALNUM;"


Enclosure.Discovery.Source(20).Type="TableJoint"
Enclosure.Discovery.Source(20).LeftTable=%Enclosure.Discovery.Source(6)%
Enclosure.Discovery.Source(20).RightTable=%Enclosure.Discovery.Source(19)%
Enclosure.Discovery.Source(20).LeftKeyColumn=2
Enclosure.Discovery.Source(20).RightKeyColumn=2
Enclosure.Discovery.Source(20).DefaultRightLine=";;;"

EnclosureProductModeTranslationTable(61)="6800 V3"
EnclosureProductModeTranslationTable(62)="6900 V3"
EnclosureProductModeTranslationTable(63)="5600 V3"
EnclosureProductModeTranslationTable(64)="5800 V3"
EnclosureProductModeTranslationTable(68)="5500 V3"
EnclosureProductModeTranslationTable(70)="5300 V3"
EnclosureProductModeTranslationTable(71)="2800 V3"
EnclosureProductModeTranslationTable(72)="18500 V3"
EnclosureProductModeTranslationTable(73)="18800 V3"

Enclosure.Discovery.InstanceTable=%Enclosure.Discovery.Source(20)%
Enclosure.Discovery.Instance.DeviceID=InstanceTable.Column(2)
Enclosure.Discovery.Instance.DisplayID=InstanceTable.Column(3)
Enclosure.Discovery.Instance.Model=InstanceTable.Column(4)
Enclosure.Discovery.Instance.BIOSVersion=InstanceTable.Column(5)
Enclosure.Discovery.Instance.SerialNumber=InstanceTable.Column(9)
Enclosure.Discovery.Instance.Vendor="Huawei"
Enclosure.Discovery.Instance.Type="Storage"


// Collect

Enclosure.Collect.Type="MultiInstance"


Enclosure.Collect.Source(1).Type="HTTP"
Enclosure.Collect.Source(1).Method="POST"
Enclosure.Collect.Source(1).Url="deviceManager/rest/xxxxx/sessions"
Enclosure.Collect.Source(1).Header="Accept:application/json"
Enclosure.Collect.Source(1).Body="{""password"":""%{PASSWORD}"",""username"":""%{USERNAME}"",""scope"": 0}"
Enclosure.Collect.Source(1).ResultContent="all"

// Get Cookies
Enclosure.Collect.Source(2)=%Enclosure.Collect.Source(1)%
Enclosure.Collect.Source(2).Compute(1).Type="Awk"
Enclosure.Collect.Source(2).Compute(1).AwkScript=EmbeddedFile(2)

// Get body
Enclosure.Collect.Source(3)=%Enclosure.Collect.Source(1)%

Enclosure.Collect.Source(3).Compute(1).Type="Awk"
Enclosure.Collect.Source(3).Compute(1).AwkScript=EmbeddedFile(1)

Enclosure.Collect.Source(3).Compute(2).Type="Json2Csv"
Enclosure.Collect.Source(3).Compute(2).EntryKey="/data"
Enclosure.Collect.Source(3).Compute(2).Properties="/deviceid;/iBaseToken;"

// append key to header value <key>:<value> ibaseToken:<token>
Enclosure.Collect.Source(3).Compute(3).Type="LeftConcat"
Enclosure.Collect.Source(3).Compute(3).Column=3
Enclosure.Collect.Source(3).Compute(3).String="iBaseToken:"

// Stops sending invalid commands if session did not authenticate.
Enclosure.Collect.Source(3).Compute(4).Type="ExcludeMatchingLines"
Enclosure.Collect.Source(3).Compute(4).Column=3
Enclosure.Collect.Source(3).Compute(4).RegExp="^iBaseToken:$"


// Keep iBaseToken as source 3
Enclosure.Collect.Source(4)=%Enclosure.Collect.Source(3)%

Enclosure.Collect.Source(4).Compute(1).Type="KeepColumns"
Enclosure.Collect.Source(4).Compute(1).ColumnNumbers="3"

Enclosure.Collect.Source(4).Compute(2).Type="Awk"
Enclosure.Collect.Source(4).Compute(2).AwkScript=EmbeddedFile(3)

// union iBaseToken, cookies and Acccept headers
Enclosure.Collect.Source(5).Type="TableUnion"
Enclosure.Collect.Source(5).Table1="Accept:Application/Json"
Enclosure.Collect.Source(5).Table2=%Enclosure.Collect.Source(2)%
Enclosure.Collect.Source(5).Table3=%Enclosure.Collect.Source(4)%

// Query System
Enclosure.Collect.Source(6).Type="HTTP"
Enclosure.Collect.Source(6).Method="GET"
Enclosure.Collect.Source(6).ExecuteForEachEntryOf=%Enclosure.Collect.Source(3)%
Enclosure.Collect.Source(6).Url="/deviceManager/rest/%Entry.Column(2)%/system/"
Enclosure.Collect.Source(6).Header=%Enclosure.Collect.Source(5)%
Enclosure.Collect.Source(6).EntryConcatMethod="JSONArrayExtended"

Enclosure.Collect.Source(6).Compute(1).Type="Json2Csv"
Enclosure.Collect.Source(6).Compute(1).EntryKey="/Entry/Value/data"
Enclosure.Collect.Source(6).Compute(1).Properties="../../Column(2);/HEALTHSTATUS;/HEALTHSTATUS;"

Enclosure.Collect.Source(6).Compute(2).Type="Translate"
Enclosure.Collect.Source(6).Compute(2).Column=3
Enclosure.Collect.Source(6).Compute(2).TranslationTable="HealthStatusTranslationTable"

Enclosure.Collect.Source(6).Compute(3).Type="Translate"
Enclosure.Collect.Source(6).Compute(3).Column=4
Enclosure.Collect.Source(6).Compute(3).TranslationTable="HealthStatusInformationTranslationTable"

// End Session
Enclosure.Collect.Source(7).Type="HTTP"
Enclosure.Collect.Source(7).Method="DELETE"
Enclosure.Collect.Source(7).ExecuteForEachEntryOf=%Enclosure.Collect.Source(3)%
Enclosure.Collect.Source(7).Url="/deviceManager/rest/%Entry.Column(2)%/sessions"
Enclosure.Collect.Source(7).Header=%Enclosure.Collect.Source(5)%


Enclosure.Collect.ValueTable=%Enclosure.Collect.Source(6)%
Enclosure.Collect.DeviceID=ValueTable.Column(2)
Enclosure.Collect.Status=ValueTable.Column(3)
Enclosure.Collect.StatusInformation=ValueTable.Column(4)


//
// CPU
//

// HTTP: /cpu
CPU.Discovery.Source(1)=%Enclosure.Discovery.Source(16)%

CPU.Discovery.Source(1).Compute(1).Type="Json2Csv"
CPU.Discovery.Source(1).Compute(1).EntryKey="/Entry/Value/data"
CPU.Discovery.Source(1).Compute(1).Properties="../../Column(2);/ID;/ID;/WORKFREQUENCY;"

CPU.Discovery.Source(1).Compute(2).Type="LeftConcat"
CPU.Discovery.Source(1).Compute(2).Column=4
CPU.Discovery.Source(1).Compute(2).String="CPU: "

CPU.Discovery.InstanceTable=%CPU.Discovery.Source(1)%
CPU.Discovery.Instance.DeviceID=InstanceTable.Column(3)
CPU.Discovery.Instance.DisplayID=InstanceTable.Column(4)
CPU.Discovery.Instance.MaximumSpeed=InstanceTable.Column(5)

CPU.Discovery.Instance.AttachedToDeviceID=InstanceTable.Column(2)

// Collect
CPU.Collect.Type="MultiInstance"

CPU.Collect.Source(1).Type="HTTP"
CPU.Collect.Source(1).Method="POST"
CPU.Collect.Source(1).Url="deviceManager/rest/xxxxx/sessions"
CPU.Collect.Source(1).Header="Accept:application/json"
CPU.Collect.Source(1).Body="{""password"":""%{PASSWORD}"",""username"":""%{USERNAME}"",""scope"": 0}"
CPU.Collect.Source(1).ResultContent="all"

// Get Cookies
CPU.Collect.Source(2)=%CPU.Collect.Source(1)%
CPU.Collect.Source(2).Compute(1).Type="Awk"
CPU.Collect.Source(2).Compute(1).AwkScript=EmbeddedFile(2)

// Get body
CPU.Collect.Source(3)=%CPU.Collect.Source(1)%

CPU.Collect.Source(3).Compute(1).Type="Awk"
CPU.Collect.Source(3).Compute(1).AwkScript=EmbeddedFile(1)

CPU.Collect.Source(3).Compute(2).Type="Json2Csv"
CPU.Collect.Source(3).Compute(2).EntryKey="/data"
CPU.Collect.Source(3).Compute(2).Properties="/deviceid;/iBaseToken;"

// append key to header value <key>:<value> ibaseToken:<token>
CPU.Collect.Source(3).Compute(3).Type="LeftConcat"
CPU.Collect.Source(3).Compute(3).Column=3
CPU.Collect.Source(3).Compute(3).String="iBaseToken:"

// Stops sending invalid commands if session did not authenticate.
CPU.Collect.Source(3).Compute(4).Type="ExcludeMatchingLines"
CPU.Collect.Source(3).Compute(4).Column=3
CPU.Collect.Source(3).Compute(4).RegExp="^iBaseToken:$"


// Keep iBaseToken as source 3
CPU.Collect.Source(4)=%CPU.Collect.Source(3)%

CPU.Collect.Source(4).Compute(1).Type="KeepColumns"
CPU.Collect.Source(4).Compute(1).ColumnNumbers="3"

CPU.Collect.Source(4).Compute(2).Type="Awk"
CPU.Collect.Source(4).Compute(2).AwkScript=EmbeddedFile(3)

// union iBaseToken, cookies and Acccept headers
CPU.Collect.Source(5).Type="TableUnion"
CPU.Collect.Source(5).Table1="Accept:Application/Json"
CPU.Collect.Source(5).Table2=%CPU.Collect.Source(2)%
CPU.Collect.Source(5).Table3=%CPU.Collect.Source(4)%

// Query System
CPU.Collect.Source(6).Type="HTTP"
CPU.Collect.Source(6).Method="GET"
CPU.Collect.Source(6).ExecuteForEachEntryOf=%CPU.Collect.Source(3)%
CPU.Collect.Source(6).Url="/deviceManager/rest/%Entry.Column(2)%/cpu"
CPU.Collect.Source(6).Header=%CPU.Collect.Source(5)%
CPU.Collect.Source(6).EntryConcatMethod="JSONArrayExtended"


CPU.Collect.Source(6).Compute(1).Type="Json2Csv"
CPU.Collect.Source(6).Compute(1).EntryKey="/Entry/Value/data"
CPU.Collect.Source(6).Compute(1).Properties="/ID;/HEALTHSTATUS;/HEALTHSTATUS;/CURRENTFREQUENCY;"

CPU.Collect.Source(6).Compute(2).Type="Translate"
CPU.Collect.Source(6).Compute(2).Column=3
CPU.Collect.Source(6).Compute(2).TranslationTable="HealthStatusTranslationTable"

CPU.Collect.Source(6).Compute(3).Type="Translate"
CPU.Collect.Source(6).Compute(3).Column=4
CPU.Collect.Source(6).Compute(3).TranslationTable="HealthStatusInformationTranslationTable"

// End Session
CPU.Collect.Source(7).Type="HTTP"
CPU.Collect.Source(7).Method="DELETE"
CPU.Collect.Source(7).ExecuteForEachEntryOf=%CPU.Collect.Source(3)%
CPU.Collect.Source(7).Url="/deviceManager/rest/%Entry.Column(2)%/sessions"
CPU.Collect.Source(7).Header=%CPU.Collect.Source(5)%

CPU.Collect.ValueTable=%CPU.Collect.Source(6)%
CPU.Collect.DeviceID=ValueTable.Column(2)
CPU.Collect.Status=ValueTable.Column(3)
CPU.Collect.StatusInformation=ValueTable.Column(4)
CPU.Collect.CurrentSpeed=ValueTable.Column(5)


//
// Temperature
//

Temperature.Discovery.Source(1)=%Enclosure.Discovery.Source(16)%

Temperature.Discovery.Source(1).Compute(1).Type="Json2Csv"
Temperature.Discovery.Source(1).Compute(1).EntryKey="/Entry/Value/data"
Temperature.Discovery.Source(1).Compute(1).Properties="../../Column(2);/ID;/ID;/CORETEMP;"

Temperature.Discovery.Source(1).Compute(2).Type="RightConcat"
Temperature.Discovery.Source(1).Compute(2).Column=5
Temperature.Discovery.Source(1).Compute(2).String=";CPU Core"

Temperature.Discovery.Source(2)=%Enclosure.Discovery.Source(8)%

Temperature.Discovery.Source(2).Compute(1).Type="Json2Csv"
Temperature.Discovery.Source(2).Compute(1).EntryKey="/Entry/Value/data"
Temperature.Discovery.Source(2).Compute(1).Properties="../../Column(2);/ID;/ID;/TEMPERATURE;"

Temperature.Discovery.Source(2).Compute(2).Type="RightConcat"
Temperature.Discovery.Source(2).Compute(2).Column=5
Temperature.Discovery.Source(2).Compute(2).String=";Disk"

Temperature.Discovery.Source(3)=%Enclosure.Discovery.Source(17)%

Temperature.Discovery.Source(3).Compute(1).Type="Json2Csv"
Temperature.Discovery.Source(3).Compute(1).EntryKey="/Entry/Value/data"
Temperature.Discovery.Source(3).Compute(1).Properties="../../Column(2);../../Column(2);../../Column(2);/TEMPERATURE;"

// TemperatureType:AttachedToDeviceType
Temperature.Discovery.Source(3).Compute(2).Type="RightConcat"
Temperature.Discovery.Source(3).Compute(2).Column=5
Temperature.Discovery.Source(3).Compute(2).String=";Enclosure"

Temperature.Discovery.Source(4)=%Enclosure.Discovery.Source(14)%

Temperature.Discovery.Source(4).Compute(1).Type="Json2Csv"
Temperature.Discovery.Source(4).Compute(1).EntryKey="/Entry/Value/data"
Temperature.Discovery.Source(4).Compute(1).Properties="../../Column(2);/ID;/ID;/TEMPERATURE;"

// TemperatureType:AttachedToDeviceType
Temperature.Discovery.Source(4).Compute(2).Type="RightConcat"
Temperature.Discovery.Source(4).Compute(2).Column=5
Temperature.Discovery.Source(4).Compute(2).String=";Controller"

Temperature.Discovery.Source(5)=%Enclosure.Discovery.Source(12)%

Temperature.Discovery.Source(5).Compute(1).Type="Json2Csv"
Temperature.Discovery.Source(5).Compute(1).EntryKey="/Entry/Value/data"
Temperature.Discovery.Source(5).Compute(1).Properties="../../Column(2);/ID;/ID;/TEMPERATURE;"

// TemperatureType:AttachedToDeviceType
Temperature.Discovery.Source(5).Compute(2).Type="RightConcat"
Temperature.Discovery.Source(5).Compute(2).Column=5
Temperature.Discovery.Source(5).Compute(2).String=";PSU"

Temperature.Discovery.Source(6).Type="TableUnion"
Temperature.Discovery.Source(6).Table1=%Temperature.Discovery.Source(1)%
Temperature.Discovery.Source(6).Table2=%Temperature.Discovery.Source(2)%
Temperature.Discovery.Source(6).Table3=%Temperature.Discovery.Source(3)%
Temperature.Discovery.Source(6).Table4=%Temperature.Discovery.Source(4)%
Temperature.Discovery.Source(6).Table5=%Temperature.Discovery.Source(5)%

Temperature.Discovery.Source(6).Compute(1).Type="LeftConcat"
Temperature.Discovery.Source(6).Compute(1).Column=4
Temperature.Discovery.Source(6).Compute(1).String="TEMPERATURE: "

Temperature.Discovery.Source(6).Compute(2).Type="LeftConcat"
Temperature.Discovery.Source(6).Compute(2).Column=3
Temperature.Discovery.Source(6).Compute(2).String="TEMP:"

Temperature.Discovery.Source(6).Compute(3).Type="Replace"
Temperature.Discovery.Source(6).Compute(3).Column=5
Temperature.Discovery.Source(6).Compute(3).Replace="0"
Temperature.Discovery.Source(6).Compute(3).ReplaceBy=""

Temperature.Discovery.Source(6).Compute(4).Type="Replace"
Temperature.Discovery.Source(6).Compute(4).Column=5
Temperature.Discovery.Source(6).Compute(4).Replace="-1"
Temperature.Discovery.Source(6).Compute(4).ReplaceBy=""

Temperature.Discovery.InstanceTable=%Temperature.Discovery.Source(6)%
Temperature.Discovery.Instance.DeviceID=InstanceTable.Column(3)
Temperature.Discovery.Instance.DisplayID=InstanceTable.Column(4)
Temperature.Discovery.Instance.ParameterActivation.Temperature=InstanceTable.Column(5)
Temperature.Discovery.Instance.TemperatureType=InstanceTable.Column(6)

Temperature.Discovery.Instance.AttachedToDeviceID=InstanceTable.Column(2)

// Collect

Temperature.Collect.Type="MultiInstance"

// CPU
Temperature.Collect.Source(1).Type="HTTP"
Temperature.Collect.Source(1).Method="POST"
Temperature.Collect.Source(1).Url="deviceManager/rest/xxxxx/sessions"
Temperature.Collect.Source(1).Header="Accept:application/json"
Temperature.Collect.Source(1).Body="{""password"":""%{PASSWORD}"",""username"":""%{USERNAME}"",""scope"": 0}"
Temperature.Collect.Source(1).ResultContent="all"

// Get Cookies
Temperature.Collect.Source(2)=%Temperature.Collect.Source(1)%
Temperature.Collect.Source(2).Compute(1).Type="Awk"
Temperature.Collect.Source(2).Compute(1).AwkScript=EmbeddedFile(2)

// Get body
Temperature.Collect.Source(3)=%Temperature.Collect.Source(1)%

Temperature.Collect.Source(3).Compute(1).Type="Awk"
Temperature.Collect.Source(3).Compute(1).AwkScript=EmbeddedFile(1)

Temperature.Collect.Source(3).Compute(2).Type="Json2Csv"
Temperature.Collect.Source(3).Compute(2).EntryKey="/data"
Temperature.Collect.Source(3).Compute(2).Properties="/deviceid;/iBaseToken;"

// append key to header value <key>:<value> ibaseToken:<token>
Temperature.Collect.Source(3).Compute(3).Type="LeftConcat"
Temperature.Collect.Source(3).Compute(3).Column=3
Temperature.Collect.Source(3).Compute(3).String="iBaseToken:"

// Stops sending invalid commands if session did not authenticate.
Temperature.Collect.Source(3).Compute(4).Type="ExcludeMatchingLines"
Temperature.Collect.Source(3).Compute(4).Column=3
Temperature.Collect.Source(3).Compute(4).RegExp="^iBaseToken:$"


// Keep iBaseToken as source 3
Temperature.Collect.Source(4)=%Temperature.Collect.Source(3)%

Temperature.Collect.Source(4).Compute(1).Type="KeepColumns"
Temperature.Collect.Source(4).Compute(1).ColumnNumbers="3"

Temperature.Collect.Source(4).Compute(2).Type="Awk"
Temperature.Collect.Source(4).Compute(2).AwkScript=EmbeddedFile(3)

// union iBaseToken, cookies and Acccept headers
Temperature.Collect.Source(5).Type="TableUnion"
Temperature.Collect.Source(5).Table1="Accept:Application/Json"
Temperature.Collect.Source(5).Table2=%Temperature.Collect.Source(2)%
Temperature.Collect.Source(5).Table3=%Temperature.Collect.Source(4)%


Temperature.Collect.Source(6).Type="HTTP"
Temperature.Collect.Source(6).Method="GET"
Temperature.Collect.Source(6).ExecuteForEachEntryOf=%Temperature.Collect.Source(3)%
Temperature.Collect.Source(6).Url="/deviceManager/rest/%Entry.Column(2)%/cpu"
Temperature.Collect.Source(6).Header=%Temperature.Collect.Source(5)%
Temperature.Collect.Source(6).EntryConcatMethod="JSONArrayExtended"

Temperature.Collect.Source(6).Compute(1).Type="Json2Csv"
Temperature.Collect.Source(6).Compute(1).EntryKey="/Entry/Value/data"
Temperature.Collect.Source(6).Compute(1).Properties="/ID;/HEALTHSTATUS;/HEALTHSTATUS;/CORETEMP;"

Temperature.Collect.Source(7).Type="HTTP"
Temperature.Collect.Source(7).Method="GET"
Temperature.Collect.Source(7).ExecuteForEachEntryOf=%Temperature.Collect.Source(3)%
Temperature.Collect.Source(7).Url="/deviceManager/rest/%Entry.Column(2)%/disk"
Temperature.Collect.Source(7).Header=%Temperature.Collect.Source(5)%
Temperature.Collect.Source(7).EntryConcatMethod="JSONArrayExtended"

Temperature.Collect.Source(7).Compute(1).Type="Json2Csv"
Temperature.Collect.Source(7).Compute(1).EntryKey="/Entry/Value/data"
Temperature.Collect.Source(7).Compute(1).Properties="/ID;/HEALTHSTATUS;/HEALTHSTATUS;/TEMPERATURE;"

Temperature.Collect.Source(8).Type="HTTP"
Temperature.Collect.Source(8).Method="GET"
Temperature.Collect.Source(8).ExecuteForEachEntryOf=%Temperature.Collect.Source(3)%
Temperature.Collect.Source(8).Url="/deviceManager/rest/%Entry.Column(2)%/enclosure"
Temperature.Collect.Source(8).Header=%Temperature.Collect.Source(5)%
Temperature.Collect.Source(8).EntryConcatMethod="JSONArrayExtended"

Temperature.Collect.Source(8).Compute(1).Type="Json2Csv"
Temperature.Collect.Source(8).Compute(1).EntryKey="/Entry/Value/data"
Temperature.Collect.Source(8).Compute(1).Properties="../../Column(2);/HEALTHSTATUS;/HEALTHSTATUS;/TEMPERATURE;"

Temperature.Collect.Source(9).Type="HTTP"
Temperature.Collect.Source(9).Method="GET"
Temperature.Collect.Source(9).ExecuteForEachEntryOf=%Temperature.Collect.Source(3)%
Temperature.Collect.Source(9).Url="/deviceManager/rest/%Entry.Column(2)%/power"
Temperature.Collect.Source(9).Header=%Temperature.Collect.Source(5)%
Temperature.Collect.Source(9).EntryConcatMethod="JSONArrayExtended"

Temperature.Collect.Source(9).Compute(1).Type="Json2Csv"
Temperature.Collect.Source(9).Compute(1).EntryKey="/Entry/Value/data"
Temperature.Collect.Source(9).Compute(1).Properties="/ID;/HEALTHSTATUS;/HEALTHSTATUS;/TEMPERATURE;"

Temperature.Collect.Source(10).Type="HTTP"
Temperature.Collect.Source(10).Method="GET"
Temperature.Collect.Source(10).ExecuteForEachEntryOf=%Temperature.Collect.Source(3)%
Temperature.Collect.Source(10).Url="/deviceManager/rest/%Entry.Column(2)%/controller"
Temperature.Collect.Source(10).Header=%Temperature.Collect.Source(5)%
Temperature.Collect.Source(10).EntryConcatMethod="JSONArrayExtended"

Temperature.Collect.Source(10).Compute(1).Type="Json2Csv"
Temperature.Collect.Source(10).Compute(1).EntryKey="/Entry/Value/data"
Temperature.Collect.Source(10).Compute(1).Properties="/ID;/HEALTHSTATUS;/HEALTHSTATUS;/TEMPERATURE;"

Temperature.Collect.Source(11).Type="TableUnion"
Temperature.Collect.Source(11).Table1=%Temperature.Collect.Source(6)%
Temperature.Collect.Source(11).Table2=%Temperature.Collect.Source(7)%
Temperature.Collect.Source(11).Table3=%Temperature.Collect.Source(8)%
Temperature.Collect.Source(11).Table4=%Temperature.Collect.Source(9)%
Temperature.Collect.Source(11).Table5=%Temperature.Collect.Source(10)%

Temperature.Collect.Source(11).Compute(1).Type="LeftConcat"
Temperature.Collect.Source(11).Compute(1).Column=2
Temperature.Collect.Source(11).Compute(1).String="TEMP:"

Temperature.Collect.Source(11).Compute(2).Type="Translate"
Temperature.Collect.Source(11).Compute(2).Column=3
Temperature.Collect.Source(11).Compute(2).TranslationTable="HealthStatusTranslationTable"

Temperature.Collect.Source(11).Compute(3).Type="Translate"
Temperature.Collect.Source(11).Compute(3).Column=4
Temperature.Collect.Source(11).Compute(3).TranslationTable="HealthStatusInformationTranslationTable"

Temperature.Collect.Source(11).Compute(4).Type="Replace"
Temperature.Collect.Source(11).Compute(4).Column=5
Temperature.Collect.Source(11).Compute(4).Replace="0"
Temperature.Collect.Source(11).Compute(4).ReplaceBy=""

Temperature.Collect.Source(11).Compute(5).Type="Replace"
Temperature.Collect.Source(11).Compute(5).Column=5
Temperature.Collect.Source(11).Compute(5).Replace="-1"
Temperature.Collect.Source(11).Compute(5).ReplaceBy=""

// End Session
Temperature.Collect.Source(12).Type="HTTP"
Temperature.Collect.Source(12).Method="DELETE"
Temperature.Collect.Source(12).ExecuteForEachEntryOf=%Temperature.Collect.Source(3)%
Temperature.Collect.Source(12).Url="/deviceManager/rest/%Entry.Column(2)%/sessions"
Temperature.Collect.Source(12).Header=%Temperature.Collect.Source(5)%

Temperature.Collect.ValueTable=%Temperature.Collect.Source(11)%
Temperature.Collect.DeviceID=ValueTable.Column(2)
Temperature.Collect.Status=ValueTable.Column(3)
Temperature.Collect.StatusInformation=ValueTable.Column(4)
Temperature.Collect.Temperature=ValueTable.Column(5)



//
// Voltage
//

//CPU
Voltage.Discovery.Source(1)=%Enclosure.Discovery.Source(16)%

Voltage.Discovery.Source(1).Compute(1).Type="Json2Csv"
Voltage.Discovery.Source(1).Compute(1).EntryKey="/Entry/Value/data"
Voltage.Discovery.Source(1).Compute(1).Properties="../../Column(2);/ID;/ID;"

Voltage.Discovery.Source(1).Compute(2).Type="RightConcat"
Voltage.Discovery.Source(1).Compute(2).Column=4
Voltage.Discovery.Source(1).Compute(2).String=";CPU"

// controller
Voltage.Discovery.Source(2)=%Enclosure.Discovery.Source(12)%

Voltage.Discovery.Source(2).Compute(1).Type="Json2Csv"
Voltage.Discovery.Source(2).Compute(1).EntryKey="/Entry/Value/data"
Voltage.Discovery.Source(2).Compute(1).Properties="../../Column(2);/ID;/ID;"

Voltage.Discovery.Source(2).Compute(2).Type="RightConcat"
Voltage.Discovery.Source(2).Compute(2).Column=4
Voltage.Discovery.Source(2).Compute(2).String=";Controller"


Voltage.Discovery.Source(3).Type="TableUnion"
Voltage.Discovery.Source(3).Table1=%Voltage.Discovery.Source(1)%
Voltage.Discovery.Source(3).Table2=%Voltage.Discovery.Source(2)%

Voltage.Discovery.Source(3).Compute(1).Type="LeftConcat"
Voltage.Discovery.Source(3).Compute(1).Column=4
Voltage.Discovery.Source(3).Compute(1).String="Voltage: "

Voltage.Discovery.Source(3).Compute(2).Type="LeftConcat"
Voltage.Discovery.Source(3).Compute(2).Column=3
Voltage.Discovery.Source(3).Compute(2).String="VOLT:"


Voltage.Discovery.InstanceTable=%Voltage.Discovery.Source(3)%
Voltage.Discovery.Instance.DeviceID=InstanceTable.Column(3)
Voltage.Discovery.Instance.DisplayID=InstanceTable.Column(4)
Voltage.Discovery.Instance.VoltageType=InstanceTable.Column(5)

Voltage.Discovery.Instance.AttachedToDeviceID=InstanceTable.Column(2)
Voltage.Discovery.Instance.AttachedToDeviceType=InstanceTable.Column(6)

// Collect

Voltage.Collect.Type="MultiInstance"

// CPU
Voltage.Collect.Source(1).Type="HTTP"
Voltage.Collect.Source(1).Method="POST"
Voltage.Collect.Source(1).Url="deviceManager/rest/xxxxx/sessions"
Voltage.Collect.Source(1).Header="Accept:application/json"
Voltage.Collect.Source(1).Body="{""password"":""%{PASSWORD}"",""username"":""%{USERNAME}"",""scope"": 0}"
Voltage.Collect.Source(1).ResultContent="all"

// Get Cookies
Voltage.Collect.Source(2)=%Voltage.Collect.Source(1)%
Voltage.Collect.Source(2).Compute(1).Type="Awk"
Voltage.Collect.Source(2).Compute(1).AwkScript=EmbeddedFile(2)

// Get body
Voltage.Collect.Source(3)=%Voltage.Collect.Source(1)%

Voltage.Collect.Source(3).Compute(1).Type="Awk"
Voltage.Collect.Source(3).Compute(1).AwkScript=EmbeddedFile(1)

Voltage.Collect.Source(3).Compute(2).Type="Json2Csv"
Voltage.Collect.Source(3).Compute(2).EntryKey="/data"
Voltage.Collect.Source(3).Compute(2).Properties="/deviceid;/iBaseToken;"

// append key to header value <key>:<value> ibaseToken:<token>
Voltage.Collect.Source(3).Compute(3).Type="LeftConcat"
Voltage.Collect.Source(3).Compute(3).Column=3
Voltage.Collect.Source(3).Compute(3).String="iBaseToken:"

// Stops sending invalid commands if session did not authenticate.
Voltage.Collect.Source(3).Compute(4).Type="ExcludeMatchingLines"
Voltage.Collect.Source(3).Compute(4).Column=3
Voltage.Collect.Source(3).Compute(4).RegExp="^iBaseToken:$"


// Keep iBaseToken as source 3
Voltage.Collect.Source(4)=%Voltage.Collect.Source(3)%

Voltage.Collect.Source(4).Compute(1).Type="KeepColumns"
Voltage.Collect.Source(4).Compute(1).ColumnNumbers="3"

Voltage.Collect.Source(4).Compute(2).Type="Awk"
Voltage.Collect.Source(4).Compute(2).AwkScript=EmbeddedFile(3)

// union iBaseToken, cookies and Acccept headers
Voltage.Collect.Source(5).Type="TableUnion"
Voltage.Collect.Source(5).Table1="Accept:Application/Json"
Voltage.Collect.Source(5).Table2=%Voltage.Collect.Source(2)%
Voltage.Collect.Source(5).Table3=%Voltage.Collect.Source(4)%

Voltage.Collect.Source(6).Type="HTTP"
Voltage.Collect.Source(6).Method="GET"
Voltage.Collect.Source(6).ExecuteForEachEntryOf=%Voltage.Collect.Source(3)%
Voltage.Collect.Source(6).Url="/deviceManager/rest/%Entry.Column(2)%/cpu"
Voltage.Collect.Source(6).Header=%Voltage.Collect.Source(5)%
Voltage.Collect.Source(6).EntryConcatMethod="JSONArrayExtended"

Voltage.Collect.Source(6).Compute(1).Type="Json2Csv"
Voltage.Collect.Source(6).Compute(1).EntryKey="/Entry/Value/data"
Voltage.Collect.Source(6).Compute(1).Properties="/ID;/HEALTHSTATUS;/HEALTHSTATUS;/VOLTS;"

Voltage.Collect.Source(6).Compute(2).Type="Divide"
Voltage.Collect.Source(6).Compute(2).Column=5
Voltage.Collect.Source(6).Compute(2).DivideBy=10

Voltage.Collect.Source(7).Type="HTTP"
Voltage.Collect.Source(7).Method="GET"
Voltage.Collect.Source(7).ExecuteForEachEntryOf=%Voltage.Collect.Source(3)%
Voltage.Collect.Source(7).Url="/deviceManager/rest/%Entry.Column(2)%/controller"
Voltage.Collect.Source(7).Header=%Voltage.Collect.Source(5)%
Voltage.Collect.Source(7).EntryConcatMethod="JSONArrayExtended"

Voltage.Collect.Source(7).Compute(1).Type="Json2Csv"
Voltage.Collect.Source(7).Compute(1).EntryKey="/Entry/Value/data"
Voltage.Collect.Source(7).Compute(1).Properties="/ID;/HEALTHSTATUS;/HEALTHSTATUS;/VOLTAGE;"

Voltage.Collect.Source(8).Type="TableUnion"
Voltage.Collect.Source(8).Table1=%Voltage.Collect.Source(6)%
Voltage.Collect.Source(8).Table2=%Voltage.Collect.Source(7)%

Voltage.Collect.Source(8).Compute(1).Type="LeftConcat"
Voltage.Collect.Source(8).Compute(1).Column=2
Voltage.Collect.Source(8).Compute(1).String="VOLT:"

Voltage.Collect.Source(8).Compute(2).Type="Translate"
Voltage.Collect.Source(8).Compute(2).Column=3
Voltage.Collect.Source(8).Compute(2).TranslationTable="HealthStatusTranslationTable"

Voltage.Collect.Source(8).Compute(3).Type="Translate"
Voltage.Collect.Source(8).Compute(3).Column=4
Voltage.Collect.Source(8).Compute(3).TranslationTable="HealthStatusInformationTranslationTable"

Voltage.Collect.Source(8).Compute(4).Type="Multiply"
Voltage.Collect.Source(8).Compute(4).Column=5
Voltage.Collect.Source(8).Compute(4).MultiplyBy=1000

// End Session
Voltage.Collect.Source(9).Type="HTTP"
Voltage.Collect.Source(9).Method="DELETE"
Voltage.Collect.Source(9).ExecuteForEachEntryOf=%Voltage.Collect.Source(3)%
Voltage.Collect.Source(9).Url="/deviceManager/rest/%Entry.Column(2)%/sessions"
Voltage.Collect.Source(9).Header=%Voltage.Collect.Source(5)%

Voltage.Collect.ValueTable=%Voltage.Collect.Source(8)%
Voltage.Collect.DeviceID=ValueTable.Column(2)
Voltage.Collect.Status=ValueTable.Column(3)
Voltage.Collect.StatusInformation=ValueTable.Column(4)
Voltage.Collect.Voltage=ValueTable.Column(5)



//
// DiskController
//

// HTTP: /controller
DiskController.Discovery.Source(1)=%Enclosure.Discovery.Source(12)%

DiskController.Discovery.Source(1).Compute(1).Type="Json2Csv"
DiskController.Discovery.Source(1).Compute(1).EntryKey="/Entry/Value/data"
DiskController.Discovery.Source(1).Compute(1).Properties="../../Column(2);/ID;/NAME;/SOFTVER;"

DiskController.Discovery.InstanceTable=%DiskController.Discovery.Source(1)%
DiskController.Discovery.Instance.DeviceID=InstanceTable.Column(3)
DiskController.Discovery.Instance.DisplayID=InstanceTable.Column(4)
DiskController.Discovery.Instance.FirmwareVersion=InstanceTable.Column(5)

DiskController.Discovery.Instance.AttachedToDeviceID=InstanceTable.Column(2)

// Collect

DiskController.Collect.Type="MultiInstance"

DiskController.Collect.Source(1).Type="HTTP"
DiskController.Collect.Source(1).Method="POST"
DiskController.Collect.Source(1).Url="deviceManager/rest/xxxxx/sessions"
DiskController.Collect.Source(1).Header="Accept:application/json"
DiskController.Collect.Source(1).Body="{""password"":""%{PASSWORD}"",""username"":""%{USERNAME}"",""scope"": 0}"
DiskController.Collect.Source(1).ResultContent="all"

// Get Cookies
DiskController.Collect.Source(2)=%DiskController.Collect.Source(1)%
DiskController.Collect.Source(2).Compute(1).Type="Awk"
DiskController.Collect.Source(2).Compute(1).AwkScript=EmbeddedFile(2)

// Get body
DiskController.Collect.Source(3)=%DiskController.Collect.Source(1)%

DiskController.Collect.Source(3).Compute(1).Type="Awk"
DiskController.Collect.Source(3).Compute(1).AwkScript=EmbeddedFile(1)

DiskController.Collect.Source(3).Compute(2).Type="Json2Csv"
DiskController.Collect.Source(3).Compute(2).EntryKey="/data"
DiskController.Collect.Source(3).Compute(2).Properties="/deviceid;/iBaseToken;"

// append key to header value <key>:<value> ibaseToken:<token>
DiskController.Collect.Source(3).Compute(3).Type="LeftConcat"
DiskController.Collect.Source(3).Compute(3).Column=3
DiskController.Collect.Source(3).Compute(3).String="iBaseToken:"

// Stops sending invalid commands if session did not authenticate.
DiskController.Collect.Source(3).Compute(4).Type="ExcludeMatchingLines"
DiskController.Collect.Source(3).Compute(4).Column=3
DiskController.Collect.Source(3).Compute(4).RegExp="^iBaseToken:$"

// Keep iBaseToken as source 3
DiskController.Collect.Source(4)=%DiskController.Collect.Source(3)%

DiskController.Collect.Source(4).Compute(1).Type="KeepColumns"
DiskController.Collect.Source(4).Compute(1).ColumnNumbers="3"

DiskController.Collect.Source(4).Compute(2).Type="Awk"
DiskController.Collect.Source(4).Compute(2).AwkScript=EmbeddedFile(3)

// union iBaseToken, cookies and Acccept headers
DiskController.Collect.Source(5).Type="TableUnion"
DiskController.Collect.Source(5).Table1="Accept:Application/Json"
DiskController.Collect.Source(5).Table2=%DiskController.Collect.Source(2)%
DiskController.Collect.Source(5).Table3=%DiskController.Collect.Source(4)%

DiskController.Collect.Source(6).Type="HTTP"
DiskController.Collect.Source(6).Method="GET"
DiskController.Collect.Source(6).ExecuteForEachEntryOf=%DiskController.Collect.Source(3)%
DiskController.Collect.Source(6).Url="/deviceManager/rest/%Entry.Column(2)%/controller"
DiskController.Collect.Source(6).Header=%DiskController.Collect.Source(5)%
DiskController.Collect.Source(6).EntryConcatMethod="JSONArrayExtended"

DiskController.Collect.Source(6).Compute(1).Type="Json2Csv"
DiskController.Collect.Source(6).Compute(1).EntryKey="/Entry/Value/data"
DiskController.Collect.Source(6).Compute(1).Properties="/ID;/HEALTHSTATUS;/HEALTHSTATUS;"

DiskController.Collect.Source(6).Compute(2).Type="Translate"
DiskController.Collect.Source(6).Compute(2).Column=3
DiskController.Collect.Source(6).Compute(2).TranslationTable="HealthStatusTranslationTable"

DiskController.Collect.Source(6).Compute(3).Type="Translate"
DiskController.Collect.Source(6).Compute(3).Column=4
DiskController.Collect.Source(6).Compute(3).TranslationTable="HealthStatusInformationTranslationTable"

// End Session
DiskController.Collect.Source(7).Type="HTTP"
DiskController.Collect.Source(7).Method="DELETE"
DiskController.Collect.Source(7).ExecuteForEachEntryOf=%DiskController.Collect.Source(3)%
DiskController.Collect.Source(7).Url="/deviceManager/rest/%Entry.Column(2)%/sessions"
DiskController.Collect.Source(7).Header=%DiskController.Collect.Source(5)%

DiskController.Collect.ValueTable=%DiskController.Collect.Source(6)%
DiskController.Collect.DeviceID=ValueTable.Column(2)
DiskController.Collect.ControllerStatus=ValueTable.Column(3)
DiskController.Collect.StatusInformation=ValueTable.Column(4)


//
// PowerSupply
//

PowerSupply.Discovery.Source(1)=%Enclosure.Discovery.Source(14)%

PowerSupply.Discovery.Source(1).Compute(1).Type="Json2Csv"
PowerSupply.Discovery.Source(1).Compute(1).EntryKey="/Entry/Value/data"
PowerSupply.Discovery.Source(1).Compute(1).Properties="/../../Column(2);/ID;/LOCATION;"

PowerSupply.Discovery.InstanceTable=%PowerSupply.Discovery.Source(1)%
PowerSupply.Discovery.Instance.DeviceID=InstanceTable.Column(3)
PowerSupply.Discovery.Instance.DisplayID=InstanceTable.Column(4)

PowerSupply.Discovery.Instance.AttachedToDeviceID=InstanceTable.Column(2)

// Collect

PowerSupply.Collect.Type="MultiInstance"

PowerSupply.Collect.Source(1).Type="HTTP"
PowerSupply.Collect.Source(1).Method="POST"
PowerSupply.Collect.Source(1).Url="deviceManager/rest/xxxxx/sessions"
PowerSupply.Collect.Source(1).Header="Accept:application/json"
PowerSupply.Collect.Source(1).Body="{""password"":""%{PASSWORD}"",""username"":""%{USERNAME}"",""scope"": 0}"
PowerSupply.Collect.Source(1).ResultContent="all"

// Get Cookies
PowerSupply.Collect.Source(2)=%PowerSupply.Collect.Source(1)%
PowerSupply.Collect.Source(2).Compute(1).Type="Awk"
PowerSupply.Collect.Source(2).Compute(1).AwkScript=EmbeddedFile(2)

// Get body
PowerSupply.Collect.Source(3)=%PowerSupply.Collect.Source(1)%

PowerSupply.Collect.Source(3).Compute(1).Type="Awk"
PowerSupply.Collect.Source(3).Compute(1).AwkScript=EmbeddedFile(1)

PowerSupply.Collect.Source(3).Compute(2).Type="Json2Csv"
PowerSupply.Collect.Source(3).Compute(2).EntryKey="/data"
PowerSupply.Collect.Source(3).Compute(2).Properties="/deviceid;/iBaseToken;"

// append key to header value <key>:<value> ibaseToken:<token>
PowerSupply.Collect.Source(3).Compute(3).Type="LeftConcat"
PowerSupply.Collect.Source(3).Compute(3).Column=3
PowerSupply.Collect.Source(3).Compute(3).String="iBaseToken:"

// Stops sending invalid commands if session did not authenticate.
PowerSupply.Collect.Source(3).Compute(4).Type="ExcludeMatchingLines"
PowerSupply.Collect.Source(3).Compute(4).Column=3
PowerSupply.Collect.Source(3).Compute(4).RegExp="^iBaseToken:$"


// Keep iBaseToken as source 3
PowerSupply.Collect.Source(4)=%PowerSupply.Collect.Source(3)%

PowerSupply.Collect.Source(4).Compute(1).Type="KeepColumns"
PowerSupply.Collect.Source(4).Compute(1).ColumnNumbers="3"

PowerSupply.Collect.Source(4).Compute(2).Type="Awk"
PowerSupply.Collect.Source(4).Compute(2).AwkScript=EmbeddedFile(3)

// union iBaseToken, cookies and Acccept headers
PowerSupply.Collect.Source(5).Type="TableUnion"
PowerSupply.Collect.Source(5).Table1="Accept:Application/Json"
PowerSupply.Collect.Source(5).Table2=%PowerSupply.Collect.Source(2)%
PowerSupply.Collect.Source(5).Table3=%PowerSupply.Collect.Source(4)%

PowerSupply.Collect.Source(6).Type="HTTP"
PowerSupply.Collect.Source(6).Method="GET"
PowerSupply.Collect.Source(6).ExecuteForEachEntryOf=%PowerSupply.Collect.Source(3)%
PowerSupply.Collect.Source(6).Url="/deviceManager/rest/%Entry.Column(2)%/power"
PowerSupply.Collect.Source(6).Header=%PowerSupply.Collect.Source(5)%
PowerSupply.Collect.Source(6).EntryConcatMethod="JSONArrayExtended"

PowerSupply.Collect.Source(6).Compute(1).Type="Json2Csv"
PowerSupply.Collect.Source(6).Compute(1).EntryKey="/Entry/Value/data"
PowerSupply.Collect.Source(6).Compute(1).Properties="/ID;/HEALTHSTATUS;/HEALTHSTATUS;"

PowerSupply.Collect.Source(6).Compute(2).Type="Translate"
PowerSupply.Collect.Source(6).Compute(2).Column=3
PowerSupply.Collect.Source(6).Compute(2).TranslationTable="HealthStatusTranslationTable"

PowerSupply.Collect.Source(6).Compute(3).Type="Translate"
PowerSupply.Collect.Source(6).Compute(3).Column=4
PowerSupply.Collect.Source(6).Compute(3).TranslationTable="HealthStatusInformationTranslationTable"

// End Session
PowerSupply.Collect.Source(7).Type="HTTP"
PowerSupply.Collect.Source(7).Method="DELETE"
PowerSupply.Collect.Source(7).ExecuteForEachEntryOf=%PowerSupply.Collect.Source(3)%
PowerSupply.Collect.Source(7).Url="/deviceManager/rest/%Entry.Column(2)%/sessions"
PowerSupply.Collect.Source(7).Header=%PowerSupply.Collect.Source(5)%

PowerSupply.Collect.ValueTable=%PowerSupply.Collect.Source(6)%
PowerSupply.Collect.DeviceID=ValueTable.Column(2)
PowerSupply.Collect.Status=ValueTable.Column(3)
PowerSupply.Collect.StatusInformation=ValueTable.Column(4)


//
// Battery
//


Battery.Discovery.Source(1)=%Enclosure.Discovery.Source(15)%

Battery.Discovery.Source(1).Compute(1).Type="Json2Csv"
Battery.Discovery.Source(1).Compute(1).EntryKey="/Entry/Value/data"
Battery.Discovery.Source(1).Compute(1).Properties="/../../Column(2);/ID;/LOCATION;"

Battery.Discovery.Source(1).Compute(2).Type="LeftConcat"
Battery.Discovery.Source(1).Compute(2).Column=4
Battery.Discovery.Source(1).Compute(2).String="BBU: "

Battery.Discovery.InstanceTable=%Battery.Discovery.Source(1)%
Battery.Discovery.Instance.DeviceID=InstanceTable.Column(4)
Battery.Discovery.Instance.DisplayID=InstanceTable.Column(4)

Battery.Discovery.Instance.AttachedToDeviceID=InstanceTable.Column(2)

// Collect

Battery.Collect.Type="MultiInstance"

Battery.Collect.Source(1).Type="HTTP"
Battery.Collect.Source(1).Method="POST"
Battery.Collect.Source(1).Url="deviceManager/rest/xxxxx/sessions"
Battery.Collect.Source(1).Header="Accept:application/json"
Battery.Collect.Source(1).Body="{""password"":""%{PASSWORD}"",""username"":""%{USERNAME}"",""scope"": 0}"
Battery.Collect.Source(1).ResultContent="all"

// Get Cookies
Battery.Collect.Source(2)=%Battery.Collect.Source(1)%
Battery.Collect.Source(2).Compute(1).Type="Awk"
Battery.Collect.Source(2).Compute(1).AwkScript=EmbeddedFile(2)

// Get body
Battery.Collect.Source(3)=%Battery.Collect.Source(1)%

Battery.Collect.Source(3).Compute(1).Type="Awk"
Battery.Collect.Source(3).Compute(1).AwkScript=EmbeddedFile(1)

Battery.Collect.Source(3).Compute(2).Type="Json2Csv"
Battery.Collect.Source(3).Compute(2).EntryKey="/data"
Battery.Collect.Source(3).Compute(2).Properties="/deviceid;/iBaseToken;"

// append key to header value <key>:<value> ibaseToken:<token>
Battery.Collect.Source(3).Compute(3).Type="LeftConcat"
Battery.Collect.Source(3).Compute(3).Column=3
Battery.Collect.Source(3).Compute(3).String="iBaseToken:"

// Stops sending invalid commands if session did not authenticate.
Battery.Collect.Source(3).Compute(4).Type="ExcludeMatchingLines"
Battery.Collect.Source(3).Compute(4).Column=3
Battery.Collect.Source(3).Compute(4).RegExp="^iBaseToken:$"

// Keep iBaseToken as source 3
Battery.Collect.Source(4)=%Battery.Collect.Source(3)%

Battery.Collect.Source(4).Compute(1).Type="KeepColumns"
Battery.Collect.Source(4).Compute(1).ColumnNumbers="3"

Battery.Collect.Source(4).Compute(2).Type="Awk"
Battery.Collect.Source(4).Compute(2).AwkScript=EmbeddedFile(3)

// union iBaseToken, cookies and Acccept headers
Battery.Collect.Source(5).Type="TableUnion"
Battery.Collect.Source(5).Table1="Accept:Application/Json"
Battery.Collect.Source(5).Table2=%Battery.Collect.Source(2)%
Battery.Collect.Source(5).Table3=%Battery.Collect.Source(4)%

Battery.Collect.Source(6).Type="HTTP"
Battery.Collect.Source(6).Method="GET"
Battery.Collect.Source(6).ExecuteForEachEntryOf=%Battery.Collect.Source(3)%
Battery.Collect.Source(6).Url="/deviceManager/rest/%Entry.Column(2)%/backup_power"
Battery.Collect.Source(6).Header=%Battery.Collect.Source(5)%
Battery.Collect.Source(6).EntryConcatMethod="JSONArrayExtended"

Battery.Collect.Source(6).Compute(1).Type="Json2Csv"
Battery.Collect.Source(6).Compute(1).EntryKey="/Entry/Value/data"
Battery.Collect.Source(6).Compute(1).Properties="/LOCATION;/HEALTHSTATUS;/HEALTHSTATUS;"

Battery.Collect.Source(6).Compute(2).Type="Translate"
Battery.Collect.Source(6).Compute(2).Column=3
Battery.Collect.Source(6).Compute(2).TranslationTable="HealthStatusTranslationTable"

Battery.Collect.Source(6).Compute(3).Type="Translate"
Battery.Collect.Source(6).Compute(3).Column=4
Battery.Collect.Source(6).Compute(3).TranslationTable="HealthStatusInformationTranslationTable"

Battery.Collect.Source(6).Compute(4).Type="LeftConcat"
Battery.Collect.Source(6).Compute(4).Column=2
Battery.Collect.Source(6).Compute(4).String="BBU: "

// End Session
Battery.Collect.Source(7).Type="HTTP"
Battery.Collect.Source(7).Method="DELETE"
Battery.Collect.Source(7).ExecuteForEachEntryOf=%Battery.Collect.Source(3)%
Battery.Collect.Source(7).Url="/deviceManager/rest/%Entry.Column(2)%/sessions"
Battery.Collect.Source(7).Header=%Battery.Collect.Source(5)%

Battery.Collect.ValueTable=%Battery.Collect.Source(6)%
Battery.Collect.DeviceID=ValueTable.Column(2)
Battery.Collect.Status=ValueTable.Column(3)
Battery.Collect.StatusInformation=ValueTable.Column(4)

//
// fan
//

// HTTP: /fan
Fan.Discovery.Source(1)=%Enclosure.Discovery.Source(13)%

Fan.Discovery.Source(1).Compute(1).Type="Json2Csv"
Fan.Discovery.Source(1).Compute(1).EntryKey="/Entry/Value/data"
Fan.Discovery.Source(1).Compute(1).Properties="/PARENTTYPE;../../Column(2);/ID;/LOCATION;"

Fan.Discovery.Source(1).Compute(2).Type="Translate"
Fan.Discovery.Source(1).Compute(2).Column=2
Fan.Discovery.Source(1).Compute(2).TranslationTable="TypeTranslationTable"

Fan.Discovery.Source(1).Compute(3).Type="LeftConcat"
Fan.Discovery.Source(1).Compute(3).Column=5
Fan.Discovery.Source(1).Compute(3).String="Fan: "


Fan.Discovery.InstanceTable=%Fan.Discovery.Source(1)%
Fan.Discovery.Instance.DeviceID=InstanceTable.Column(4)
Fan.Discovery.Instance.DisplayID=InstanceTable.Column(5)

Fan.Discovery.Instance.AttachedToDeviceID=InstanceTable.Column(3)
Fan.Discovery.Instance.AttachedToDeviceType=InstanceTable.Column(2)

// Collect

Fan.Collect.Type="MultiInstance"

Fan.Collect.Source(1).Type="HTTP"
Fan.Collect.Source(1).Method="POST"
Fan.Collect.Source(1).Url="deviceManager/rest/xxxxx/sessions"
Fan.Collect.Source(1).Header="Accept:application/json"
Fan.Collect.Source(1).Body="{""password"":""%{PASSWORD}"",""username"":""%{USERNAME}"",""scope"": 0}"
Fan.Collect.Source(1).ResultContent="all"

// Get Cookies
Fan.Collect.Source(2)=%Fan.Collect.Source(1)%
Fan.Collect.Source(2).Compute(1).Type="Awk"
Fan.Collect.Source(2).Compute(1).AwkScript=EmbeddedFile(2)

// Get body
Fan.Collect.Source(3)=%Fan.Collect.Source(1)%

Fan.Collect.Source(3).Compute(1).Type="Awk"
Fan.Collect.Source(3).Compute(1).AwkScript=EmbeddedFile(1)

Fan.Collect.Source(3).Compute(2).Type="Json2Csv"
Fan.Collect.Source(3).Compute(2).EntryKey="/data"
Fan.Collect.Source(3).Compute(2).Properties="/deviceid;/iBaseToken;"

// append key to header value <key>:<value> ibaseToken:<token>
Fan.Collect.Source(3).Compute(3).Type="LeftConcat"
Fan.Collect.Source(3).Compute(3).Column=3
Fan.Collect.Source(3).Compute(3).String="iBaseToken:"

// Stops sending invalid commands if session did not authenticate.
Fan.Collect.Source(3).Compute(4).Type="ExcludeMatchingLines"
Fan.Collect.Source(3).Compute(4).Column=3
Fan.Collect.Source(3).Compute(4).RegExp="^iBaseToken:$"


// Keep iBaseToken as source 3
Fan.Collect.Source(4)=%Fan.Collect.Source(3)%

Fan.Collect.Source(4).Compute(1).Type="KeepColumns"
Fan.Collect.Source(4).Compute(1).ColumnNumbers="3"

Fan.Collect.Source(4).Compute(2).Type="Awk"
Fan.Collect.Source(4).Compute(2).AwkScript=EmbeddedFile(3)

// union iBaseToken, cookies and Acccept headers
Fan.Collect.Source(5).Type="TableUnion"
Fan.Collect.Source(5).Table1="Accept:Application/Json"
Fan.Collect.Source(5).Table2=%Fan.Collect.Source(2)%
Fan.Collect.Source(5).Table3=%Fan.Collect.Source(4)%


Fan.Collect.Source(6).Type="HTTP"
Fan.Collect.Source(6).Method="GET"
Fan.Collect.Source(6).ExecuteForEachEntryOf=%Fan.Collect.Source(3)%
Fan.Collect.Source(6).Url="/deviceManager/rest/%Entry.Column(2)%/fan"
Fan.Collect.Source(6).Header=%Fan.Collect.Source(5)%
Fan.Collect.Source(6).EntryConcatMethod="JSONArrayExtended"

Fan.Collect.Source(6).Compute(1).Type="Json2Csv"
Fan.Collect.Source(6).Compute(1).EntryKey="/Entry/Value/data"
Fan.Collect.Source(6).Compute(1).Properties="/ID;/HEALTHSTATUS;/HEALTHSTATUS;"

Fan.Collect.Source(6).Compute(2).Type="Translate"
Fan.Collect.Source(6).Compute(2).Column=3
Fan.Collect.Source(6).Compute(2).TranslationTable="HealthStatusTranslationTable"

Fan.Collect.Source(6).Compute(3).Type="Translate"
Fan.Collect.Source(6).Compute(3).Column=4
Fan.Collect.Source(6).Compute(3).TranslationTable="HealthStatusInformationTranslationTable"

// End Session
Fan.Collect.Source(7).Type="HTTP"
Fan.Collect.Source(7).Method="DELETE"
Fan.Collect.Source(7).ExecuteForEachEntryOf=%Fan.Collect.Source(3)%
Fan.Collect.Source(7).Url="/deviceManager/rest/%Entry.Column(2)%/sessions"
Fan.Collect.Source(7).Header=%Fan.Collect.Source(5)%

Fan.Collect.ValueTable=%Fan.Collect.Source(6)%
Fan.Collect.DeviceID=ValueTable.Column(2)
Fan.Collect.Status=ValueTable.Column(3)
Fan.Collect.StatusInformation=ValueTable.Column(4)


//
// PhysicalDisk
//

// HTTP: /disk
PhysicalDisk.Discovery.Source(1)=%Enclosure.Discovery.Source(8)%

PhysicalDisk.Discovery.Source(1).Compute(1).Type="Json2Csv"
PhysicalDisk.Discovery.Source(1).Compute(1).EntryKey="/Entry/Value/data"
PhysicalDisk.Discovery.Source(1).Compute(1).Properties="../../Column(2);/ID;DISKTYPE;/MODEL;/FIRMWAREVER;/MANUFACTURER;/SERIALNUMBER;/LOCATION;/SECTORS;/SECTORSIZE;"

PhysicalDisk.Discovery.Source(1).Compute(2).Type="Translate"
PhysicalDisk.Discovery.Source(1).Compute(2).Column=4
PhysicalDisk.Discovery.Source(1).Compute(2).TranslationTable="PhysicalDiskTypeTranslationTable"

PhysicalDiskTypeTranslationTable(0)="FC"
PhysicalDiskTypeTranslationTable(1)="SAS"
PhysicalDiskTypeTranslationTable(2)="SATA"
PhysicalDiskTypeTranslationTable(3)="SSD"
PhysicalDiskTypeTranslationTable(4)="NL_SAS"
PhysicalDiskTypeTranslationTable(5)="SLC_SSD"
PhysicalDiskTypeTranslationTable(6)="MLC_SSD"
PhysicalDiskTypeTranslationTable(7)="FC_SED"
PhysicalDiskTypeTranslationTable(8)="SAS_SED"
PhysicalDiskTypeTranslationTable(9)="SATA_SED"
PhysicalDiskTypeTranslationTable(10)="SSD_SED"
PhysicalDiskTypeTranslationTable(11)="NL_SAS_SED"
PhysicalDiskTypeTranslationTable(12)="SLC_SSD_SED"
PhysicalDiskTypeTranslationTable(13)="MLC_SSD_SED"

// Get disk size (sectors * sector size)
PhysicalDisk.Discovery.Source(1).Compute(3).Type="Multiply"
PhysicalDisk.Discovery.Source(1).Compute(3).Column=10
PhysicalDisk.Discovery.Source(1).Compute(3).MultiplyBy=Column(11)

PhysicalDisk.Discovery.InstanceTable=%PhysicalDisk.Discovery.Source(1)%
PhysicalDisk.Discovery.Instance.DeviceID=InstanceTable.Column(3)
PhysicalDisk.Discovery.Instance.DisplayID=InstanceTable.Column(9)
PhysicalDisk.Discovery.Instance.Model=InstanceTable.Column(5)
PhysicalDisk.Discovery.Instance.FirmwareVersion=InstanceTable.Column(6)
PhysicalDisk.Discovery.Instance.Vendor=InstanceTable.Column(7)
PhysicalDisk.Discovery.Instance.SerialNumber=InstanceTable.Column(8)
PhysicalDisk.Discovery.Instance.Size=InstanceTable.Column(10)

PhysicalDisk.Discovery.Instance.AttachedToDeviceID=InstanceTable.Column(2)

// collect

PhysicalDisk.Collect.Type="MultiInstance"

PhysicalDisk.Collect.Source(1).Type="HTTP"
PhysicalDisk.Collect.Source(1).Method="POST"
PhysicalDisk.Collect.Source(1).Url="deviceManager/rest/xxxxx/sessions"
PhysicalDisk.Collect.Source(1).Header="Accept:application/json"
PhysicalDisk.Collect.Source(1).Body="{""password"":""%{PASSWORD}"",""username"":""%{USERNAME}"",""scope"": 0}"
PhysicalDisk.Collect.Source(1).ResultContent="all"

// Get Cookies
PhysicalDisk.Collect.Source(2)=%PhysicalDisk.Collect.Source(1)%
PhysicalDisk.Collect.Source(2).Compute(1).Type="Awk"
PhysicalDisk.Collect.Source(2).Compute(1).AwkScript=EmbeddedFile(2)

// Get body
PhysicalDisk.Collect.Source(3)=%PhysicalDisk.Collect.Source(1)%

PhysicalDisk.Collect.Source(3).Compute(1).Type="Awk"
PhysicalDisk.Collect.Source(3).Compute(1).AwkScript=EmbeddedFile(1)

PhysicalDisk.Collect.Source(3).Compute(2).Type="Json2Csv"
PhysicalDisk.Collect.Source(3).Compute(2).EntryKey="/data"
PhysicalDisk.Collect.Source(3).Compute(2).Properties="/deviceid;/iBaseToken;"

// append key to header value <key>:<value> ibaseToken:<token>
PhysicalDisk.Collect.Source(3).Compute(3).Type="LeftConcat"
PhysicalDisk.Collect.Source(3).Compute(3).Column=3
PhysicalDisk.Collect.Source(3).Compute(3).String="iBaseToken:"

// Stops sending invalid commands if session did not authenticate.
PhysicalDisk.Collect.Source(3).Compute(4).Type="ExcludeMatchingLines"
PhysicalDisk.Collect.Source(3).Compute(4).Column=3
PhysicalDisk.Collect.Source(3).Compute(4).RegExp="^iBaseToken:$"


// Keep iBaseToken as source 3
PhysicalDisk.Collect.Source(4)=%PhysicalDisk.Collect.Source(3)%

PhysicalDisk.Collect.Source(4).Compute(1).Type="KeepColumns"
PhysicalDisk.Collect.Source(4).Compute(1).ColumnNumbers="3"

PhysicalDisk.Collect.Source(4).Compute(2).Type="Awk"
PhysicalDisk.Collect.Source(4).Compute(2).AwkScript=EmbeddedFile(3)

// union iBaseToken, cookies and Acccept headers
PhysicalDisk.Collect.Source(5).Type="TableUnion"
PhysicalDisk.Collect.Source(5).Table1="Accept:Application/Json"
PhysicalDisk.Collect.Source(5).Table2=%PhysicalDisk.Collect.Source(2)%
PhysicalDisk.Collect.Source(5).Table3=%PhysicalDisk.Collect.Source(4)%


PhysicalDisk.Collect.Source(6).Type="HTTP"
PhysicalDisk.Collect.Source(6).Method="GET"
PhysicalDisk.Collect.Source(6).ExecuteForEachEntryOf=%PhysicalDisk.Collect.Source(3)%
PhysicalDisk.Collect.Source(6).Url="/deviceManager/rest/%Entry.Column(2)%/disk"
PhysicalDisk.Collect.Source(6).Header=%PhysicalDisk.Collect.Source(5)%
PhysicalDisk.Collect.Source(6).EntryConcatMethod="JSONArrayExtended"

PhysicalDisk.Collect.Source(6).Compute(1).Type="Json2Csv"
PhysicalDisk.Collect.Source(6).Compute(1).EntryKey="/Entry/Value/data"
PhysicalDisk.Collect.Source(6).Compute(1).Properties="/ID;/HEALTHSTATUS;/HEALTHSTATUS;/ABRASIONRATE;;"

PhysicalDisk.Collect.Source(6).Compute(2).Type="Translate"
PhysicalDisk.Collect.Source(6).Compute(2).Column=3
PhysicalDisk.Collect.Source(6).Compute(2).TranslationTable="HealthStatusTranslationTable"

PhysicalDisk.Collect.Source(6).Compute(3).Type="Translate"
PhysicalDisk.Collect.Source(6).Compute(3).Column=4
PhysicalDisk.Collect.Source(6).Compute(3).TranslationTable="HealthStatusInformationTranslationTable"

PhysicalDisk.Collect.Source(6).Compute(4).Type="Replace"
PhysicalDisk.Collect.Source(6).Compute(4).Column=6
PhysicalDisk.Collect.Source(6).Compute(4).Replace=""
PhysicalDisk.Collect.Source(6).Compute(4).ReplaceBy=100

PhysicalDisk.Collect.Source(6).Compute(5).Type="Substract"
PhysicalDisk.Collect.Source(6).Compute(5).Column=6
PhysicalDisk.Collect.Source(6).Compute(5).Substract=Column(5)

// End Session
PhysicalDisk.Collect.Source(7).Type="HTTP"
PhysicalDisk.Collect.Source(7).Method="DELETE"
PhysicalDisk.Collect.Source(7).ExecuteForEachEntryOf=%PhysicalDisk.Collect.Source(3)%
PhysicalDisk.Collect.Source(7).Url="/deviceManager/rest/%Entry.Column(2)%/sessions"
PhysicalDisk.Collect.Source(7).Header=%PhysicalDisk.Collect.Source(5)%

PhysicalDisk.Collect.ValueTable=%PhysicalDisk.Collect.Source(6)%
PhysicalDisk.Collect.DeviceID=ValueTable.Column(2)
PhysicalDisk.Collect.Status=ValueTable.Column(3)
PhysicalDisk.Collect.StatusInformation=ValueTable.Column(4)
PhysicalDisk.Collect.EnduranceRemaining=ValueTable.Column(6)


//
// Logical Disk
//

LogicalDisk.Discovery.Source(1)=%Enclosure.Discovery.Source(7)%

LogicalDisk.Discovery.Source(1).Compute(1).Type="Json2Csv"
LogicalDisk.Discovery.Source(1).Compute(1).EntryKey="/Entry/Value/data"
LogicalDisk.Discovery.Source(1).Compute(1).Properties="../../Column(2);/ID;/NAME;/PARENTID;/SECTORSIZE;/CAPACITY;/WORKINGCONTROLLER;/ALLOCTYPE;"

// Get disk size (sectors * capacity)
LogicalDisk.Discovery.Source(1).Compute(2).Type="Multiply"
LogicalDisk.Discovery.Source(1).Compute(2).Column=6
LogicalDisk.Discovery.Source(1).Compute(2).MultiplyBy=Column(7)

LogicalDisk.Discovery.Source(1).Compute(3).Type="Translate"
LogicalDisk.Discovery.Source(1).Compute(3).Column=9
LogicalDisk.Discovery.Source(1).Compute(3).TranslationTable="LogicalDiskTypeTranslationTable"

LogicalDiskTypeTranslationTable(0)="Thick LUN"
LogicalDiskTypeTranslationTable(1)="Thin LUN"
LogicalDiskTypeTranslationTable(2)="Snapshot"

LogicalDisk.Discovery.InstanceTable=%LogicalDisk.Discovery.Source(1)%
LogicalDisk.Discovery.Instance.DeviceID=InstanceTable.Column(3)
LogicalDisk.Discovery.Instance.DisplayID=InstanceTable.Column(4)
LogicalDisk.Discovery.Instance.Size=InstanceTable.Column(6)
LogicalDisk.Discovery.Instance.LogicalDiskType="Volume"

LogicalDisk.Discovery.Instance.AttachedToDeviceID=InstanceTable.Column(8)
LogicalDisk.Discovery.Instance.AttachedToDeviceType="DiskController"


// Collect

LogicalDisk.Collect.Source(1).Type="HTTP"
LogicalDisk.Collect.Source(1).Method="POST"
LogicalDisk.Collect.Source(1).Url="deviceManager/rest/xxxxx/sessions"
LogicalDisk.Collect.Source(1).Header="Accept:application/json"
LogicalDisk.Collect.Source(1).Body="{""password"":""%{PASSWORD}"",""username"":""%{USERNAME}"",""scope"": 0}"
LogicalDisk.Collect.Source(1).ResultContent="all"

// Get Cookies
LogicalDisk.Collect.Source(2)=%LogicalDisk.Collect.Source(1)%
LogicalDisk.Collect.Source(2).Compute(1).Type="Awk"
LogicalDisk.Collect.Source(2).Compute(1).AwkScript=EmbeddedFile(2)

// Get body
LogicalDisk.Collect.Source(3)=%LogicalDisk.Collect.Source(1)%

LogicalDisk.Collect.Source(3).Compute(1).Type="Awk"
LogicalDisk.Collect.Source(3).Compute(1).AwkScript=EmbeddedFile(1)

LogicalDisk.Collect.Source(3).Compute(2).Type="Json2Csv"
LogicalDisk.Collect.Source(3).Compute(2).EntryKey="/data"
LogicalDisk.Collect.Source(3).Compute(2).Properties="/deviceid;/iBaseToken;"

// append key to header value <key>:<value> ibaseToken:<token>
LogicalDisk.Collect.Source(3).Compute(3).Type="LeftConcat"
LogicalDisk.Collect.Source(3).Compute(3).Column=3
LogicalDisk.Collect.Source(3).Compute(3).String="iBaseToken:"

// Stops sending invalid commands if session did not authenticate.
LogicalDisk.Collect.Source(3).Compute(4).Type="ExcludeMatchingLines"
LogicalDisk.Collect.Source(3).Compute(4).Column=3
LogicalDisk.Collect.Source(3).Compute(4).RegExp="^iBaseToken:$"


// Keep iBaseToken as source 3
LogicalDisk.Collect.Source(4)=%LogicalDisk.Collect.Source(3)%

LogicalDisk.Collect.Source(4).Compute(1).Type="KeepColumns"
LogicalDisk.Collect.Source(4).Compute(1).ColumnNumbers="3"

LogicalDisk.Collect.Source(4).Compute(2).Type="Awk"
LogicalDisk.Collect.Source(4).Compute(2).AwkScript=EmbeddedFile(3)

// union iBaseToken, cookies and Acccept headers
LogicalDisk.Collect.Source(5).Type="TableUnion"
LogicalDisk.Collect.Source(5).Table1="Accept:Application/Json"
LogicalDisk.Collect.Source(5).Table2=%LogicalDisk.Collect.Source(2)%
LogicalDisk.Collect.Source(5).Table3=%LogicalDisk.Collect.Source(4)%


LogicalDisk.Collect.Source(6).Type="HTTP"
LogicalDisk.Collect.Source(6).Method="GET"
LogicalDisk.Collect.Source(6).ExecuteForEachEntryOf=%LogicalDisk.Collect.Source(3)%
LogicalDisk.Collect.Source(6).Url="/deviceManager/rest/%Entry.Column(2)%/lun"
LogicalDisk.Collect.Source(6).Header=%LogicalDisk.Collect.Source(5)%
LogicalDisk.Collect.Source(6).EntryConcatMethod="JSONArrayExtended"

LogicalDisk.Collect.Source(6).Compute(1).Type="Json2Csv"
LogicalDisk.Collect.Source(6).Compute(1).EntryKey="/data"
LogicalDisk.Collect.Source(6).Compute(1).Properties="ID;/HEALTHSTATUS;/HEALTHSTATUS;"

LogicalDisk.Collect.Source(6).Compute(2).Type="Translate"
LogicalDisk.Collect.Source(6).Compute(2).Column=3
LogicalDisk.Collect.Source(6).Compute(2).TranslationTable="HealthStatusTranslationTable"

LogicalDisk.Collect.Source(6).Compute(3).Type="Translate"
LogicalDisk.Collect.Source(6).Compute(3).Column=4
LogicalDisk.Collect.Source(6).Compute(3).TranslationTable="HealthStatusInformationTranslationTable"

// End Session
LogicalDisk.Collect.Source(7).Type="HTTP"
LogicalDisk.Collect.Source(7).Method="DELETE"
LogicalDisk.Collect.Source(7).ExecuteForEachEntryOf=%LogicalDisk.Collect.Source(3)%
LogicalDisk.Collect.Source(7).Url="/deviceManager/rest/%Entry.Column(2)%/sessions"
LogicalDisk.Collect.Source(7).Header=%LogicalDisk.Collect.Source(5)%

LogicalDisk.Collect.ValueTable=%LogicalDisk.Collect.Source(6)%
LogicalDisk.Collect.DeviceID=ValueTable.Column(2)
LogicalDisk.Collect.Status=ValueTable.Column(3)
LogicalDisk.Collect.StatusInformation=ValueTable.Column(4)


//
// NetworkCard
//

// FC Port
NetworkCard.Discovery.Source(1)=%Enclosure.Discovery.Source(9)%

NetworkCard.Discovery.Source(1).Compute(1).Type="Json2Csv"
NetworkCard.Discovery.Source(1).Compute(1).EntryKey="/Entry/Value/data"
NetworkCard.Discovery.Source(1).Compute(1).Properties="/PARENTID;/ID;/LOCATION;/WWN;/TYPE;/PARENTTYPE;"

NetworkCard.Discovery.Source(1).Compute(2).Type="RightConcat"
NetworkCard.Discovery.Source(1).Compute(2).Column=7
NetworkCard.Discovery.Source(1).Compute(2).String=";FC Port"

// SAS Port
NetworkCard.Discovery.Source(2)=%Enclosure.Discovery.Source(10)%

NetworkCard.Discovery.Source(2).Compute(1).Type="Json2Csv"
NetworkCard.Discovery.Source(2).Compute(1).EntryKey="/Entry/Value/data"
NetworkCard.Discovery.Source(2).Compute(1).Properties="/PARENTID;/ID;/LOCATION;/WWN;/TYPE;/PARENTTYPE;"

NetworkCard.Discovery.Source(2).Compute(2).Type="RightConcat"
NetworkCard.Discovery.Source(2).Compute(2).Column=7
NetworkCard.Discovery.Source(2).Compute(2).String=";SAS Port"

// ETH Port
NetworkCard.Discovery.Source(3)=%Enclosure.Discovery.Source(11)%

NetworkCard.Discovery.Source(3).Compute(1).Type="Json2Csv"
NetworkCard.Discovery.Source(3).Compute(1).EntryKey="/Entry/Value/data"
NetworkCard.Discovery.Source(3).Compute(1).Properties="/PARENTID;/ID;/LOCATION;/MACADDRESS;/TYPE;/PARENTTYPE;"

NetworkCard.Discovery.Source(3).Compute(2).Type="RightConcat"
NetworkCard.Discovery.Source(3).Compute(2).Column=7
NetworkCard.Discovery.Source(3).Compute(2).String=";Ethernet Port"

// UNION
NetworkCard.Discovery.Source(4).Type="TableUnion"
NetworkCard.Discovery.Source(4).Table1=%NetworkCard.Discovery.Source(1)%
NetworkCard.Discovery.Source(4).Table2=%NetworkCard.Discovery.Source(2)%
NetworkCard.Discovery.Source(4).Table3=%NetworkCard.Discovery.Source(3)%

NetworkCard.Discovery.Source(4).Compute(1).Type="Translate"
NetworkCard.Discovery.Source(4).Compute(1).Column=6
NetworkCard.Discovery.Source(4).Compute(1).TranslationTable="TypeTranslationTable"

NetworkCard.Discovery.Source(4).Compute(2).Type="Replace"
NetworkCard.Discovery.Source(4).Compute(2).Column=2
NetworkCard.Discovery.Source(4).Compute(2).Replace=".0"
NetworkCard.Discovery.Source(4).Compute(2).ReplaceBy=""

NetworkCard.Discovery.Source(4).Compute(3).Type="Translate"
NetworkCard.Discovery.Source(4).Compute(3).Column=7
NetworkCard.Discovery.Source(4).Compute(3).TranslationTable="TypeTranslationTable"

NetworkCard.Discovery.InstanceTable=%NetworkCard.Discovery.Source(4)%
NetworkCard.Discovery.Instance.DeviceID=InstanceTable.Column(3)
NetworkCard.Discovery.Instance.DisplayID=InstanceTable.Column(4)
NetworkCard.Discovery.Instance.LogicalAddress=InstanceTable.Column(5)
NetworkCard.Discovery.Instance.LogicalAddressType=InstanceTable.Column(8)
NetworkCard.Discovery.Instance.DeviceType=InstanceTable.Column(6)

NetworkCard.Discovery.Instance.AttachedToDeviceID=InstanceTable.Column(2)
NetworkCard.Discovery.Instance.AttachedToDeviceType=InstanceTable.Column(7)

// collect

// FC Port

NetworkCard.Collect.Type="MultiInstance"

NetworkCard.Collect.Source(1).Type="HTTP"
NetworkCard.Collect.Source(1).Method="POST"
NetworkCard.Collect.Source(1).Url="deviceManager/rest/xxxxx/sessions"
NetworkCard.Collect.Source(1).Header="Accept:application/json"
NetworkCard.Collect.Source(1).Body="{""password"":""%{PASSWORD}"",""username"":""%{USERNAME}"",""scope"": 0}"
NetworkCard.Collect.Source(1).ResultContent="all"

// Get Cookies
NetworkCard.Collect.Source(2)=%NetworkCard.Collect.Source(1)%
NetworkCard.Collect.Source(2).Compute(1).Type="Awk"
NetworkCard.Collect.Source(2).Compute(1).AwkScript=EmbeddedFile(2)

// Get body
NetworkCard.Collect.Source(3)=%NetworkCard.Collect.Source(1)%

NetworkCard.Collect.Source(3).Compute(1).Type="Awk"
NetworkCard.Collect.Source(3).Compute(1).AwkScript=EmbeddedFile(1)

NetworkCard.Collect.Source(3).Compute(2).Type="Json2Csv"
NetworkCard.Collect.Source(3).Compute(2).EntryKey="/data"
NetworkCard.Collect.Source(3).Compute(2).Properties="/deviceid;/iBaseToken;"

// append key to header value <key>:<value> ibaseToken:<token>
NetworkCard.Collect.Source(3).Compute(3).Type="LeftConcat"
NetworkCard.Collect.Source(3).Compute(3).Column=3
NetworkCard.Collect.Source(3).Compute(3).String="iBaseToken:"

// Stops sending invalid commands if session did not authenticate.
NetworkCard.Collect.Source(3).Compute(4).Type="ExcludeMatchingLines"
NetworkCard.Collect.Source(3).Compute(4).Column=3
NetworkCard.Collect.Source(3).Compute(4).RegExp="^iBaseToken:$"


// Keep iBaseToken as source 3
NetworkCard.Collect.Source(4)=%NetworkCard.Collect.Source(3)%

NetworkCard.Collect.Source(4).Compute(1).Type="KeepColumns"
NetworkCard.Collect.Source(4).Compute(1).ColumnNumbers="3"

NetworkCard.Collect.Source(4).Compute(2).Type="Awk"
NetworkCard.Collect.Source(4).Compute(2).AwkScript=EmbeddedFile(3)

// union iBaseToken, cookies and Acccept headers
NetworkCard.Collect.Source(5).Type="TableUnion"
NetworkCard.Collect.Source(5).Table1="Accept:Application/Json"
NetworkCard.Collect.Source(5).Table2=%NetworkCard.Collect.Source(2)%
NetworkCard.Collect.Source(5).Table3=%NetworkCard.Collect.Source(4)%

NetworkCard.Collect.Source(6).Type="HTTP"
NetworkCard.Collect.Source(6).Method="GET"
NetworkCard.Collect.Source(6).ExecuteForEachEntryOf=%NetworkCard.Collect.Source(3)%
NetworkCard.Collect.Source(6).Url="/deviceManager/rest/%Entry.Column(2)%/fc_port"
NetworkCard.Collect.Source(6).Header=%NetworkCard.Collect.Source(5)%
NetworkCard.Collect.Source(6).EntryConcatMethod="JSONArrayExtended"

NetworkCard.Collect.Source(6).Compute(1).Type="Json2Csv"
NetworkCard.Collect.Source(6).Compute(1).EntryKey="/Entry/Value/data"
NetworkCard.Collect.Source(6).Compute(1).Properties="/ID;/HEALTHSTATUS;/HEALTHSTATUS;/RUNNINGSTATUS;/CONFSPEED;"
NetworkCard.Collect.Source(6).Compute(1).Properties="/ID;/HEALTHSTATUS;/HEALTHSTATUS;/RUNNINGSTATUS;/RUNSPEED;"

// SAS Port
NetworkCard.Collect.Source(7).Type="HTTP"
NetworkCard.Collect.Source(7).Method="GET"
NetworkCard.Collect.Source(7).ExecuteForEachEntryOf=%NetworkCard.Collect.Source(3)%
NetworkCard.Collect.Source(7).Url="/deviceManager/rest/%Entry.Column(2)%/sas_port"
NetworkCard.Collect.Source(7).Header=%NetworkCard.Collect.Source(5)%
NetworkCard.Collect.Source(7).EntryConcatMethod="JSONArrayExtended"

NetworkCard.Collect.Source(7).Compute(1).Type="Json2Csv"
NetworkCard.Collect.Source(7).Compute(1).EntryKey="/Entry/Value/data"
NetworkCard.Collect.Source(7).Compute(1).Properties="/ID;/HEALTHSTATUS;/HEALTHSTATUS;/RUNNINGSTATUS;/RUNSPEED;"

// ETH Port
NetworkCard.Collect.Source(8).Type="HTTP"
NetworkCard.Collect.Source(8).Method="GET"
NetworkCard.Collect.Source(8).ExecuteForEachEntryOf=%NetworkCard.Collect.Source(3)%
NetworkCard.Collect.Source(8).Url="/deviceManager/rest/%Entry.Column(2)%/eth_port"
NetworkCard.Collect.Source(8).Header=%NetworkCard.Collect.Source(5)%
NetworkCard.Collect.Source(8).EntryConcatMethod="JSONArrayExtended"

NetworkCard.Collect.Source(8).Compute(1).Type="Json2Csv"
NetworkCard.Collect.Source(8).Compute(1).EntryKey="/Entry/Value/data"
NetworkCard.Collect.Source(8).Compute(1).Properties="/ID;/HEALTHSTATUS;/HEALTHSTATUS;/RUNNINGSTATUS;/SPEED;"

NetworkCard.Collect.Source(9).Type="TableUnion"
NetworkCard.Collect.Source(9).Table1=%NetworkCard.Collect.Source(6)%
NetworkCard.Collect.Source(9).Table2=%NetworkCard.Collect.Source(7)%
NetworkCard.Collect.Source(9).Table3=%NetworkCard.Collect.Source(8)%

NetworkCard.Collect.Source(9).Compute(1).Type="Translate"
NetworkCard.Collect.Source(9).Compute(1).Column=3
NetworkCard.Collect.Source(9).Compute(1).TranslationTable="HealthStatusTranslationTable"

NetworkCard.Collect.Source(9).Compute(2).Type="Translate"
NetworkCard.Collect.Source(9).Compute(2).Column=4
NetworkCard.Collect.Source(9).Compute(2).TranslationTable="HealthStatusInformationTranslationTable"

NetworkCard.Collect.Source(9).Compute(3).Type="Translate"
NetworkCard.Collect.Source(9).Compute(3).Column=5
NetworkCard.Collect.Source(9).Compute(3).TranslationTable="LinkStatusTranslationTable"

NetworkCard.Collect.Source(9).Compute(4).Type="Replace"
NetworkCard.Collect.Source(9).Compute(4).Column=6
NetworkCard.Collect.Source(9).Compute(4).Replace="-1"
NetworkCard.Collect.Source(9).Compute(4).ReplaceBy="0"

// End Session
NetworkCard.Collect.Source(10).Type="HTTP"
NetworkCard.Collect.Source(10).Method="DELETE"
NetworkCard.Collect.Source(10).ExecuteForEachEntryOf=%NetworkCard.Collect.Source(3)%
NetworkCard.Collect.Source(10).Url="/deviceManager/rest/%Entry.Column(2)%/sessions"
NetworkCard.Collect.Source(10).Header=%NetworkCard.Collect.Source(5)%


LinkStatusTranslationTable(0)="WARN"
LinkStatusTranslationTable(1)="OK"
LinkStatusTranslationTable(2)="OK"
LinkStatusTranslationTable(10)="OK"
LinkStatusTranslationTable(11)="WARN"
LinkStatusTranslationTable(53)="WARN"

NetworkCard.Collect.ValueTable=%NetworkCard.Collect.Source(9)%
NetworkCard.Collect.DeviceID=ValueTable.Column(2)
NetworkCard.Collect.Status=ValueTable.Column(3)
NetworkCard.Collect.StatusInformation=ValueTable.Column(4)
NetworkCard.Collect.LinkStatus=ValueTable.Column(5)
NetworkCard.Collect.LinkSpeed=ValueTable.Column(6)

TypeTranslationTable(206)="Enclosure"
TypeTranslationTable(207)="DiskController"
TypeTranslationTable(209)="DiskController" // Interface Modules
TypeTranslationTable(211)="Fan"
TypeTranslationTable(212)="Fibre Channel"
TypeTranslationTable(213)="Ethernet"
TypeTranslationTable(214)="SAS"

HealthStatusTranslationTable(0)="UNKNOWN"
HealthStatusTranslationTable(1)="OK"
HealthStatusTranslationTable(2)="ALARM"
HealthStatusTranslationTable(3)="WARN"
HealthStatusTranslationTable(9)="WARN"
HealthStatusTranslationTable(11)="WARN"
HealthStatusTranslationTable(12)="WARN"

HealthStatusInformationTranslationTable(0)="Unknown"
HealthStatusInformationTranslationTable(1)="Normal"
HealthStatusInformationTranslationTable(2)="Faulty"
HealthStatusInformationTranslationTable(3)="Failing"
HealthStatusInformationTranslationTable(9)="inconsistent"
HealthStatusInformationTranslationTable(11)="no input"
HealthStatusInformationTranslationTable(12)="low battery"


/////////////////////////////////////////////////////////
///
///    E M B E D D E D   F I L E ! ! !
///
///    EmbeddedFile(1) = body
/////////////////////////////////////////////////////////
EmbeddedFile(1):
BEGIN
{
  if ( $1 ~ /^[{]/ ) {
    print $0
  }
}
EmbeddedFile(1).End
/////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////
///
///    E M B E D D E D   F I L E ! ! !
///
///    EmbeddedFile(2) = Cookie Monster
/////////////////////////////////////////////////////////
EmbeddedFile(2):
BEGIN {FS=":";}
{
if ($1 == "Set-Cookie")
    {
       cookie = $2 ; gsub(/^[ \t]+/, "", cookie) ;
	     print "Cookie:" cookie
    }
}
EmbeddedFile(2).End
////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////
///
///    E M B E D D E D   F I L E ! ! !
///
///    EmbeddedFile(3) = remove ; from iBaseToken
/////////////////////////////////////////////////////////
EmbeddedFile(3):
BEGIN {FS=":";}
{
if ($1 == "iBaseToken")
    {
       ibt = $2 ; gsub(/;/, "", ibt) ;
	     print "iBaseToken:" ibt
    }
}
EmbeddedFile(3).End
/////////////////////////////////////////////////////////////////////
