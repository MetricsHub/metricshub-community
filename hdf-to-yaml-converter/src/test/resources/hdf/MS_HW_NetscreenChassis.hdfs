////////////////////////////////////////////////////////////////
//
//    H a r d w a r e   D e f i n i t i o n   F i l e
//
//                       f o r
//
//                 Hardware Sentry
//
//                 by Sentry Software (c)
//
//
//      Supports: Juniper Netscreen via NETSCREEN-CHASSIS-MIB
//                Connects to a SNMP agent
//


//
// Header
//

hdf.DisplayName="Juniper Netscreen (SNMP)"
hdf.TypicalPlatform="Netscreen"
hdf.ReliesOn="Juniper SNMP Agent (NETSCREEN-CHASSIS-MIB)"
hdf.Version="1.0"
hdf.Comments="This connector discovers the enclosure, fans, power supplies, temperatures, etc. of Juniper Netscreen Network Switches."
hdf.RemoteSupport="true"
hdf.AppliesToOS="Network"

//
// DETECTION
//

// Check that there are Juniper FRU OIDs
Detection.Criteria(1).Type="SNMP"
Detection.Criteria(1).SnmpGetNext="1.3.6.1.4.1.3224.21.1"

//
// Enclosure
//

Enclosure.Discovery.InstanceTable="Juniper"
Enclosure.Discovery.Instance.DeviceID="Chassis"
Enclosure.Discovery.Instance.DisplayID="Switch"
Enclosure.Discovery.Instance.Model="Netscreen"
Enclosure.Discovery.Instance.Vendor="Juniper"
Enclosure.Discovery.Instance.Type="Switch"

// No collect for Enclosure.


//
// OtherDevice
//

OtherDevice.Discovery.Source(1).Type="SnmpTable"
OtherDevice.Discovery.Source(1).SnmpTableOid="1.3.6.1.4.1.3224.21.5.1"
OtherDevice.Discovery.Source(1).SnmpTableSelectColumns="1,2,4"

OtherDevice.Discovery.Source(1).Compute(1).Type="LeftConcat"
OtherDevice.Discovery.Source(1).Compute(1).Column=3
OtherDevice.Discovery.Source(1).Compute(1).String="Serial Number: "

// The InstanceTable
OtherDevice.Discovery.InstanceTable=%OtherDevice.Discovery.Source(1)%
OtherDevice.Discovery.Instance.DeviceID=InstanceTable.Column(1)
OtherDevice.Discovery.Instance.DisplayID=InstanceTable.Column(2)
OtherDevice.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(3)

OtherDevice.Discovery.Instance.AttachedToDeviceID="Chassis"

// Collect

OtherDevice.Collect.Type="MultiInstance"

OtherDevice.Collect.Source(1).Type="SnmpTable"
OtherDevice.Collect.Source(1).SnmpTableOid="1.3.6.1.4.1.3224.21.5.1"
OtherDevice.Collect.Source(1).SnmpTableSelectColumns="1,3,3"

OtherDevice.Collect.Source(1).Compute(1).Type="Translate"
OtherDevice.Collect.Source(1).Compute(1).Column=2
OtherDevice.Collect.Source(1).Compute(1).TranslationTable="StatusTranslationTable"

OtherDevice.Collect.Source(1).Compute(2).Type="Translate"
OtherDevice.Collect.Source(1).Compute(2).Column=3
OtherDevice.Collect.Source(1).Compute(2).TranslationTable="StatusInformationTranslationTable"

OtherDevice.Collect.ValueTable=%OtherDevice.Collect.Source(1)%
OtherDevice.Collect.DeviceID=ValueTable.Column(1)
OtherDevice.Collect.Status=ValueTable.Column(2)
OtherDevice.Collect.StatusInformation=ValueTable.Column(3)


//
// PowerSupply
//

PowerSupply.Discovery.Source(1).Type="SnmpTable"
PowerSupply.Discovery.Source(1).SnmpTableOid="1.3.6.1.4.1.3224.21.1.1"
PowerSupply.Discovery.Source(1).SnmpTableSelectColumns="1,3"

PowerSupply.Discovery.Source(1).Compute(1).Type="LeftConcat"
PowerSupply.Discovery.Source(1).Compute(1).Column=2
PowerSupply.Discovery.Source(1).Compute(1).String="PSU "

// Instance Table
PowerSupply.Discovery.InstanceTable=%PowerSupply.Discovery.Source(1)%
PowerSupply.Discovery.Instance.DeviceID=InstanceTable.Column(1)
PowerSupply.Discovery.Instance.DisplayID=InstanceTable.Column(2)

PowerSupply.Discovery.Instance.AttachedToDeviceID="Chassis"

// Collect

// Collect type = multi-instance
PowerSupply.Collect.Type="MultiInstance"

PowerSupply.Collect.Source(1).Type="SnmpTable"
PowerSupply.Collect.Source(1).SnmpTableOid="1.3.6.1.4.1.3224.21.1.1"
PowerSupply.Collect.Source(1).SnmpTableSelectColumns="1,2,2"

PowerSupply.Collect.Source(1).Compute(1).Type="Translate"
PowerSupply.Collect.Source(1).Compute(1).Column=2
PowerSupply.Collect.Source(1).Compute(1).TranslationTable="StatusTranslationTable"

PowerSupply.Collect.Source(1).Compute(2).Type="Translate"
PowerSupply.Collect.Source(1).Compute(2).Column=3
PowerSupply.Collect.Source(1).Compute(2).TranslationTable="StatusInformationTranslationTable"

// Instance Table
PowerSupply.Collect.ValueTable=%PowerSupply.Collect.Source(1)%
PowerSupply.Collect.DeviceID=ValueTable.Column(1)
PowerSupply.Collect.Status=ValueTable.Column(2)
PowerSupply.Collect.StatusInformation=ValueTable.Column(3)


//
// Fan
//

Fan.Discovery.Source(1).Type="SnmpTable"
Fan.Discovery.Source(1).SnmpTableOid="1.3.6.1.4.1.3224.21.2.1"
Fan.Discovery.Source(1).SnmpTableSelectColumns="1,3"

// Instance Table
Fan.Discovery.InstanceTable=%Fan.Discovery.Source(1)%
Fan.Discovery.Instance.DeviceID=InstanceTable.Column(1)
Fan.Discovery.Instance.DisplayID=InstanceTable.Column(2)

Fan.Discovery.Instance.AttachedToDeviceID="Chassis"

// Collect

// Collect type = multi-instance
Fan.Collect.Type="MultiInstance"

Fan.Collect.Source(1).Type="SnmpTable"
Fan.Collect.Source(1).SnmpTableOid="1.3.6.1.4.1.3224.21.2.1"
Fan.Collect.Source(1).SnmpTableSelectColumns="1,2,2"

Fan.Collect.Source(1).Compute(1).Type="Translate"
Fan.Collect.Source(1).Compute(1).Column=2
Fan.Collect.Source(1).Compute(1).TranslationTable="StatusTranslationTable"

Fan.Collect.Source(1).Compute(2).Type="Translate"
Fan.Collect.Source(1).Compute(2).Column=3
Fan.Collect.Source(1).Compute(2).TranslationTable="StatusInformationTranslationTable"

// Instance Table
Fan.Collect.ValueTable=%Fan.Collect.Source(1)%
Fan.Collect.DeviceID=ValueTable.Column(1)
Fan.Collect.Status=ValueTable.Column(2)
Fan.Collect.StatusInformation=ValueTable.Column(3)


//
// Temperature
//

Temperature.Discovery.Source(1).Type="SnmpTable"
Temperature.Discovery.Source(1).SnmpTableOid="1.3.6.1.4.1.3224.21.4.1"
Temperature.Discovery.Source(1).SnmpTableSelectColumns="1,4"

// Instance Table
Temperature.Discovery.InstanceTable=%Temperature.Discovery.Source(1)%
Temperature.Discovery.Instance.DeviceID=InstanceTable.Column(1)
Temperature.Discovery.Instance.DisplayID=InstanceTable.Column(2)

Temperature.Discovery.Instance.AttachedToDeviceID="Chassis"

// Collect

// Collect type = multi-instance
Temperature.Collect.Type="MultiInstance"

// ID;Status;Description
Temperature.Collect.Source(1).Type="SnmpTable"
Temperature.Collect.Source(1).SnmpTableOid="1.3.6.1.4.1.3224.21.4.1"
Temperature.Collect.Source(1).SnmpTableSelectColumns="1,3"

// Instance Table
Temperature.Collect.ValueTable=%Temperature.Collect.Source(1)%
Temperature.Collect.DeviceID=ValueTable.Column(1)
Temperature.Collect.Temperature=ValueTable.Column(2)


//
// Battery
//

Battery.Discovery.Source(1).Type="SnmpTable"
Battery.Discovery.Source(1).SnmpTableOid="1.3.6.1.4.1.3224.21.3"
Battery.Discovery.Source(1).SnmpTableSelectColumns="ID"

Battery.Discovery.InstanceTable=%Battery.Discovery.Source(1)%
Battery.Discovery.Instance.DeviceID=InstanceTable.Column(1)
Battery.Discovery.Instance.DisplayID="Battery"

Battery.Discovery.Instance.AttachedToDeviceID="Chassis"

// Collect
Battery.Collect.Type="MonoInstance"

Battery.Collect.Source(1).Type="SnmpGet"
Battery.Collect.Source(1).SnmpOid="1.3.6.1.4.1.3224.21.3.%Battery.Collect.DeviceID%"

Battery.Collect.Source(1).Compute(1).Type="DuplicateColumn"
Battery.Collect.Source(1).Compute(1).Column=1

Battery.Collect.Source(1).Compute(2).Type="Translate"
Battery.Collect.Source(1).Compute(2).Column=1
Battery.Collect.Source(1).Compute(2).TranslationTable="StatusTranslationTable"

Battery.Collect.Source(1).Compute(3).Type="Translate"
Battery.Collect.Source(1).Compute(3).Column=2
Battery.Collect.Source(1).Compute(3).TranslationTable="StatusInformationTranslationTable"

Battery.Collect.ValueTable=%Battery.Collect.Source(1)%
Battery.Collect.Status=ValueTable.Column(1)
Battery.Collect.StatusInformation=ValueTable.Column(2)


StatusTranslationTable(0)="ALARM"
StatusTranslationTable(1)="OK"
StatusTranslationTable(2)="ALARM"
StatusTranslationTable(Default)="ALARM"

StatusInformationTranslationTable(0)="Failed"
StatusInformationTranslationTable(1)="Good"
StatusInformationTranslationTable(2)="Error"
StatusInformationTranslationTable(Default)="Unknown Status"
