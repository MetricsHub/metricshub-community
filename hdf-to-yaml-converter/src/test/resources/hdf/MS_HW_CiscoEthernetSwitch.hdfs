////////////////////////////////////////////////////////////////
//
//    H a r d w a r e   D e f i n i t i o n   F i l e
//
//                       f o r
//
//                 Hardware Sentry
//
//                 by Sentry Software (c)
//
//
//      Supports: Cisco Ethernet Switches
//                Connects to Cisco embedddedSNMP agent
//
//


//
// Header
//

hdf.DisplayName="Cisco Ethernet Switch"
hdf.TypicalPlatform="Cisco"
hdf.ReliesOn="Cisco SNMP Agent (ciscoMgmt)"
hdf.Version="1.0"
hdf.Comments="This connector discovers the enclosure Cisco Ethernet switches as well as the various environment sensors (temperatures, fans, power supplies, etc.). It relies on the SNMP protocol."
hdf.RemoteSupport="true"
hdf.AppliesToOS="Network"

hdf.Supersedes="MS_HW_GenericSwitchEnclosure.hdf"

//
// DETECTION
//

// Detection Criteria 1
// Must have A Cisco Enviroment Monitor Present
Detection.Criteria(1).Type="SNMP"
Detection.Criteria(1).SnmpGetNext="1.3.6.1.4.1.9.9.13.1.1"

//
// Enclosure
//

// Source(1) = 	connUnitTable SNMP table
// PhysicalDescription;Class;SerialNumber;
Enclosure.Discovery.Source(1).Type="SnmpTable"
Enclosure.Discovery.Source(1).SnmpTableOid="1.3.6.1.2.1.47.1.1.1.1"
Enclosure.Discovery.Source(1).SnmpTableSelectColumns="2,5,11"

// Keep only units of type 4 (switch)
// PhysicalDescription;Class;SerialNumber;
Enclosure.Discovery.Source(1).Compute(1).Type="KeepOnlyMatchingLines"
Enclosure.Discovery.Source(1).Compute(1).Column=2
Enclosure.Discovery.Source(1).Compute(1).ValueList="3"


// InstanceTable = Source(1)
Enclosure.Discovery.InstanceTable=%Enclosure.Discovery.Source(1)%
Enclosure.Discovery.Instance.DeviceID="CiscoSwitch"
Enclosure.Discovery.Instance.Vendor="Cisco"
Enclosure.Discovery.Instance.Model=InstanceTable.Column(1)
Enclosure.Discovery.Instance.SerialNumber=InstanceTable.Column(3)
Enclosure.Discovery.Instance.Type="Switch"

//
// TEMPERATURES
//

//
// Discovery

// Source(1) = CiscoEnvMonState SNMP Table
// Description;State;
Temperature.Discovery.Source(1).Type="SnmpTable"
Temperature.Discovery.Source(1).SnmpTableOid="1.3.6.1.4.1.9.9.13.1.3.1"
Temperature.Discovery.Source(1).SnmpTableSelectColumns="2,6"

// Keep only temperature sensors
// Description;State;
Temperature.Discovery.Source(1).Compute(1).Type="ExcludeMatchingLines"
Temperature.Discovery.Source(1).Compute(1).Column=2
Temperature.Discovery.Source(1).Compute(1).ValueList="5"

// InstanceTable = Source(1)
Temperature.Discovery.InstanceTable=%Temperature.Discovery.Source(1)%
Temperature.Discovery.Instance.DeviceID=InstanceTable.Column(1)
Temperature.Discovery.Instance.DisplayID=InstanceTable.Column(1)

//
// Collect

// Collect type = multi-instance
Temperature.Collect.Type="MultiInstance"

// Source(1) = CiscoEnvMonState SNMP Table
// Description;Value;State;
Temperature.Collect.Source(1).Type="SnmpTable"
Temperature.Collect.Source(1).SnmpTableOid="1.3.6.1.4.1.9.9.13.1.3.1"
Temperature.Collect.Source(1).SnmpTableSelectColumns="2,3,6"

// Duplicate the State
// Description;Value;State;State;
Temperature.Collect.Source(1).Compute(1).Type="DuplicateColumn"
Temperature.Collect.Source(1).Compute(1).Column=3

// Translate the first state status into a PATROLStatus
// Description;Value;PATROLStatus;State;
Temperature.Collect.Source(1).Compute(2).Type="Translate"
Temperature.Collect.Source(1).Compute(2).Column=3
Temperature.Collect.Source(1).Compute(2).TranslationTable="SensorStatusTranslationTable"



// Translate the second state status into a StatusInformation
// Description;Value;PATROLStatus;StatusInformation;
Temperature.Collect.Source(1).Compute(3).Type="Translate"
Temperature.Collect.Source(1).Compute(3).Column=4
Temperature.Collect.Source(1).Compute(3).TranslationTable="SensorStatusInformationTranslationTable"



// ValueTable = Source(1)
Temperature.Collect.ValueTable=%Temperature.Collect.Source(1)%
Temperature.Collect.DeviceID=ValueTable.Column(1)
Temperature.Collect.Status=ValueTable.Column(3)
Temperature.Collect.StatusInformation=ValueTable.Column(4)
Temperature.Collect.Temperature=ValueTable.Column(2)

// SensorStatusTranslationTable
SensorStatusTranslationTable(1)="OK"
SensorStatusTranslationTable(2)="WARN"
SensorStatusTranslationTable(3)="ALARM"
SensorStatusTranslationTable(4)="ALARM"
SensorStatusTranslationTable(5)="ALARM"
SensorStatusTranslationTable(6)="ALARM"
SensorStatusTranslationTable(Default)="UNKNOWN"

// SensorStatusInformationTranslationTable
SensorStatusInformationTranslationTable(1)=""
SensorStatusInformationTranslationTable(2)="Warning"
SensorStatusInformationTranslationTable(3)="Critical"
SensorStatusInformationTranslationTable(4)="Shutdown"
SensorStatusInformationTranslationTable(5)="No Longer Present"
SensorStatusInformationTranslationTable(6)="Not Functioning"
SensorStatusInformationTranslationTable(Default)="Unknown Status"

//
// VoltageS
//

//
// Discovery

// Source(1) = CiscoEnvMonState SNMP Table
// Description;State;
Voltage.Discovery.Source(1).Type="SnmpTable"
Voltage.Discovery.Source(1).SnmpTableOid="1.3.6.1.4.1.9.9.13.1.2.1"
Voltage.Discovery.Source(1).SnmpTableSelectColumns="2,7"

// Keep only Voltage sensors
// Description;State;
Voltage.Discovery.Source(1).Compute(1).Type="ExcludeMatchingLines"
Voltage.Discovery.Source(1).Compute(1).Column=2
Voltage.Discovery.Source(1).Compute(1).ValueList="5"

// Remove in mV
// Description;State;
Voltage.Discovery.Source(1).Compute(2).Type="Replace"
Voltage.Discovery.Source(1).Compute(2).Column=1
Voltage.Discovery.Source(1).Compute(2).Replace=" in mV"
Voltage.Discovery.Source(1).Compute(2).ReplaceBy=""

// InstanceTable = Source(1)
Voltage.Discovery.InstanceTable=%Voltage.Discovery.Source(1)%
Voltage.Discovery.Instance.DeviceID=InstanceTable.Column(1)
Voltage.Discovery.Instance.DisplayID=InstanceTable.Column(1)

//
// Collect

// Collect type = multi-instance
Voltage.Collect.Type="MultiInstance"

// Source(1) = CiscoEnvMonState SNMP Table
// Description;Value;State;
Voltage.Collect.Source(1).Type="SnmpTable"
Voltage.Collect.Source(1).SnmpTableOid="1.3.6.1.4.1.9.9.13.1.2.1"
Voltage.Collect.Source(1).SnmpTableSelectColumns="2,3,7"

// Duplicate the State
// Description;Value;State;State;
Voltage.Collect.Source(1).Compute(1).Type="DuplicateColumn"
Voltage.Collect.Source(1).Compute(1).Column=3

// Translate the first state status into a PATROLStatus
// Description;Value;PATROLStatus;State;
Voltage.Collect.Source(1).Compute(2).Type="Translate"
Voltage.Collect.Source(1).Compute(2).Column=3
Voltage.Collect.Source(1).Compute(2).TranslationTable="SensorStatusTranslationTable"

// Translate the second state status into a StatusInformation
// Description;Value;PATROLStatus;StatusInformation;
Voltage.Collect.Source(1).Compute(3).Type="Translate"
Voltage.Collect.Source(1).Compute(3).Column=4
Voltage.Collect.Source(1).Compute(3).TranslationTable="SensorStatusInformationTranslationTable"

// Remove in mV
// Description;Value;PATROLStatus;StatusInformation;
Voltage.Collect.Source(1).Compute(4).Type="Replace"
Voltage.Collect.Source(1).Compute(4).Column=1
Voltage.Collect.Source(1).Compute(4).Replace=" in mV"
Voltage.Collect.Source(1).Compute(4).ReplaceBy=""

// ValueTable = Source(1)
Voltage.Collect.ValueTable=%Voltage.Collect.Source(1)%
Voltage.Collect.DeviceID=ValueTable.Column(1)
Voltage.Collect.Status=ValueTable.Column(3)
Voltage.Collect.StatusInformation=ValueTable.Column(4)
Voltage.Collect.Voltage=ValueTable.Column(2)

//
// FanS
//

//
// Discovery

// Source(1) = CiscoEnvMonState SNMP Table
// Description;State;
Fan.Discovery.Source(1).Type="SnmpTable"
Fan.Discovery.Source(1).SnmpTableOid="1.3.6.1.4.1.9.9.13.1.4.1"
Fan.Discovery.Source(1).SnmpTableSelectColumns="2,3"

// Keep only Fan sensors
// Description;State;
Fan.Discovery.Source(1).Compute(1).Type="ExcludeMatchingLines"
Fan.Discovery.Source(1).Compute(1).Column=2
Fan.Discovery.Source(1).Compute(1).ValueList="5"

// InstanceTable = Source(1)
Fan.Discovery.InstanceTable=%Fan.Discovery.Source(1)%
Fan.Discovery.Instance.DeviceID=InstanceTable.Column(1)
Fan.Discovery.Instance.DisplayID=InstanceTable.Column(1)

//
// Collect

// Collect type = multi-instance
Fan.Collect.Type="MultiInstance"

// Source(1) = CiscoEnvMonState SNMP Table
// Description;State;
Fan.Collect.Source(1).Type="SnmpTable"
Fan.Collect.Source(1).SnmpTableOid="1.3.6.1.4.1.9.9.13.1.4.1"
Fan.Collect.Source(1).SnmpTableSelectColumns="2,3"

// Duplicate the State
// Description;State;State;
Fan.Collect.Source(1).Compute(1).Type="DuplicateColumn"
Fan.Collect.Source(1).Compute(1).Column=2

// Translate the first state status into a PATROLStatus
// Description;PATROLStatus;State;
Fan.Collect.Source(1).Compute(2).Type="Translate"
Fan.Collect.Source(1).Compute(2).Column=2
Fan.Collect.Source(1).Compute(2).TranslationTable="SensorStatusTranslationTable"



// Translate the second state status into a StatusInformation
// Description;Value;PATROLStatus;StatusInformation;
Fan.Collect.Source(1).Compute(3).Type="Translate"
Fan.Collect.Source(1).Compute(3).Column=3
Fan.Collect.Source(1).Compute(3).TranslationTable="SensorStatusInformationTranslationTable"

// ValueTable = Source(1)
Fan.Collect.ValueTable=%Fan.Collect.Source(1)%
Fan.Collect.DeviceID=ValueTable.Column(1)
Fan.Collect.Status=ValueTable.Column(2)
Fan.Collect.StatusInformation=ValueTable.Column(3)

// PowerSupplyS
//

//
// Discovery

// Source(1) = CiscoEnvMonState SNMP Table
// Description;State;
PowerSupply.Discovery.Source(1).Type="SnmpTable"
PowerSupply.Discovery.Source(1).SnmpTableOid="1.3.6.1.4.1.9.9.13.1.5.1"
PowerSupply.Discovery.Source(1).SnmpTableSelectColumns="2,3"

// Keep only PowerSupply sensors
// Description;State;
PowerSupply.Discovery.Source(1).Compute(1).Type="ExcludeMatchingLines"
PowerSupply.Discovery.Source(1).Compute(1).Column=2
PowerSupply.Discovery.Source(1).Compute(1).ValueList="5"

// InstanceTable = Source(1)
PowerSupply.Discovery.InstanceTable=%PowerSupply.Discovery.Source(1)%
PowerSupply.Discovery.Instance.DeviceID=InstanceTable.Column(1)
PowerSupply.Discovery.Instance.DisplayID=InstanceTable.Column(1)

//
// Collect

// Collect type = multi-instance
PowerSupply.Collect.Type="MultiInstance"

// Source(1) = CiscoEnvMonState SNMP Table
// Description;State;
PowerSupply.Collect.Source(1).Type="SnmpTable"
PowerSupply.Collect.Source(1).SnmpTableOid="1.3.6.1.4.1.9.9.13.1.5.1"
PowerSupply.Collect.Source(1).SnmpTableSelectColumns="2,3"

// Duplicate the State
// Description;State;State;
PowerSupply.Collect.Source(1).Compute(1).Type="DuplicateColumn"
PowerSupply.Collect.Source(1).Compute(1).Column=2

// Translate the first state status into a PATROLStatus
// Description;PATROLStatus;State;
PowerSupply.Collect.Source(1).Compute(2).Type="Translate"
PowerSupply.Collect.Source(1).Compute(2).Column=2
PowerSupply.Collect.Source(1).Compute(2).TranslationTable="SensorStatusTranslationTable"



// Translate the second state status into a StatusInformation
// Description;Value;PATROLStatus;StatusInformation;
PowerSupply.Collect.Source(1).Compute(3).Type="Translate"
PowerSupply.Collect.Source(1).Compute(3).Column=3
PowerSupply.Collect.Source(1).Compute(3).TranslationTable="SensorStatusInformationTranslationTable"

// ValueTable = Source(1)
PowerSupply.Collect.ValueTable=%PowerSupply.Collect.Source(1)%
PowerSupply.Collect.DeviceID=ValueTable.Column(1)
PowerSupply.Collect.Status=ValueTable.Column(2)
PowerSupply.Collect.StatusInformation=ValueTable.Column(3)

//add network card discovery present in mib2.hdf and not in mib2.hhdf
// PortID;Description;TypeCode;MacAddress;AdminStatus;ID;Name;Alias;
NetworkCard.Discovery.InstanceTable=%NetworkCard.Discovery.Source(3)%
NetworkCard.Discovery.Instance.DeviceID=InstanceTable.Column(1)
NetworkCard.Discovery.Instance.DisplayID=InstanceTable.Column(7)
NetworkCard.Discovery.Instance.PhysicalAddress=InstanceTable.Column(4)
NetworkCard.Discovery.Instance.PhysicalAddressType="MAC"
NetworkCard.Discovery.Instance.DeviceType=InstanceTable.Column(3)
