////////////////////////////////////////////////////////////////
//
//    H a r d w a r e   D e f i n i t i o n   F i l e
//
//                       f o r
//
//                   Hardware Sentry
//
//                 by Sentry Software (c)
//
//
//      Supports: Ethernet Switches via MIB-2 and Entity-Sensor-MIB
//
//      N.B: If your connector uses MIB-2, Supersede this connector!
//


//
// Header
//

hdf.DisplayName="Ethernet Switch with Sensors (SNMP)"
hdf.TypicalPlatform="MIB-2 and Entity-Sensor-MIB Supported Switch"
hdf.ReliesOn="MIB-2, Entity-Sensor-MIB, SNMP"
hdf.Version="1.0"
hdf.Comments="This connector provides an enclosure and sensors for Ethernet switches that provide it."
hdf.RemoteSupport="true"
hdf.AppliesToOS="Network"

hdf.Supersedes="MS_HW_GenericSwitchEnclosure.hdf"

// _ENCLOSURE_TYPE
// Required by MS_HW_EntitySensorMIB
// defines the enclosure type to use
#define _ENCLOSURE_TYPE Switch

// _DEVICE_ID
// Required by MS_HW_EntitySensorMIB
// defines the device id to use for the enclosure
#define _DEVICE_ID EthernetSwitch


#include MS_HW_MIB2.hhdf

#include MS_HW_MIB2EntitySensor.hhdf

// Source(4) = ifTable SNMP Table
// PortID;OperationalStatus
NetworkCard.Discovery.Source(4).Type="SnmpTable"
NetworkCard.Discovery.Source(4).SnmpTableOid="1.3.6.1.2.1.2.2.1"
NetworkCard.Discovery.Source(4).SnmpTableSelectColumns="ID,8"

// Exclude OperationalStatus 6 = Component Not Present
NetworkCard.Discovery.Source(4).Compute(1).Type="ExcludeMatchingLines"
NetworkCard.Discovery.Source(4).Compute(1).Column=2
NetworkCard.Discovery.Source(4).Compute(1).ValueList="6"

// PortID;OperationalStatus;PortID;Description;TypeCode;MacAddress;AdminStatus;ID;Name;Alias;
NetworkCard.Discovery.Source(5).Type="TableJoint"
NetworkCard.Discovery.Source(5).LeftTable=%NetworkCard.Discovery.Source(4)%
NetworkCard.Discovery.Source(5).RightTable=%NetworkCard.Discovery.Source(3)%
NetworkCard.Discovery.Source(5).LeftKeyColumn=1
NetworkCard.Discovery.Source(5).RightKeyColumn=1

// PortID;OperationalStatus;PortID;Description;TypeCode;MacAddress;AdminStatus;ID;Name;Alias;
NetworkCard.Discovery.InstanceTable=%NetworkCard.Discovery.Source(5)%
NetworkCard.Discovery.Instance.DeviceID=InstanceTable.Column(1)
NetworkCard.Discovery.Instance.DisplayID=InstanceTable.Column(9)
NetworkCard.Discovery.Instance.PhysicalAddress=InstanceTable.Column(6)
NetworkCard.Discovery.Instance.PhysicalAddressType="MAC"
NetworkCard.Discovery.Instance.DeviceType=InstanceTable.Column(5)

NetworkCard.Discovery.Instance.AttachedToDeviceID=_DEVICE_ID
