- name: testFull
  input: |
    // InstanceTable = Source(18)
    Temperature.Discovery.InstanceTable=%Temperature.Discovery.Source(18)%
    Temperature.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(1)
    Temperature.Discovery.Instance.AdditionalInformation2=InstanceTable.Column(2)
    Temperature.Discovery.Instance.AdditionalInformation3=InstanceTable.Column(3)
    Temperature.Discovery.Instance.AlarmThreshold=InstanceTable.Column(4)
    Temperature.Discovery.Instance.AttachedToDeviceID=InstanceTable.Column(5)
    Temperature.Discovery.Instance.AttachedToDeviceType=InstanceTable.Column(7)
    Temperature.Discovery.Instance.DeviceID=InstanceTable.Column(8)
    Temperature.Discovery.Instance.DisplayID=InstanceTable.Column(9)
    Temperature.Discovery.Instance.TemperatureType=InstanceTable.Column(11)
    Temperature.Discovery.Instance.WarningThreshold=InstanceTable.Column(12)
  expected:
    monitors:
      temperature:
        discovery:
          mapping:
            _comment: InstanceTable = Source(18)
            source: ${source::monitors.temperature.discovery.sources.source(18)}
            attributes:
              info: ${awk::join(" ", $1, $2, $3)}
              hw.parent.id: $5
              hw.parent.type: $7
              id: $8
              __display_id: $9
              sensor_location: $11
              name: ${awk::sprintf("%s (%s)", $9, $11)}
            metrics:
              hw.temperature.limit{limit_type="high.degraded"}: $12
              hw.temperature.limit{limit_type="high.critical"}: $4
- name: testNoTemperatureType
  input: |
    // InstanceTable = Source(18)
    Temperature.Discovery.InstanceTable=%Temperature.Discovery.Source(18)%
    Temperature.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(1)
    Temperature.Discovery.Instance.AdditionalInformation2=InstanceTable.Column(2)
    Temperature.Discovery.Instance.AdditionalInformation3=InstanceTable.Column(3)
    Temperature.Discovery.Instance.AlarmThreshold=InstanceTable.Column(4)
    Temperature.Discovery.Instance.AttachedToDeviceID=InstanceTable.Column(5)
    Temperature.Discovery.Instance.AttachedToDeviceType=InstanceTable.Column(7)
    Temperature.Discovery.Instance.DeviceID=InstanceTable.Column(8)
    Temperature.Discovery.Instance.DisplayID=InstanceTable.Column(9)
    Temperature.Discovery.Instance.WarningThreshold=InstanceTable.Column(12)
  expected:
    monitors:
      temperature:
        discovery:
          mapping:
            _comment: InstanceTable = Source(18)
            source: ${source::monitors.temperature.discovery.sources.source(18)}
            attributes:
              info: ${awk::join(" ", $1, $2, $3)}
              hw.parent.id: $5
              hw.parent.type: $7
              id: $8
              __display_id: $9
              name: "$9"
            metrics:
              hw.temperature.limit{limit_type="high.degraded"}: $12
              hw.temperature.limit{limit_type="high.critical"}: $4
- name: testDefaultId
  input: |
    // InstanceTable = Source(18)
    Temperature.Discovery.InstanceTable=%Temperature.Discovery.Source(18)%
    Temperature.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(1)
    Temperature.Discovery.Instance.AdditionalInformation2=InstanceTable.Column(2)
    Temperature.Discovery.Instance.AdditionalInformation3=InstanceTable.Column(3)
    Temperature.Discovery.Instance.AlarmThreshold=InstanceTable.Column(4)
    Temperature.Discovery.Instance.AttachedToDeviceID=InstanceTable.Column(5)
    Temperature.Discovery.Instance.AttachedToDeviceType=InstanceTable.Column(7)
    Temperature.Discovery.Instance.DeviceID=InstanceTable.Column(8)
    Temperature.Discovery.Instance.WarningThreshold=InstanceTable.Column(12)
  expected:
    monitors:
      temperature:
        discovery:
          mapping:
            _comment: InstanceTable = Source(18)
            source: ${source::monitors.temperature.discovery.sources.source(18)}
            attributes:
              info: ${awk::join(" ", $1, $2, $3)}
              hw.parent.id: $5
              hw.parent.type: $7
              id: $8
              name: "$8"
            metrics:
              hw.temperature.limit{limit_type="high.degraded"}: $12
              hw.temperature.limit{limit_type="high.critical"}: $4