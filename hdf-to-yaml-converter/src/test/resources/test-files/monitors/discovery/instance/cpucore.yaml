- name: test1
  input: |
    // Instance table = source(3)
    // CoreID;PhysicalProcessorID;AdditionalInformation;CoreID;CurrentSpeed;
    CpuCore.Discovery.InstanceTable=%CpuCore.Discovery.Source(3)%
    CpuCore.Discovery.Instance.DeviceID=InstanceTable.Column(1)
    CpuCore.Discovery.Instance.AttachedToDeviceID=InstanceTable.Column(2)
    CpuCore.Discovery.Instance.AttachedToDeviceType="Cpu"
    CpuCore.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(3)
    CpuCore.Discovery.Instance.ParameterActivation.CurrentSpeed=ValueTable.Column(5)
  expected:
    monitors:
      cpucore:
        discovery:
          mapping:
            _comment: |-
              Instance table = source(3)
              CoreID;PhysicalProcessorID;AdditionalInformation;CoreID;CurrentSpeed;
            source: $monitors.cpucore.discovery.sources.source(4)$
            attributes:
              deviceid: InstanceTable.Column(1)
              attachedtodeviceid: InstanceTable.Column(2)
              attachedtodevicetype: CPU
              additionalinformation1: InstanceTable.Column(3)