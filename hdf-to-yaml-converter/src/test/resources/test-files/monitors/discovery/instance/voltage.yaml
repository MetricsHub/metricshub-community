- name: testFull
  input: |
    // InstanceTable = Source(1)
    Voltage.Discovery.InstanceTable=%Voltage.Discovery.Source(1)%
    Voltage.Discovery.Instance.DeviceID=InstanceTable.Column(3)
    Voltage.Discovery.Instance.DisplayID=InstanceTable.Column(3)
    Voltage.Discovery.Instance.VoltageType=InstanceTable.Column(10)
    Voltage.Discovery.Instance.LowerThreshold=InstanceTable.Column(5)
    Voltage.Discovery.Instance.UpperThreshold=InstanceTable.Column(6)
    Voltage.Discovery.Instance.AttachedToDeviceID="MBM"
    Voltage.Discovery.Instance.AttachedToDeviceType="Computer"
    Voltage.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(7)
    Voltage.Discovery.Instance.AdditionalInformation2=InstanceTable.Column(8)
    Voltage.Discovery.Instance.AdditionalInformation3=InstanceTable.Column(9)
  expected:
    monitors:
      voltage:
        discovery:
          mapping:
            _comment: InstanceTable = Source(1)
            source: ${source::monitors.voltage.discovery.sources.source(1)}
            attributes:
              id: $3
              __display_id: $3
              sensor_location: $10
              hw.parent.id: MBM
              hw.parent.type: enclosure
              info: ${awk::join(" ", $7, $8, $9)}
              name: ${awk::sprintf("%s (%s)", $3, $10)}
            metrics:
              hw.voltage.limit{limit_type="low.critical"}: $5
              hw.voltage.limit{limit_type="high.degraded"}: $6
- name: testDefault
  input: |
    // InstanceTable = Source(1)
    Voltage.Discovery.InstanceTable=%Voltage.Discovery.Source(1)%
    Voltage.Discovery.Instance.DeviceID=InstanceTable.Column(3)
    Voltage.Discovery.Instance.DisplayID=InstanceTable.Column(3)
    Voltage.Discovery.Instance.LowerThreshold=InstanceTable.Column(5)
    Voltage.Discovery.Instance.UpperThreshold=InstanceTable.Column(6)
    Voltage.Discovery.Instance.AttachedToDeviceID="MBM"
    Voltage.Discovery.Instance.AttachedToDeviceType="Computer"
    Voltage.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(7)
    Voltage.Discovery.Instance.AdditionalInformation2=InstanceTable.Column(8)
    Voltage.Discovery.Instance.AdditionalInformation3=InstanceTable.Column(9)
  expected:
    monitors:
      voltage:
        discovery:
          mapping:
            _comment: InstanceTable = Source(1)
            source: ${source::monitors.voltage.discovery.sources.source(1)}
            attributes:
              id: $3
              __display_id: $3
              hw.parent.id: MBM
              hw.parent.type: enclosure
              info: ${awk::join(" ", $7, $8, $9)}
              name: $3
            metrics:
              hw.voltage.limit{limit_type="low.critical"}: $5
              hw.voltage.limit{limit_type="high.degraded"}: $6