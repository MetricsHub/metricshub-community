- name: testFull
  input: |
    // The Instance Table
    // ID,LOCATION,CPUNumber,RiserNumber,ModuleNumber,Size,Type,Vendor,Model,Serial,Frequency,Status
    Memory.Discovery.InstanceTable=%Memory.Discovery.Source(1)%
    Memory.Discovery.Instance.DeviceID=InstanceTable.column(1)
    Memory.Discovery.Instance.DisplayID="1.1"
    Memory.Discovery.Instance.Type="DDR4"
    Memory.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(2)
    Memory.Discovery.Instance.Vendor="Vendor"
    Memory.Discovery.Instance.Size="16384"
    Memory.Discovery.Instance.Model="Model"
    Memory.Discovery.Instance.SerialNumber=InstanceTable.Column(10)
    Memory.Discovery.Instance.AdditionalInformation2=InstanceTable.Column(11)
    Memory.Discovery.Instance.AdditionalInformation3=InstanceTable.Column(13)
    Memory.Discovery.Instance.AttachedToDeviceID="DIR5"
    Memory.Discovery.Instance.AttachedToDeviceType="Enclosure"
    Memory.Discovery.Instance.ErrorCountWarningThreshold=InstanceTable.Column(14)
    Memory.Discovery.Instance.ErrorCountAlarmThreshold=InstanceTable.Column(15)
  expected:
    monitors:
      memory:
        discovery:
          mapping:
            _comment: |-
              The Instance Table
              ID,LOCATION,CPUNumber,RiserNumber,ModuleNumber,Size,Type,Vendor,Model,Serial,Frequency,Status
            source: $monitors.memory.discovery.sources.source(1)$
            attributes:
              id: $column(1)
              __display_id: "1.1"
              type: "DDR4"
              vendor: "Vendor"
              model: "Model"
              serial_number: $column(10)
              info: join(" ", $column(2), $column(11), $column(13))
              hw.parent.id: DIR5
              hw.parent.type: enclosure
              name: sprintf("%s (%s - %s - %s MB)", "1.1", "Vendor", "DDR4", "16384")
            metrics:
              hw.memory.limit: mebiByte2Byte("16384")
- name: testNoDisplayId
  input: |
    // The Instance Table
    // ID,LOCATION,CPUNumber,RiserNumber,ModuleNumber,Size,Type,Vendor,Model,Serial,Frequency,Status
    Memory.Discovery.InstanceTable=%Memory.Discovery.Source(1)%
    Memory.Discovery.Instance.DeviceID="1.1"
    Memory.Discovery.Instance.Type="DDR4"
    Memory.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(2)
    Memory.Discovery.Instance.Vendor="Vendor"
    Memory.Discovery.Instance.Size="16384"
    Memory.Discovery.Instance.Model="Model"
    Memory.Discovery.Instance.SerialNumber=InstanceTable.Column(10)
    Memory.Discovery.Instance.AdditionalInformation2=InstanceTable.Column(11)
    Memory.Discovery.Instance.AdditionalInformation3=InstanceTable.Column(13)
    Memory.Discovery.Instance.AttachedToDeviceID="DIR5"
    Memory.Discovery.Instance.AttachedToDeviceType="Enclosure"
    Memory.Discovery.Instance.ErrorCountWarningThreshold=InstanceTable.Column(14)
    Memory.Discovery.Instance.ErrorCountAlarmThreshold=InstanceTable.Column(15)
  expected:
    monitors:
      memory:
        discovery:
          mapping:
            _comment: |-
              The Instance Table
              ID,LOCATION,CPUNumber,RiserNumber,ModuleNumber,Size,Type,Vendor,Model,Serial,Frequency,Status
            source: $monitors.memory.discovery.sources.source(1)$
            attributes:
              id: "1.1"
              type: "DDR4"
              vendor: "Vendor"
              model: "Model"
              serial_number: $column(10)
              info: join(" ", $column(2), $column(11), $column(13))
              hw.parent.id: DIR5
              hw.parent.type: enclosure
              name: sprintf("%s (%s - %s - %s MB)", "1.1", "Vendor", "DDR4", "16384")
            metrics:
              hw.memory.limit: mebiByte2Byte("16384")

- name: testNoVendor
  input: |
    // The Instance Table
    // ID,LOCATION,CPUNumber,RiserNumber,ModuleNumber,Size,Type,Vendor,Model,Serial,Frequency,Status
    Memory.Discovery.InstanceTable=%Memory.Discovery.Source(1)%
    Memory.Discovery.Instance.DeviceID=InstanceTable.column(1)
    Memory.Discovery.Instance.DisplayID="1.1"
    Memory.Discovery.Instance.Type="DDR4"
    Memory.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(2)
    Memory.Discovery.Instance.Size="16384"
    Memory.Discovery.Instance.Model="Model"
    Memory.Discovery.Instance.SerialNumber=InstanceTable.Column(10)
    Memory.Discovery.Instance.AdditionalInformation2=InstanceTable.Column(11)
    Memory.Discovery.Instance.AdditionalInformation3=InstanceTable.Column(13)
    Memory.Discovery.Instance.AttachedToDeviceID="DIR5"
    Memory.Discovery.Instance.AttachedToDeviceType="Enclosure"
    Memory.Discovery.Instance.ErrorCountWarningThreshold=InstanceTable.Column(14)
    Memory.Discovery.Instance.ErrorCountAlarmThreshold=InstanceTable.Column(15)
  expected:
    monitors:
      memory:
        discovery:
          mapping:
            _comment: |-
              The Instance Table
              ID,LOCATION,CPUNumber,RiserNumber,ModuleNumber,Size,Type,Vendor,Model,Serial,Frequency,Status
            source: $monitors.memory.discovery.sources.source(1)$
            attributes:
              id: $column(1)
              __display_id: "1.1"
              type: "DDR4"
              model: "Model"
              serial_number: $column(10)
              info: join(" ", $column(2), $column(11), $column(13))
              hw.parent.id: DIR5
              hw.parent.type: enclosure
              name: sprintf("%s (%s - %s MB)", "1.1", "DDR4", "16384")
            metrics:
              hw.memory.limit: mebiByte2Byte("16384")

- name: testNoModel
  input: |
    // The Instance Table
    // ID,LOCATION,CPUNumber,RiserNumber,ModuleNumber,Size,Type,Vendor,Model,Serial,Frequency,Status
    Memory.Discovery.InstanceTable=%Memory.Discovery.Source(1)%
    Memory.Discovery.Instance.DeviceID=InstanceTable.column(1)
    Memory.Discovery.Instance.DisplayID="1.1"
    Memory.Discovery.Instance.Type="DDR4"
    Memory.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(2)
    Memory.Discovery.Instance.Vendor="Vendor"
    Memory.Discovery.Instance.Size="16384"
    Memory.Discovery.Instance.SerialNumber=InstanceTable.Column(10)
    Memory.Discovery.Instance.AdditionalInformation2=InstanceTable.Column(11)
    Memory.Discovery.Instance.AdditionalInformation3=InstanceTable.Column(13)
    Memory.Discovery.Instance.AttachedToDeviceID="DIR5"
    Memory.Discovery.Instance.AttachedToDeviceType="Enclosure"
    Memory.Discovery.Instance.ErrorCountWarningThreshold=InstanceTable.Column(14)
    Memory.Discovery.Instance.ErrorCountAlarmThreshold=InstanceTable.Column(15)
  expected:
    monitors:
      memory:
        discovery:
          mapping:
            _comment: |-
              The Instance Table
              ID,LOCATION,CPUNumber,RiserNumber,ModuleNumber,Size,Type,Vendor,Model,Serial,Frequency,Status
            source: $monitors.memory.discovery.sources.source(1)$
            attributes:
              id: $column(1)
              __display_id: "1.1"
              type: "DDR4"
              vendor: "Vendor"
              serial_number: $column(10)
              info: join(" ", $column(2), $column(11), $column(13))
              hw.parent.id: DIR5
              hw.parent.type: enclosure
              name: sprintf("%s (%s - %s - %s MB)", "1.1", "Vendor", "DDR4", "16384")
            metrics:
              hw.memory.limit: mebiByte2Byte("16384")

- name: testTypeOnly
  input: |
    // The Instance Table
    // ID,LOCATION,CPUNumber,RiserNumber,ModuleNumber,Size,Type,Vendor,Model,Serial,Frequency,Status
    Memory.Discovery.InstanceTable=%Memory.Discovery.Source(1)%
    Memory.Discovery.Instance.DeviceID=InstanceTable.column(1)
    Memory.Discovery.Instance.DisplayID="1.1"
    Memory.Discovery.Instance.Type="DDR4"
    Memory.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(2)
    Memory.Discovery.Instance.SerialNumber=InstanceTable.Column(10)
    Memory.Discovery.Instance.AdditionalInformation2=InstanceTable.Column(11)
    Memory.Discovery.Instance.AdditionalInformation3=InstanceTable.Column(13)
    Memory.Discovery.Instance.AttachedToDeviceID="DIR5"
    Memory.Discovery.Instance.AttachedToDeviceType="Enclosure"
    Memory.Discovery.Instance.ErrorCountWarningThreshold=InstanceTable.Column(14)
    Memory.Discovery.Instance.ErrorCountAlarmThreshold=InstanceTable.Column(15)
  expected:
    monitors:
      memory:
        discovery:
          mapping:
            _comment: |-
              The Instance Table
              ID,LOCATION,CPUNumber,RiserNumber,ModuleNumber,Size,Type,Vendor,Model,Serial,Frequency,Status
            source: $monitors.memory.discovery.sources.source(1)$
            attributes:
              id: $column(1)
              __display_id: "1.1"
              type: "DDR4"
              serial_number: $column(10)
              info: join(" ", $column(2), $column(11), $column(13))
              hw.parent.id: DIR5
              hw.parent.type: enclosure
              name: sprintf("%s (%s)", "1.1", "DDR4")

- name: testSizeOnly
  input: |
    // The Instance Table
    // ID,LOCATION,CPUNumber,RiserNumber,ModuleNumber,Size,Type,Vendor,Model,Serial,Frequency,Status
    Memory.Discovery.InstanceTable=%Memory.Discovery.Source(1)%
    Memory.Discovery.Instance.DeviceID=InstanceTable.column(1)
    Memory.Discovery.Instance.DisplayID="1.1"
    Memory.Discovery.Instance.Size="16384"
    Memory.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(2)
    Memory.Discovery.Instance.SerialNumber=InstanceTable.Column(10)
    Memory.Discovery.Instance.AdditionalInformation2=InstanceTable.Column(11)
    Memory.Discovery.Instance.AdditionalInformation3=InstanceTable.Column(13)
    Memory.Discovery.Instance.AttachedToDeviceID="DIR5"
    Memory.Discovery.Instance.AttachedToDeviceType="Enclosure"
    Memory.Discovery.Instance.ErrorCountWarningThreshold=InstanceTable.Column(14)
    Memory.Discovery.Instance.ErrorCountAlarmThreshold=InstanceTable.Column(15)
  expected:
    monitors:
      memory:
        discovery:
          mapping:
            _comment: |-
              The Instance Table
              ID,LOCATION,CPUNumber,RiserNumber,ModuleNumber,Size,Type,Vendor,Model,Serial,Frequency,Status
            source: $monitors.memory.discovery.sources.source(1)$
            attributes:
              id: $column(1)
              __display_id: "1.1"
              serial_number: $column(10)
              info: join(" ", $column(2), $column(11), $column(13))
              hw.parent.id: DIR5
              hw.parent.type: enclosure
              name: sprintf("%s (%s MB)", "1.1", "16384")
            metrics:
              hw.memory.limit: mebiByte2Byte("16384")

- name: testIdOnly
  input: |
    // The Instance Table
    // ID,LOCATION,CPUNumber,RiserNumber,ModuleNumber,Size,Type,Vendor,Model,Serial,Frequency,Status
    Memory.Discovery.InstanceTable=%Memory.Discovery.Source(1)%
    Memory.Discovery.Instance.DeviceID=InstanceTable.column(1)
    Memory.Discovery.Instance.DisplayID="1.1"
    Memory.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(2)
    Memory.Discovery.Instance.SerialNumber=InstanceTable.Column(10)
    Memory.Discovery.Instance.AdditionalInformation2=InstanceTable.Column(11)
    Memory.Discovery.Instance.AdditionalInformation3=InstanceTable.Column(13)
    Memory.Discovery.Instance.AttachedToDeviceID="DIR5"
    Memory.Discovery.Instance.AttachedToDeviceType="Enclosure"
    Memory.Discovery.Instance.ErrorCountWarningThreshold=InstanceTable.Column(14)
    Memory.Discovery.Instance.ErrorCountAlarmThreshold=InstanceTable.Column(15)
  expected:
    monitors:
      memory:
        discovery:
          mapping:
            _comment: |-
              The Instance Table
              ID,LOCATION,CPUNumber,RiserNumber,ModuleNumber,Size,Type,Vendor,Model,Serial,Frequency,Status
            source: $monitors.memory.discovery.sources.source(1)$
            attributes:
              id: $column(1)
              __display_id: "1.1"
              serial_number: $column(10)
              info: join(" ", $column(2), $column(11), $column(13))
              hw.parent.id: DIR5
              hw.parent.type: enclosure
              name: "1.1"

