- name: test1
  input: |
    // The Instance Table
    // ID,LOCATION,CPUNumber,RiserNumber,ModuleNumber,Size,Type,Vendor,Model,Serial,Frequency,Status
    Memory.Discovery.InstanceTable=%Memory.Discovery.Source(1)%
    Memory.Discovery.Instance.DeviceID=InstanceTable.Column(1)
    Memory.Discovery.Instance.DisplayID="deviceID"
    Memory.Discovery.Instance.Type=InstanceTable.Column(7)
    Memory.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(2)
    Memory.Discovery.Instance.Vendor=InstanceTable.Column(8)
    Memory.Discovery.Instance.Size=InstanceTable.Column(6)
    Memory.Discovery.Instance.Model=InstanceTable.Column(9)
    Memory.Discovery.Instance.SerialNumber=InstanceTable.Column(10)
    Memory.Discovery.Instance.AdditionalInformation2=InstanceTable.Column(11)
    Memory.Discovery.Instance.AdditionalInformation3=InstanceTable.Column(13)
    Memory.Discovery.Instance.AttachedToDeviceID="DIR5"
    Memory.Discovery.Instance.AttachedToDeviceType="Enclosure"
    Memory.Discovery.Instance.ErrorCountWarningThreshold=InstanceTable.Column(14)
    Memory.Discovery.Instance.ErrorCountAlarmThreshold=InstanceTable.Column(15)
  expected:
    monitors:
      memory:
        discovery:
          mapping:
            _comment: |-
              The Instance Table
              ID,LOCATION,CPUNumber,RiserNumber,ModuleNumber,Size,Type,Vendor,Model,Serial,Frequency,Status
            source: $monitors.memory.discovery.sources.source(1)$
            attributes:
              deviceid: $column(1)
              displayid: deviceID
              type: $column(7)
              additionalinformation1: $column(2)
              vendor: $column(8)
              size: $column(6)
              model: $column(9)
              serialnumber: $column(10)
              additionalinformation2: $column(11)
              additionalinformation3: $column(13)
              attachedtodeviceid: DIR5
              attachedtodevicetype: Enclosure
              errorcountwarningthreshold: $column(14)
              errorcountalarmthreshold: $column(15)