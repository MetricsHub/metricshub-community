- name: test1
  input: |
    // PhysicalDisk Instance Table
    PhysicalDisk.Discovery.InstanceTable=%PhysicalDisk.Discovery.Source(3)%
    PhysicalDisk.Discovery.Instance.DeviceID=InstanceTable.Column(2)
    PhysicalDisk.Discovery.Instance.DisplayID=InstanceTable.Column(4)
    PhysicalDisk.Discovery.Instance.FirmwareVersion=InstanceTable.Column(5)
    PhysicalDisk.Discovery.Instance.Model=InstanceTable.Column(6)
    PhysicalDisk.Discovery.Instance.Vendor="Toshiba"
    PhysicalDisk.Discovery.Instance.SerialNumber=InstanceTable.Column(8)
    PhysicalDisk.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(9)
    PhysicalDisk.Discovery.Instance.AdditionalInformation2="Blabla"
    PhysicalDisk.Discovery.Instance.AdditionalInformation3="OtherBlabla"
    PhysicalDisk.Discovery.Instance.Size=InstanceTable.column(11)
    PhysicalDisk.Discovery.Instance.AttachedToDeviceID=InstanceTable.Column(3)
    PhysicalDisk.Discovery.Instance.AttachedToDeviceType=InstanceTable.Column(10)
    PhysicalDisk.Discovery.Instance.ControllerNumber=InstanceTable.Column(12)
  expected:
    monitors:
      physical_disk:
        discovery:
          mapping:
            _comment: PhysicalDisk Instance Table
            source: $monitors.physical_disk.discovery.sources.source(3)$
            attributes:
              id: $column(2)
              __display_id: $column(4)
              firmware_version: $column(5)
              model: $column(6)
              vendor: Toshiba
              serial_number: $column(8)
              info: join($column(9), "Blabla", "OtherBlabla", " ")
              hw.parent.id: lookup("disk_controller", "id", "controller_number", $column(12))
              hw.parent.type: disk_controller
              name: sprintf("%s (%s - %s)", $column(4), $column(6), $column(11))
            metrics:
              hw.physical_disk.size: $column(11)
