- name: test1
  input: |
    // InstanceTable = Source(3)
    NetworkCard.Discovery.InstanceTable=%NetworkCard.Discovery.Source(3)%
    NetworkCard.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(1)
    NetworkCard.Discovery.Instance.AdditionalInformation2=InstanceTable.Column(2)
    NetworkCard.Discovery.Instance.AdditionalInformation3=InstanceTable.Column(3)
    NetworkCard.Discovery.Instance.AttachedToDeviceID=InstanceTable.Column(4)
    NetworkCard.Discovery.Instance.AttachedToDeviceType=InstanceTable.Column(5)
    NetworkCard.Discovery.Instance.DeviceID=InstanceTable.Column(6)
    NetworkCard.Discovery.Instance.DisplayID=InstanceTable.Column(6)
    NetworkCard.Discovery.Instance.DeviceType=InstanceTable.Column(7)
    NetworkCard.Discovery.Instance.LogicalAddressType=InstanceTable.Column(8)
    NetworkCard.Discovery.Instance.Model=InstanceTable.Column(9)
    NetworkCard.Discovery.Instance.PhysicalAddress=InstanceTable.Column(10)
    NetworkCard.Discovery.Instance.PhysicalAddressType="MAC"
    NetworkCard.Discovery.Instance.SerialNumber=InstanceTable.Column(11)
    NetworkCard.Discovery.Instance.Vendor=InstanceTable.Column(12)
  expected:
    monitors:
      network:
        discovery:
          mapping:
            _comment: InstanceTable = Source(3)
            source: ${source::monitors.network.discovery.sources.source(3)}
            attributes:
              id: $6
              __display_id: $6
              device_type: $7
              logical_address_type: $8
              model: $9
              physical_address: $10
              physical_address_type: MAC
              serial_number: $11
              info: ${awk::join(" ", $1, $2, $3)}
              hw.parent.type: $5
              hw.parent.id: $4
              vendor: $12
              name: ${awk::sprintf("%s (%s - %s - %s)", $6, $7, $12, $9)}
- name: testNoVendor
  input: |
    // InstanceTable = Source(3)
    NetworkCard.Discovery.InstanceTable=%NetworkCard.Discovery.Source(3)%
    NetworkCard.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(1)
    NetworkCard.Discovery.Instance.AdditionalInformation2=InstanceTable.Column(2)
    NetworkCard.Discovery.Instance.AdditionalInformation3=InstanceTable.Column(3)
    NetworkCard.Discovery.Instance.AttachedToDeviceID=InstanceTable.Column(4)
    NetworkCard.Discovery.Instance.AttachedToDeviceType=InstanceTable.Column(5)
    NetworkCard.Discovery.Instance.DeviceID=InstanceTable.Column(6)
    NetworkCard.Discovery.Instance.DisplayID=InstanceTable.Column(6)
    NetworkCard.Discovery.Instance.DeviceType=InstanceTable.Column(7)
    NetworkCard.Discovery.Instance.LogicalAddressType=InstanceTable.Column(8)
    NetworkCard.Discovery.Instance.Model=InstanceTable.Column(9)
    NetworkCard.Discovery.Instance.PhysicalAddress=InstanceTable.Column(10)
    NetworkCard.Discovery.Instance.PhysicalAddressType="MAC"
    NetworkCard.Discovery.Instance.SerialNumber=InstanceTable.Column(11)
  expected:
    monitors:
      network:
        discovery:
          mapping:
            _comment: InstanceTable = Source(3)
            source: ${source::monitors.network.discovery.sources.source(3)}
            attributes:
              id: $6
              __display_id: $6
              device_type: $7
              logical_address_type: $8
              model: $9
              physical_address: $10
              physical_address_type: MAC
              serial_number: $11
              info: ${awk::join(" ", $1, $2, $3)}
              hw.parent.type: $5
              hw.parent.id: $4
              name: ${awk::sprintf("%s (%s - %s)", $6, $7, $9)}
- name: testNoVendorNoModel
  input: |
    // InstanceTable = Source(3)
    NetworkCard.Discovery.InstanceTable=%NetworkCard.Discovery.Source(3)%
    NetworkCard.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(1)
    NetworkCard.Discovery.Instance.AdditionalInformation2=InstanceTable.Column(2)
    NetworkCard.Discovery.Instance.AdditionalInformation3=InstanceTable.Column(3)
    NetworkCard.Discovery.Instance.AttachedToDeviceID=InstanceTable.Column(4)
    NetworkCard.Discovery.Instance.AttachedToDeviceType=InstanceTable.Column(5)
    NetworkCard.Discovery.Instance.DeviceID=InstanceTable.Column(6)
    NetworkCard.Discovery.Instance.DisplayID=InstanceTable.Column(6)
    NetworkCard.Discovery.Instance.DeviceType=InstanceTable.Column(7)
    NetworkCard.Discovery.Instance.LogicalAddressType=InstanceTable.Column(8)
    NetworkCard.Discovery.Instance.PhysicalAddress=InstanceTable.Column(10)
    NetworkCard.Discovery.Instance.PhysicalAddressType="MAC"
    NetworkCard.Discovery.Instance.SerialNumber=InstanceTable.Column(11)
  expected:
    monitors:
      network:
        discovery:
          mapping:
            _comment: InstanceTable = Source(3)
            source: ${source::monitors.network.discovery.sources.source(3)}
            attributes:
              id: $6
              __display_id: $6
              device_type: $7
              logical_address_type: $8
              physical_address: $10
              physical_address_type: MAC
              serial_number: $11
              info: ${awk::join(" ", $1, $2, $3)}
              hw.parent.type: $5
              hw.parent.id: $4
              name: ${awk::sprintf("%s (%s)", $6, $7)}
- name: testNoVendorNoModelNoDeviceType
  input: |
    // InstanceTable = Source(3)
    NetworkCard.Discovery.InstanceTable=%NetworkCard.Discovery.Source(3)%
    NetworkCard.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(1)
    NetworkCard.Discovery.Instance.AdditionalInformation2=InstanceTable.Column(2)
    NetworkCard.Discovery.Instance.AdditionalInformation3=InstanceTable.Column(3)
    NetworkCard.Discovery.Instance.AttachedToDeviceID=InstanceTable.Column(4)
    NetworkCard.Discovery.Instance.AttachedToDeviceType=InstanceTable.Column(5)
    NetworkCard.Discovery.Instance.DeviceID=InstanceTable.Column(6)
    NetworkCard.Discovery.Instance.DisplayID=InstanceTable.Column(6)
    NetworkCard.Discovery.Instance.LogicalAddressType=InstanceTable.Column(8)
    NetworkCard.Discovery.Instance.PhysicalAddress=InstanceTable.Column(10)
    NetworkCard.Discovery.Instance.PhysicalAddressType="MAC"
    NetworkCard.Discovery.Instance.SerialNumber=InstanceTable.Column(11)
  expected:
    monitors:
      network:
        discovery:
          mapping:
            _comment: InstanceTable = Source(3)
            source: ${source::monitors.network.discovery.sources.source(3)}
            attributes:
              id: $6
              __display_id: $6
              logical_address_type: $8
              physical_address: $10
              physical_address_type: MAC
              serial_number: $11
              info: ${awk::join(" ", $1, $2, $3)}
              hw.parent.type: $5
              hw.parent.id: $4
              name: $6