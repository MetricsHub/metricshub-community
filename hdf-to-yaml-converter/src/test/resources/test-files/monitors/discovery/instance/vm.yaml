- name: testFull
  input: |
    VM.Discovery.InstanceTable=%VM.Discovery.Source(1)%
    VM.Discovery.Instance.DeviceID=InstanceTable.Column(1)
    VM.Discovery.Instance.DisplayID=InstanceTable.Column(1)
    VM.Discovery.Instance.Hostname=InstanceTable.Column(1)
    VM.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(2)
  expected:
    monitors:
      vm:
        discovery:
          mapping:
            source: $monitors.vm.discovery.sources.source(1)$
            attributes:
              id: $column(1)
              __display_id: $column(1)
              name: $column(1)
              info: $column(2)
              hw.parent.type: enclosure
- name: testDefaultName
  input: |
    VM.Discovery.InstanceTable=%VM.Discovery.Source(1)%
    VM.Discovery.Instance.DeviceID=InstanceTable.Column(1)
    VM.Discovery.Instance.Hostname=InstanceTable.Column(1)
    VM.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(2)
  expected:
    monitors:
      vm:
        discovery:
          mapping:
            source: $monitors.vm.discovery.sources.source(1)$
            attributes:
              id: $column(1)
              name: $column(1)
              info: $column(2)
              hw.parent.type: enclosure