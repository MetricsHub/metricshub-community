- name: testFull
  input: |
    VM.Discovery.InstanceTable=%VM.Discovery.Source(1)%
    VM.Discovery.Instance.DeviceID=InstanceTable.Column(1)
    VM.Discovery.Instance.DisplayID=InstanceTable.Column(2)
    VM.Discovery.Instance.Hostname=InstanceTable.Column(3)
    VM.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(4)
  expected:
    monitors:
      vm:
        discovery:
          mapping:
            source: ${source::monitors.vm.discovery.sources.source(1)}
            attributes:
              id: $1
              __display_id: $2
              name: ${awk::sprintf("%s (%s)", $2, $3)}
              info: $4
              hw.parent.type: enclosure
              vm.host.name: $3
- name: testDefaultName
  input: |
    VM.Discovery.InstanceTable=%VM.Discovery.Source(1)%
    VM.Discovery.Instance.DeviceID=InstanceTable.Column(1)
    VM.Discovery.Instance.Hostname=InstanceTable.Column(2)
    VM.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(3)
  expected:
    monitors:
      vm:
        discovery:
          mapping:
            source: ${source::monitors.vm.discovery.sources.source(1)}
            attributes:
              id: $1
              name: ${awk::sprintf("%s (%s)", $1, $2)}
              info: $3
              hw.parent.type: enclosure
              vm.host.name: $2
- name: testNoHostname
  input: |
    VM.Discovery.InstanceTable=%VM.Discovery.Source(1)%
    VM.Discovery.Instance.DeviceID=InstanceTable.Column(1)
    VM.Discovery.Instance.DisplayID=InstanceTable.Column(2)
    VM.Discovery.Instance.AdditionalInformation1=InstanceTable.Column(3)
  expected:
    monitors:
      vm:
        discovery:
          mapping:
            source: ${source::monitors.vm.discovery.sources.source(1)}
            attributes:
              id: $1
              __display_id: $2
              name: $2
              info: $3
              hw.parent.type: enclosure