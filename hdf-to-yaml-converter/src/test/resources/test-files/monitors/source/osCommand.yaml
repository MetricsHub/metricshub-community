---
- name: discovery
  input: |
    // First OsCommand Discovery Comment
    Enclosure.Discovery.Source(1).Type="OsCommand"
    Enclosure.Discovery.Source(1).CommandLine="command1"
    Enclosure.Discovery.Source(1).Timeout="90"
    Enclosure.Discovery.Source(1).ExecuteLocally=1
    Enclosure.Discovery.Source(1).ExcludeRegExp="exclude1"
    Enclosure.Discovery.Source(1).KeepOnlyRegExp="keep1"
    Enclosure.Discovery.Source(1).RemoveHeader="1"
    Enclosure.Discovery.Source(1).RemoveFooter="1"
    Enclosure.Discovery.Source(1).Separators="separator1"
    Enclosure.Discovery.Source(1).SelectColumns="1"
    Enclosure.Discovery.Source(1).ForceSerialization="1"
    
    // Second OsCommand Discovery Comment
    Enclosure.Discovery.Source(2).Type="OsCommand"
    Enclosure.Discovery.Source(2).CommandLine="command2"
    Enclosure.Discovery.Source(2).Timeout="90"
    Enclosure.Discovery.Source(2).ExecuteLocally=1
    Enclosure.Discovery.Source(2).ExcludeRegExp="exclude2"
    Enclosure.Discovery.Source(2).KeepOnlyRegExp="keep2"
    Enclosure.Discovery.Source(2).RemoveHeader="2"
    Enclosure.Discovery.Source(2).RemoveFooter="2"
    Enclosure.Discovery.Source(2).Separators="separator2"
    Enclosure.Discovery.Source(2).SelectColumns="2"
    Enclosure.Discovery.Source(2).ForceSerialization="1"
  expected:
    monitors:
      enclosure:
        discovery:
          sources:
            source(1):
              _comment: First OsCommand Discovery Comment
              type: osCommand
              commandLine: command1
              timeout: 90
              executeLocally: true
              exclude: exclude1
              keep: keep1
              beginAtLineNumber: 1
              endAtLineNumber: 1
              separators: separator1
              selectColumns: "1"
              forceSerialization: true
            source(2):
              _comment: Second OsCommand Discovery Comment
              type: osCommand
              commandLine: command2
              timeout: 90
              executeLocally: true
              exclude: exclude2
              keep: keep2
              beginAtLineNumber: 2
              endAtLineNumber: 2
              separators: separator2
              selectColumns: "2"
              forceSerialization: true

- name: collect
  input: |
    // First OsCommand Collect Comment
    Enclosure.Collect.Source(1).Type="OsCommand"
    Enclosure.Collect.Source(1).CommandLine="command1"
    Enclosure.Collect.Source(1).Timeout="90"
    Enclosure.Collect.Source(1).ExecuteLocally=1
    Enclosure.Collect.Source(1).ExcludeRegExp="exclude1"
    Enclosure.Collect.Source(1).KeepOnlyRegExp="keep1"
    Enclosure.Collect.Source(1).RemoveHeader="1"
    Enclosure.Collect.Source(1).RemoveFooter="1"
    Enclosure.Collect.Source(1).Separators="separator1"
    Enclosure.Collect.Source(1).SelectColumns="1"
    Enclosure.Collect.Source(1).ForceSerialization="1"
    
    // Second OsCommand Collect Comment
    Enclosure.Collect.Source(2).Type="OsCommand"
    Enclosure.Collect.Source(2).CommandLine="command2"
    Enclosure.Collect.Source(2).Timeout="90"
    Enclosure.Collect.Source(2).ExecuteLocally=1
    Enclosure.Collect.Source(2).ExcludeRegExp="exclude2"
    Enclosure.Collect.Source(2).KeepOnlyRegExp="keep2"
    Enclosure.Collect.Source(2).RemoveHeader="2"
    Enclosure.Collect.Source(2).RemoveFooter="2"
    Enclosure.Collect.Source(2).Separators="separator2"
    Enclosure.Collect.Source(2).SelectColumns="2"
    Enclosure.Collect.Source(2).ForceSerialization="1"
  expected:
    monitors:
      enclosure:
        collect:
          sources:
            source(1):
              _comment: First OsCommand Collect Comment
              type: osCommand
              commandLine: command1
              timeout: 90
              executeLocally: true
              exclude: exclude1
              keep: keep1
              beginAtLineNumber: 1
              endAtLineNumber: 1
              separators: separator1
              selectColumns: "1"
              forceSerialization: true
            source(2):
              _comment: Second OsCommand Collect Comment
              type: osCommand
              commandLine: command2
              timeout: 90
              executeLocally: true
              exclude: exclude2
              keep: keep2
              beginAtLineNumber: 2
              endAtLineNumber: 2
              separators: separator2
              selectColumns: "2"
              forceSerialization: true