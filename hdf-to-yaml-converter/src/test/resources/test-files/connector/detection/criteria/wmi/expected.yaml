- name: getAvailableTest
  input: >
    // WMI criterion comment
    Detection.Criteria(1).Type="WMI"
    Detection.Criteria(1).WbemQuery="query"
    Detection.Criteria(1).WbemNamespace="namespace"
    Detection.Criteria(1).ExpectedResult="result"
    Detection.Criteria(1).ErrorMessage="error"
  expected:
    connector:
      detection:
        criteria:
        - _comment: "WMI criterion comment"
          type: wmi
          query: query
          namespace: namespace
          expectedResult: result
          errorMessage: error

- name: testMany
  input: >
    // First WMI criterion comment
    Detection.Criteria(1).Type="WMI"
    Detection.Criteria(1).WbemQuery="query1"
    Detection.Criteria(1).WbemNamespace="namespace1"
    Detection.Criteria(1).ExpectedResult="result1"
    Detection.Criteria(1).ErrorMessage="error1"

    // Second WMI criterion comment
    Detection.Criteria(2).Type="WMI"
    Detection.Criteria(2).WbemQuery="query2"
    Detection.Criteria(2).WbemNamespace="namespace2"
    Detection.Criteria(2).ExpectedResult="result2"
    Detection.Criteria(2).ErrorMessage="error2"
  expected:
    connector:
      detection:
        criteria:
        - _comment: "First WMI criterion comment"
          type: wmi
          query: query1
          namespace: namespace1
          expectedResult: result1
          errorMessage: error1
        - _comment: "Second WMI criterion comment"
          type: wmi
          query: query2
          namespace: namespace2
          expectedResult: result2
          errorMessage: error2