- name: service
  input: |
    Detection.Criteria(1).Type="Service"
    Detection.Criteria(1).ServiceName="TWGIPC"
  expected:
    connector:
      detection:
        criteria:
        - type: service
          name: TWGIPC

- name: testEscapePipe
  input: |
    Detection.Criteria(1).Type="Service"
    Detection.Criteria(1).ServiceName="TWGIPC"

    Detection.Criteria(2).Type="Service"
    Detection.Criteria(2).ServiceName="TWGIPC\|IBMTivoliCommonAgent"
  expected:
    connector:
      detection:
        criteria:
        - type: service
          name: TWGIPC
        - type: service
          name: TWGIPC\|IBMTivoliCommonAgent

- name: testPipe
  input: |
    Detection.Criteria(2).Type="Service"
    Detection.Criteria(2).ServiceName="TWGIPC|IBMTivoliCommonAgent"
  expected:
    connector:
      detection:
        criteria:
        - type: service
          name: TWGIPC|IBMTivoliCommonAgent