- name: service
  input: |
    Detection.Criteria(1).Type="Service"
    Detection.Criteria(1).ServiceName="TWGIPC"
  expected:
    connector:
      detection:
        criteria:
        - type: service
          serviceName: TWGIPC
          _comment: ""

- name: testEscapePipe
  input: |
    Detection.Criteria(1).Type="Service"
    Detection.Criteria(1).ServiceName="TWGIPC"

    Detection.Criteria(2).Type="Service"
    Detection.Criteria(2).ServiceName="TWGIPC\|IBMTivoliCommonAgent"
  expected:
    connector:
      detection:
        criteria:
        - type: service
          serviceName: TWGIPC
          _comment: ""
        - type: service
          serviceName: TWGIPC\|IBMTivoliCommonAgent
          _comment: ""

- name: testPipe
  input: |
    Detection.Criteria(2).Type="Service"
    Detection.Criteria(2).ServiceName="TWGIPC|IBMTivoliCommonAgent"
  expected:
    connector:
      detection:
        criteria:
        - type: service
          serviceName: TWGIPC|IBMTivoliCommonAgent
          _comment: ""