- name: process
  input: >
    // The WBEM layer (cimserver) must be running
    Detection.Criteria(2).Type="Process"
    Detection.Criteria(2).ProcessCommandLine="cimserver"
  expected:
    connector:
      detection:
        criteria:
        - type: process
          _comment: The WBEM layer (cimserver) must be running
          commandLine: cimserver

- name: test2
  input: >
    // DETECTION

    Detection.Criteria(1).Type="OS"
    Detection.Criteria(1).KeepOnly="NT"

    Detection.Criteria(2).Type="Process"
    Detection.Criteria(2).ProcessCommandLine="MBM[5-9]\.exe"
  expected:
    connector:
      detection:
        criteria:
        - type: DeviceType
          keep: [ NT ]
          _comment: // DETECTION
        - type: process
          commandLine: MBM[5-9]\.exe