- name: service
  input: >
    Detection.Criteria(1).Type="OS"
    Detection.Criteria(1).KeepOnly="NT"

    Detection.Criteria(2).Type="Service"
    Detection.Criteria(2).ServiceName="TWGIPC"
  expected:
    connector:
      detection:
        criteria:
        - type: deviceType
          keep: [ NT ]
        - type: service
          serviceName: TWGIPC

- name: testEscapePipe
  input: >
    Detection.Criteria(1).Type="OS"
    Detection.Criteria(1).KeepOnly="NT"

    Detection.Criteria(2).Type="Service"
    Detection.Criteria(2).ServiceName="TWGIPC\|IBMTivoliCommonAgent"
  expected:
    connector:
      detection:
        criteria:
        - type: deviceType
          keep: [ NT ]
        - type: service
          serviceName: TWGIPC\|IBMTivoliCommonAgent

- name: testPipe
  input: >
    Detection.Criteria(1).Type="OS"
    Detection.Criteria(1).KeepOnly="NT"

    Detection.Criteria(2).Type="Service"
    Detection.Criteria(2).ServiceName="TWGIPC|IBMTivoliCommonAgent"
  expected:
    connector:
      detection:
        criteria:
        - type: deviceType
          keep: [ NT ]
        - type: service
          serviceName: TWGIPC|IBMTivoliCommonAgent
