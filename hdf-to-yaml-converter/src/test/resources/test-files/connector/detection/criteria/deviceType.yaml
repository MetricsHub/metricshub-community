---
- name: exclude
  input: |
    Detection.Criteria(1).Type="OS"
    Detection.Criteria(1).Exclude="NT"
  expected:
    connector:
      detection:
        criteria:
        - type: deviceType
          exclude: NT
          _comment: ""

- name: excludeKeep
  input: |
    Detection.Criteria(1).Type="OS"
    Detection.Criteria(1).Exclude="NT"
    Detection.Criteria(1).KeepOnly="Linux"
  expected:
    connector:
      detection:
        criteria:
        - type: deviceType
          exclude: NT
          keep: Linux
          _comment: ""

- name: keep
  input: |
    Detection.Criteria(1).Type="OS"
    Detection.Criteria(1).KeepOnly="OOB"
  expected:
    connector:
      detection:
        criteria:
        - type: deviceType
          _comment: ""
          keep: OOB 

- name: keepMultiple
  input: |
    Detection.Criteria(1).Type="OS"
    Detection.Criteria(1).KeepOnly="Solaris,SunOS,Linux"
  expected:
    connector:
      detection:
        criteria:
        - type: deviceType
          keep: Solaris,SunOS,Linux
          _comment: ""

- name: multipleCriteria
  input: |
    Detection.Criteria(1).Type="OS"
    Detection.Criteria(1).KeepOnly="OOB"

    Detection.Criteria(2).Type="OS"
    Detection.Criteria(2).Exclude="Linux"
  expected:
    connector:
      detection:
        criteria:
        - type: deviceType
          keep: OOB
          _comment: ""
        - type: deviceType
          exclude: Linux
          _comment: ""