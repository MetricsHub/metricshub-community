- name: getAvailableTest
  input: >
    // SshInteractive criterion comment
    Detection.Criteria(1).Type="TelnetInteractive"
    Detection.Criteria(1).Port=123
    Detection.Criteria(1).ExpectedResult="result"
    Detection.Criteria(1).Step(1).Type="GetAvailable"
    Detection.Criteria(1).Step(1).Capture="False"
  expected:
    connector:
      detection:
        criteria:
        - _comment: "SshInteractive criterion comment"
          type: sshInteractive
          port: 123
          expectedResult: result
          step:
          - type: getAvailable
            capture: false

- name: getUntilPromptTest
  input: >
    // SshInteractive criterion comment
    Detection.Criteria(1).Type="TelnetInteractive"
    Detection.Criteria(1).Port=123
    Detection.Criteria(1).ExpectedResult="result"
    Detection.Criteria(1).Step(1).Type="GetUntilPrompt"
    Detection.Criteria(1).Step(1).Capture="False"
    Detection.Criteria(1).Step(1).Timeout=60
  expected:
    connector:
      detection:
        criteria:
        - _comment: "SshInteractive criterion comment"
          type: sshInteractive
          port: 123
          expectedResult: result
          step:
          - type: getUntilPrompt
            capture: false
            timeout: 60

- name: getSendPasswordTest
  input: >
    // SshInteractive criterion comment
    Detection.Criteria(1).Type="TelnetInteractive"
    Detection.Criteria(1).Port=123
    Detection.Criteria(1).ExpectedResult="result"
    Detection.Criteria(1).Step(1).Type="SendPassword"
    Detection.Criteria(1).Step(1).Capture="False"
  expected:
    connector:
      detection:
        criteria:
        - _comment: "SshInteractive criterion comment"
          type: sshInteractive
          port: 123
          expectedResult: result
          step:
          - type: sendPassword
            capture: false

- name: getSendTextTest
  input: >
    // SshInteractive criterion comment
    Detection.Criteria(1).Type="TelnetInteractive"
    Detection.Criteria(1).Port=123
    Detection.Criteria(1).ExpectedResult="result"
    Detection.Criteria(1).Step(1).Type="SendText"
    Detection.Criteria(1).Step(1).Text="text"
    Detection.Criteria(1).Step(1).Capture="False"
  expected:
    connector:
      detection:
        criteria:
        - _comment: "SshInteractive criterion comment"
          type: sshInteractive
          port: 123
          expectedResult: result
          step:
          - type: sendText
            text: text
            capture: false

- name: getSendUsernameTest
  input: >
    // SshInteractive criterion comment
    Detection.Criteria(1).Type="TelnetInteractive"
    Detection.Criteria(1).Port=123
    Detection.Criteria(1).ExpectedResult="result"
    Detection.Criteria(1).Step(1).Type="SendUsername"
    Detection.Criteria(1).Step(1).Capture="False"
  expected:
    connector:
      detection:
        criteria:
        - _comment: "SshInteractive criterion comment"
          type: sshInteractive
          port: 123
          expectedResult: result
          step:
          - type: sendUsername
            capture: false

- name: sleepTest
  input: >
    // SshInteractive criterion comment
    Detection.Criteria(1).Type="TelnetInteractive"
    Detection.Criteria(1).Port=123
    Detection.Criteria(1).ExpectedResult="result"
    Detection.Criteria(1).Step(1).Type="Sleep"
    Detection.Criteria(1).Step(1).Capture="False"
    Detection.Criteria(1).Step(1).Duration=60
  expected:
  	connector:
      detection:
        criteria:
        - _comment: "SshInteractive criterion comment"
          type: sshInteractive
          port: 123
          expectedResult: result
          step:
          - type: sleep
            capture: false
            duration: 60

- name: waitForTest
  input: >
    // SshInteractive criterion comment
    Detection.Criteria(1).Type="TelnetInteractive"
    Detection.Criteria(1).Port=123
    Detection.Criteria(1).ExpectedResult="result"
    Detection.Criteria(1).Step(1).Type="WaitFor"
    Detection.Criteria(1).Step(1).Capture="False"
    Detection.Criteria(1).Step(1).Text="text"
    Detection.Criteria(1).Step(1).Duration=60
  expected:
    connector:
      detection:
        criteria:
        - _comment: "SshInteractive criterion comment"
          type: sshInteractive
          port: 123
          expectedResult: result
          step:
          - type: waitFor
            capture: false
            text: text
            duration: 60

- name: waitForPromptTest
  input: >
    // SshInteractive criterion comment
    Detection.Criteria(1).Type="TelnetInteractive"
    Detection.Criteria(1).Port=123
    Detection.Criteria(1).ExpectedResult="result"
    Detection.Criteria(1).Step(1).Type="WaitForPrompt"
    Detection.Criteria(1).Step(1).Capture="False"
    Detection.Criteria(1).Step(1).Duration=60
  expected:
    connector:
      detection:
        criteria:
        - _comment: "SshInteractive criterion comment"
          type: sshInteractive
          port: 123
          expectedResult: result
          step:
          - type: waitForPrompt
            capture: false
            duration: 60

- name: testMany
  input: >
    // First SshInteractive criterion comment
    Detection.Criteria(1).Type="TelnetInteractive"
    Detection.Criteria(1).Port=1231
    Detection.Criteria(1).ExpectedResult="result1"
    Detection.Criteria(1).Step(1).Type="SendUsername"
    Detection.Criteria(1).Step(1).Capture="False"
    Detection.Criteria(1).Step(2).Type="SendPassword"
    Detection.Criteria(1).Step(2).Capture="False"

    // Second SshInteractive criterion comment
    Detection.Criteria(2).Type="TelnetInteractive"
    Detection.Criteria(2).Port=1232
    Detection.Criteria(2).ExpectedResult="result2"
    Detection.Criteria(2).Step(1).Type="GetAvailable"
    Detection.Criteria(2).Step(1).Capture="False"
  expected:
    connector:
      detection:
        criteria:
        - _comment: "First SshInteractive criterion comment"
          type: sshInteractive
          port: 1231
          expectedResult: result1
          step:
          - type: sendUsername
            capture: false
          - type: sendPassword
            capture: false
        - _comment: "Second SshInteractive criterion comment"
          type: sshInteractive
          port: 1232
          expectedResult: result2
          step:
          - type: GetAvailable
            capture: false