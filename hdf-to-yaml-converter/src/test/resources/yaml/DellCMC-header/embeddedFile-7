($1 ~ /Server-[0-9]+/ && $2 == "Present") {
    ServerID = $1 ; gsub (/Server-/,"",ServerID);
    if ($4 ~ "^[Nn]/[Aa]$" ) { status[ServerID] = "UNKNOWN"; statusInformation[ServerID] = "Unknown Status"; }
    else if ($4 ~ /^[Oo][Kk]$/) { status[ServerID] = "OK"; statusInformation[ServerID] = ""; }
    else if ($4 ~ /^[Nn]ot$/ || $5 ~ /^[Oo][Kk]$/) { status[ServerID] = "ALARM"; statusInformation[ServerID] = "Not OK"; }
    else { status[ServerID] = "UNKNOWN"; statusInformation[ServerID] = "Unknown Status"; } ;
  deviceType[ServerID] = $1 ; gsub (/-[0-9]+/,"",deviceType[ServerID]) ;
  powerstate[ServerID] = tolower($3);
  }

($1 ~ /^[0-9]+$/ && $5 ~ /^W$/) && $6 ~ /^[0-9]+$/ {
    ServerID = $1
    BladeModel[ServerID] = $7
    if ($NF != $7) {BladeModel[ServerID] = BladeModel[ServerID] " " $NF}
  }
($1 ~ /^[0-9]+$/ && $4 ~ /^W$/) && $5 ~ /^[0-9]+$/ {
    ServerID = $1
    BladeModel[ServerID] = $6
    if ($NF != $6) {BladeModel[ServerID] = BladeModel[ServerID] " " $NF}
  }
END {for (ServerID in status) {
           print"MSHW;" ServerID ";" status[ServerID] ";" statusInformation[ServerID] ";" powerstate[ServerID] ";" BladeModel[ServerID] ";"
           }
      }