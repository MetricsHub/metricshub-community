---
extends:
- "IBMHMC-header"
constants:
  _EVENTFIELDS: "sys_name,status,text,refcode,event_time,fru_details"
connector:
  displayName: "IBM Hardware Management Console (HMC) Version 8 or later"
  platforms: "IBM POWER"
  reliesOn: "IBM Hardware Management Console (HMC)"
  information: "Reports hardware errors that occured during the day and provides the status of the System Attention LED of all IBM AIX servers connected to the Hardware Management Console. An ALARM alert is triggered for a hardware problem that happened during the day and is automatically cleared at midnight."
  version: "1.0"
  detection:
    connectionTypes:
    - "remote"
    appliesTo:
    - "Linux"
    criteria:
      # check the version of the HMC
      # We want 8 or 9, but also allow 10,11,12
    - type: "osCommand"
      commandLine: "lshmc -V"
      expectedResult: "version.*Version.*[01289]"
monitors:
  enclosure:
    collect:
      sources:
        source(1):
          type: "osCommand"
          commandLine: "lssvcevents -t hardware -d 0 -F _EVENTFIELDS"
          keep: ",Open,"
          separators: ","
          selectColumns: "1,2,3,4,5,6"
          computes:
            # Add Fru information for v8 systems
            # v8 //  SystemName;Status;Description;RefCode;EventTime;FRUDetails;
          - type: "rightConcat"
            column: 3
            value: " - FRU Details: "
          - type: "rightConcat"
            column: 3
            value: "Column(6)"
