BEGIN {SECTION="";NNCSECTION=""}

$1 ~ /MS_HW_SYSTEM_START/  { systemName = $2 }

SECTION != "" && $1 !~ /^[0-9]+/ && tolower($0) !~ /status/ && NF < 3 && NNCSECTION == "" { SECTION = "" }

$1 ~ /^Controller$/ { SECTION = "CTL" }
SECTION == "CTL" && $1 ~ /^[0-9]+/ && NNCSECTION == "" { ID = SECTION "-" $1
                                     Status = $NF
                                     print "MSHW_OtherDevice;" systemName ";" systemName "." ID ";" ID ";" Status ";" Status ";"
                                   }

$1 ~ /^Cache$/ { SECTION = "Cache" }
SECTION == "Cache" && $1 ~ /^[0-9]+/ && $2 ~ /^[0-9]+/ && NNCSECTION == "" { ID = SECTION "-CTL" $1 "-Slot" $2
                                     Status = $NF
                                     if ($3 !~ /---/) {print "MSHW_Memory;" systemName ";" systemName "." ID ";" ID ";" Status ";" Status ";" }
                                   }

$1 ~ /^I.F$/ && $2 ~ /Module/ { SECTION = "IF-Module" }
$1 ~ /^Interface$/ && $2 ~ /Board/ { SECTION = "IF-Module" }
SECTION == "IF-Module" && $1 ~ /^[0-9]/ && $2 ~ /^[0-9]/ && NNCSECTION == "" { ID = SECTION "-CTL" $1 "-IF" $2
                                     Status = $NF
                                     print "MSHW_NetworkCard;" systemName ";" systemName "." ID ";" ID ";" Status ";" Status ";"
                                   }

$1 ~ /^Battery$/ && $2 != /^Backup$/ { SECTION = "Battery" }
SECTION == "Battery" && $1 ~ /^[0-9]/ && NNCSECTION == "" { ID = SECTION "-" $1
                                     Status = $NF
                                     print "MSHW_Battery;" systemName ";" systemName "." ID ";" ID ";" Status ";" Status ";"
                                   }

$1 ~ /^Battery$/ && $2 ~ /^Backup$/{ SECTION = "Battery-Backup" }
SECTION == "Battery-Backup" && $1 ~ /^[0-9]/ && NNCSECTION == "" { ID = SECTION "-" $1
                                     Status = $NF
                                     print "MSHW_Battery;" systemName ";" systemName "." ID ";" ID ";" Status ";" Status ";"
                                   }


$1 ~ /^Additional$/ && $2 ~ /^Battery$/ { SECTION = "Additional-Battery" }
SECTION == "Additional-Battery" && $1 ~ /^[0-9]/ && NNCSECTION == "" { ID = SECTION "-" $1
                                     Status = $NF
                                     print "MSHW_Battery;" systemName ";" systemName "." ID ";" ID ";" Status ";" Status ";"
                                   }

$1 ~ /^Host$/ && $2 ~ /^Connector$/ { SECTION = "Host-Connector" }
SECTION == "Host-Connector" && $1 ~ /^[0-9]/ && NNCSECTION == "" { ID = SECTION "-" $1
                                     Status = $NF
                                     print "MSHW_NetworkCard;" systemName ";" systemName "." ID ";" ID ";" Status ";" Status ";"
                                   }

$1 ~ /^Fan$/ { SECTION = "Fan" }
SECTION == "Fan" && $1 ~ /^[0-9C]/ && $2 ~ /^[0-9]/ && NNCSECTION == "" { ID = SECTION "-Unit" $1 "-Fan" $2
                                     Status = $NF
                                     print "MSHW_Fan;" systemName ";" systemName "." ID ";" ID ";" Status ";" Status ";"
                                   }
$1 ~ /^AC$/ { SECTION = "AC" }
SECTION == "AC" && $1 ~ /^[0-9C]/ && $2 ~ /^[0-9]/ && NNCSECTION == "" { ID = SECTION "-Unit" $1 "-AC" $2
                                     Status = $NF
                                     print "MSHW_PowerSupply;" systemName ";" systemName "." ID ";" ID ";" Status ";" Status ";"
                                   }

$1 ~ /^DC$/ { SECTION = "DC" }
SECTION == "AC" && $1 ~ /^[0-9C]/ && $2 ~ /^[0-9]/ && NNCSECTION == "" { ID = SECTION "-Unit" $1 "-DC" $2
                                     Status = $NF
                                     print "MSHW_PowerSupply;" systemName ";" systemName "." ID ";" ID ";" Status ";" Status ";"
                                   }

$1 ~ /^ENC$/ { SECTION = "ENC" }
SECTION == "ENC" && $1 ~ /^[0-9C]/ && $2 ~ /^[0-9]/ && NNCSECTION == "" { ID = SECTION "-Unit" $1 "-ENCCable" $2
                                     Status = $NF
                                     print "MSHW_OtherDevice;" systemName ";" systemName "." ID ";" ID ";" Status ";" Status ";"
                                   }

$1 ~ /^Loop$/ { SECTION = "Loop" }
SECTION == "Loop" && $1 ~ /^[0-9]/ && $2 ~ /^[0-9]/ && NNCSECTION == "" { ID = SECTION "-Path" $1 "-Loop" $2
                                     Status = $NF
                                     print "MSHW_OtherDevice;" systemName ";" systemName "." ID ";" ID ";" Status ";" Status ";"
                                   }

$1 ~ /^Air$/ && $2 ~ /^Filter$/ && NNCSECTION == "" { SECTION = "Air-Filter"
                                  ID = SECTION ; getline; getline ;
                                  Status = $NF
                                  print "MSHW_OtherDevice;" systemName ";" systemName "." ID ";" ID ";" Status ";" Status ";"
                                }

$1 ~ /^NNC$/ && NF == 1 { SECTION = "NNC" }
SECTION == "NNC" && $1 ~ /^[0-9]/ && NNCSECTION == "" { ID = SECTION "-" $1
                                     Status = $NF
                                     print "MSHW_OtherDevice;" systemName ";" systemName "." ID ";" ID ";" Status ";" Status ";"
                                   }

# NNC SUB-COMPONENTS
$1 ~ /^NNC[0-9]+$/ && $2 ~ /^Status$/ { NNCSECTION = $1 }

$1 ~ /^DIMM+$/ && NNCSECTION != "" { SECTION = NNCSECTION "-DIMM"}
SECTION ~ /NNC[0-9]+-DIMM/ && $1 ~ /^[A-Z][0-9]/ { ID = SECTION "-" $1
                                     Status = $NF
                                     print "MSHW_Memory;" systemName ";" systemName "." ID ";" ID ";" Status ";" Status ";"
                                   }

$1 ~ /^PS$/ && NNCSECTION != "" { SECTION = NNCSECTION "-PS"
                                    if ( $2 != "" ) { ID = NNCSECTION "-PS"
                                                        status = $NF
                                                        print "MSHW_PowerSupply;" systemName ";" systemName "." ID ";" ID ";" Status ";" Status ";"
                                                       }
                                  }
SECTION ~ /NNC[0-9]+-PS/ && $1 ~ /^[0-9]/ { ID = NNCSECTION "-PS" $1
                                     Status = $NF
                                     print "MSHW_PowerSupply;" systemName ";" systemName "." ID ";" ID ";" Status ";" Status ";"
                                   }

$1 ~ /^Fan$/ && NNCSECTION != "" { SECTION = NNCSECTION "-Fan"
                                    if ( $2 != "" ) { ID = NNCSECTION "-Fan"
                                                        status = $NF
                                                        print "MSHW_Fan;" systemName ";" systemName "." ID ";" ID ";" Status ";" Status ";"
                                                       }
                                  }
SECTION ~ /NNC[0-9]+-Fan/ && $1 ~ /^[0-9]/ { ID = NNCSECTION "-Fan" $1
                                     Status = $NF
                                     print "MSHW_Fan;" systemName ";" systemName "." ID ";" ID ";" Status ";" Status ";"
                                   }

$1 ~ /^Extension$/ && $2 ~ /^Slot$/ && NNCSECTION != "" { SECTION = NNCSECTION "-ExtSlot"}
SECTION ~ /NNC[0-9]+-ExtSlot/ && $1 ~ /^[0-9]/ { ID = SECTION "-" $1
                                     Status = $NF
                                     print "MSHW_OtherDevice;" systemName ";" systemName "." ID ";" ID ";" Status ";" Status ";"
                                   }

$1 ~ /^Extension$/ && $2 ~ /^Card$/ && NNCSECTION != "" { SECTION = "NNC-ExtCard"}
SECTION ~ /NNC-ExtCard/ && $1 ~ /^[0-9]/ && $2 ~ /^[0-9]/ { ID = "NNC" $1 "-ExtCard-" $2 ;
                                     Status = $NF
                                     print "MSHW_OtherDevice;" systemName ";" systemName "." ID ";" ID ";" Status ";" Status ";"
                                   }