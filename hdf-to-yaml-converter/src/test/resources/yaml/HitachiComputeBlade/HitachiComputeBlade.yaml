---
connector:
  displayName: Hitachi Compute Blade Chassis
  platforms: Hitachi Compute Blade
  reliesOn: Hitachi Compute Blade Chassis Management Module
  version: 1.0
  information: This connector provides hardware monitoring for the Hitachi Compute Blade series chassis through the Hitachi Compute Blades Management Module
  detection:
    connectionTypes:
    - remote
    - local
    appliesTo:
    - OOB
    criteria:
    # Criteria 1: Must have a chassisConfigSystem entry
    - type: snmpGetNext
      oid: 1.3.6.1.4.1.116.5.52.1.1.1
monitors:
  enclosure:
    discovery:
      sources:
        source(1):
          # Enclosure (Chassis) chassisConfigSystem Table
          # Name;ModelNumber;SerialNumber;ChassisID;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.1.1
          selectColumns: "2,3,4,5"
          computes:
            # Add a key to do table joint
            # MSHW;Name;ModelNumber;SerialNumber;ChassisID;
          - type: leftConcat
            column: 1
            value: MSHW;
        source(2):
          # Get the Firmware Versions
          # FirmwareVersion;EquipmentVersion;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.1.5
          selectColumns: "1,2"
          computes:
            # Add a key to do table joint
            # MSHW;FirmwareVersion;EquipmentVersion;
          - type: leftConcat
            column: 1
            value: MSHW;
            # Add text to identify second firmware version
            # MSHW;FirmwareVersion;EquipmentVersion;
          - type: leftConcat
            column: 3
            value: "Equipment Parameter Version: "
        source(3):
          # Join the tables
          # MSHW;Name;ModelNumber;SerialNumber;ChassisID;MSHW;FirmwareVersion;EquipmentVersion;
          type: tableJoin
          leftTable: "${source::monitors.enclosure.discovery.sources.source(1)}"
          rightTable: "${source::monitors.enclosure.discovery.sources.source(2)}"
          leftKeyColumn: 1
          rightKeyColumn: 1
          defaultRightLine: ;;;
      mapping:
        # The InstanceTable
        #   1    2       3        #  4        #  5       6        # 7        #   8
        # MSHW;Name;ModelNumber;SerialNumber;ChassisID;MSHW;FirmwareVersion;EquipmentVersion;
        source: "${source::monitors.enclosure.discovery.sources.source(3)}"
        attributes:
          id: $5
          vendor: $2
          model: $3
          type: Blade Chassis
          serial_number: $4
          bios_version: $7
          info: $8
          name: "${awk::sprintf(\"Enclosure: (%s %s)\", $2, $3)}"
    collect:
      type: multiInstance
      keys:
      - id
      sources:
        source(1):
          # Get the various enclosures (Chassis)
          # PowerConsumptionKW
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.1.4.9.0
          computes:
            # Add a key to do table joint
            # MSHW;PowerConsumptionKW;
          - type: leftConcat
            column: 1
            value: MSHW;
        source(2):
          # Join with the discovery table to get the ID
          # MSHW;Name;ModelNumber;SerialNumber;ChassisID;MSHW;PowerConsumptionKW;
          type: tableJoin
          leftTable: "${source::monitors.enclosure.discovery.sources.source(1)}"
          rightTable: "${source::monitors.enclosure.collect.sources.source(1)}"
          leftKeyColumn: 1
          rightKeyColumn: 1
          defaultRightLine: ;;
      mapping:
        # ValueTable = Source(1)
        #   1    2     3        #    4        # 5        6        7
        # MSHW;Name;ModelNumber;SerialNumber;ChassisID;MSHW;PowerConsumptionKW;
        source: "${source::monitors.enclosure.collect.sources.source(2)}"
        attributes:
          id: $5
        metrics:
          hw.enclosure.power: $7
          hw.enclosure.energy: fakeCounter($7)
  blade:
    discovery:
      sources:
        source(1):
          # Source(1) = Blade 1
          # ModelNumber;SerialNumber;Version;Manufacturer;Model;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.1.1
          selectColumns: "2,3,4,5,7"
          computes:
            # Add a Blade Number
            # ID;Model;SerialNumber;Version;Manufacturer;Model;
          - type: leftConcat
            column: 1
            value: 1;
        source(2):
          # Source(2) = Blade 2
          # ModelNumber;SerialNumber;Version;Manufacturer;Model;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.2.1
          selectColumns: "2,3,4,5,7"
          computes:
            # Add a Blade Number
            # ID;Model;SerialNumber;Version;Manufacturer;Model;
          - type: leftConcat
            column: 1
            value: 2;
        source(3):
          # Source(3) = Blade 3
          # ModelNumber;SerialNumber;Version;Manufacturer;Model;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.3.1
          selectColumns: "2,3,4,5,7"
          computes:
            # Add a Blade Number
            # ID;Model;SerialNumber;Version;Manufacturer;Model;
          - type: leftConcat
            column: 1
            value: 3;
        source(4):
          # Source(4) = Blade 4
          # ModelNumber;SerialNumber;Version;Manufacturer;Model;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.4.1
          selectColumns: "2,3,4,5,7"
          computes:
            # Add a Blade Number
            # ID;Model;SerialNumber;Version;Manufacturer;Model;
          - type: leftConcat
            column: 1
            value: 4;
        source(5):
          # Source(5) = Blade 5
          # ModelNumber;SerialNumber;Version;Manufacturer;Model;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.5.1
          selectColumns: "2,3,4,5,7"
          computes:
            # Add a Blade Number
            # ID;Model;SerialNumber;Version;Manufacturer;Model;
          - type: leftConcat
            column: 1
            value: 5;
        source(6):
          # Source(6) = Blade 6
          # ModelNumber;SerialNumber;Version;Manufacturer;Model;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.6.1
          selectColumns: "2,3,4,5,7"
          computes:
            # Add a Blade Number
            # ID;Model;SerialNumber;Version;Manufacturer;Model;
          - type: leftConcat
            column: 1
            value: 6;
        source(7):
          # Source(7) = Blade 7
          # ModelNumber;SerialNumber;Version;Manufacturer;Model;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.7.1
          selectColumns: "2,3,4,5,7"
          computes:
            # Add a Blade Number
            # ID;Model;SerialNumber;Version;Manufacturer;Model;
          - type: leftConcat
            column: 1
            value: 7;
        source(8):
          # Source(8) = Blade 8
          # ModelNumber;SerialNumber;Version;Manufacturer;Model;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.8.1
          selectColumns: "2,3,4,5,7"
          computes:
            # Add a Blade Number
            # ID;Model;SerialNumber;Version;Manufacturer;Model;
          - type: leftConcat
            column: 1
            value: 8;
        source(9):
          # Join all these tables together
          # ID;Model;SerialNumber;Version;Manufacturer;Model;
          type: tableUnion
          tables:
          - "${source::monitors.blade.discovery.sources.source(1)}"
          - "${source::monitors.blade.discovery.sources.source(2)}"
          - "${source::monitors.blade.discovery.sources.source(3)}"
          - "${source::monitors.blade.discovery.sources.source(4)}"
          - "${source::monitors.blade.discovery.sources.source(5)}"
        source(10):
          type: tableUnion
          tables:
          - "${source::monitors.blade.discovery.sources.source(9)}"
          - "${source::monitors.blade.discovery.sources.source(6)}"
          - "${source::monitors.blade.discovery.sources.source(7)}"
          - "${source::monitors.blade.discovery.sources.source(8)}"
          computes:
            # Exclude blades with a model of "Not Install"
            # ID;Model;SerialNumber;Version;Manufacturer;Model;
          - type: excludeMatchingLines
            column: 2
            valueList: Not Install
            # Identify the Version
            # ID;ModelNumber;SerialNumber;Version;Manufacturer;Model;
          - type: leftConcat
            column: 2
            value: "Part Number: "
            # Identify the Version
            # ID;ModelNumber;SerialNumber;Version;Manufacturer;Model;
          - type: leftConcat
            column: 4
            value: "Version: "
          # Special Character sequence for joining AdditionalInformation
          - type: rightConcat
            column: 2
            value: ' - '
          # Join Part Number and version because we ran out of AdditionalInformation slots
          - type: rightConcat
            column: 2
            value: $4
        source(11):
          # Source 11 = Blade 1 Slot
          # Slot
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.1.4.1.0
          computes:
            # Add a Blade Number
            # ID;Slot;
          - type: leftConcat
            column: 1
            value: 1;
        source(12):
          # Source 12 = Blade 2 Slot
          # Slot
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.2.4.1.0
          computes:
            # Add a Blade Number
            # ID;Slot;
          - type: leftConcat
            column: 1
            value: 2;
        source(13):
          # Source 13 = Blade 3 Slot
          # Slot
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.3.4.1.0
          computes:
            # Add a Blade Number
            # ID;Slot;
          - type: leftConcat
            column: 1
            value: 3;
        source(14):
          # Source 14 = Blade 4 Slot
          # Slot
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.4.4.1.0
          computes:
            # Add a Blade Number
            # ID;Slot;
          - type: leftConcat
            column: 1
            value: 4;
        source(15):
          # Source 15 = Blade 5 Slot
          # Slot
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.5.4.1.0
          computes:
            # Add a Blade Number
            # ID;Slot;
          - type: leftConcat
            column: 1
            value: 5;
        source(16):
          # Source 16 = Blade 6 Slot
          # Slot
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.6.4.1.0
          computes:
            # Add a Blade Number
            # ID;Slot;
          - type: leftConcat
            column: 1
            value: 6;
        source(17):
          # Source 17 = Blade 7 Slot
          # Slot
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.7.4.1.0
          computes:
            # Add a Blade Number
            # ID;Slot;
          - type: leftConcat
            column: 1
            value: 7;
        source(18):
          # Source 18 = Blade 8 Slot
          # Slot
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.8.4.1.0
          computes:
            # Add a Blade Number
            # ID;Slot;
          - type: leftConcat
            column: 1
            value: 8;
        source(19):
          # Join all these tables together
          # Watch out - This table is re-used in the otherdevice discovery**
          # ID;Slot;
          type: tableUnion
          tables:
          - "${source::monitors.blade.discovery.sources.source(11)}"
          - "${source::monitors.blade.discovery.sources.source(12)}"
          - "${source::monitors.blade.discovery.sources.source(13)}"
          - "${source::monitors.blade.discovery.sources.source(14)}"
          - "${source::monitors.blade.discovery.sources.source(15)}"
        source(20):
          type: tableUnion
          tables:
          - "${source::monitors.blade.discovery.sources.source(19)}"
          - "${source::monitors.blade.discovery.sources.source(16)}"
          - "${source::monitors.blade.discovery.sources.source(17)}"
          - "${source::monitors.blade.discovery.sources.source(18)}"
        source(21):
          # Now let's join the main discovery table with the slot table
          # ID;ModelNumber;SerialNumber;Version;Manufacturer;Model;ID;Slot;
          type: tableJoin
          leftTable: "${source::monitors.blade.discovery.sources.source(10)}"
          rightTable: "${source::monitors.blade.discovery.sources.source(20)}"
          leftKeyColumn: 1
          rightKeyColumn: 1
          defaultRightLine: ;;
          computes:
            # Duplicate the ID
            # ID;DisplayID;ModelNumber;SerialNumber;Version;Manufacturer;Model;ID;Slot;
          - type: duplicateColumn
            column: 1
            # Add a Blade-
            # ID;DisplayID;ModelNumber;SerialNumber;Version;Manufacturer;Model;ID;Slot;
          - type: leftConcat
            column: 2
            value: Blade-
            # Add Location: to AdditionalInformation
            # ID;DisplayID;ModelNumber;SerialNumber;Version;Manufacturer;Model;ID;Slot;
          - type: leftConcat
            column: 9
            value: "Location: "
          # Add Vendor: to AdditionalInformation
          - type: leftConcat
            column: 6
            value: "Vendor: "
      mapping:
        # InstanceTable = Source(1)
        # ID;DisplayID;PartNumber - Version;SerialNumber;Version;Manufacturer;Model;ID;Slot;
        source: "${source::monitors.blade.discovery.sources.source(21)}"
        attributes:
          id: $1
          __display_id: $2
          model: $7
          serial_number: $4
          info: "${awk::join(\" \", $3, $9, $6)}"
          hw.parent.type: enclosure
          name: "${awk::sprintf(\"%s (%s)\", $2, $7)}"
    collect:
      # Collect type is "multi-instance
      type: multiInstance
      keys:
      - id
      sources:
        source(1):
          # Source(1) = Blade 1
          # PowerState;HealthState;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.1.4
          selectColumns: "2,3"
          computes:
            # Add a Blade Number
            # ID;PowerState;HealthState;
          - type: leftConcat
            column: 1
            value: 1;
        source(2):
          # Source(2) = Blade 2
          # PowerState;HealthState;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.2.4
          selectColumns: "2,3"
          computes:
            # Add a Blade Number
            # ID;PowerState;HealthState;
          - type: leftConcat
            column: 1
            value: 2;
        source(3):
          # Source(3) = Blade 3
          # PowerState;HealthState;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.3.4
          selectColumns: "2,3"
          computes:
            # Add a Blade Number
            # ID;PowerState;HealthState;
          - type: leftConcat
            column: 1
            value: 3;
        source(4):
          # Source(4) = Blade 4
          # PowerState;HealthState;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.4.4
          selectColumns: "2,3"
          computes:
            # Add a Blade Number
            # ID;PowerState;HealthState;
          - type: leftConcat
            column: 1
            value: 4;
        source(5):
          # Source(5) = Blade 5
          # PowerState;HealthState;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.5.4
          selectColumns: "2,3"
          computes:
            # Add a Blade Number
            # ID;PowerState;HealthState;
          - type: leftConcat
            column: 1
            value: 5;
        source(6):
          # Source(6) = Blade 6
          # PowerState;HealthState;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.6.4
          selectColumns: "2,3"
          computes:
            # Add a Blade Number
            # ID;PowerState;HealthState;
          - type: leftConcat
            column: 1
            value: 6;
        source(7):
          # Source(7) = Blade 7
          # PowerState;HealthState;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.7.4
          selectColumns: "2,3"
          computes:
            # Add a Blade Number
            # ID;PowerState;HealthState;
          - type: leftConcat
            column: 1
            value: 7;
        source(8):
          # Source(8) = Blade 8
          # PowerState;HealthState;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.8.4
          selectColumns: "2,3"
          computes:
            # Add a Blade Number
            # ID;PowerState;HealthState;
          - type: leftConcat
            column: 1
            value: 8;
        source(9):
          # Join all these tables together
          # ID;PowerState;HealthState;
          type: tableUnion
          tables:
          - "${source::monitors.blade.collect.sources.source(1)}"
          - "${source::monitors.blade.collect.sources.source(2)}"
          - "${source::monitors.blade.collect.sources.source(3)}"
          - "${source::monitors.blade.collect.sources.source(4)}"
          - "${source::monitors.blade.collect.sources.source(5)}"
        source(10):
          type: tableUnion
          tables:
          - "${source::monitors.blade.collect.sources.source(9)}"
          - "${source::monitors.blade.collect.sources.source(6)}"
          - "${source::monitors.blade.collect.sources.source(7)}"
          - "${source::monitors.blade.collect.sources.source(8)}"
          computes:
            # Translate the State
            # ID;PowerState;HealthState;
          - type: translate
            column: 3
            translationTable: "${translation::bladeStatusTranslationTable}"
            # Translate the Power State
            # ID;PowerState;HealthState;
          - type: translate
            column: 2
            translationTable: "${translation::PowerStateTranslationTable}"
      mapping:
        # ValueTable = Source(10)
        # ID;PowerState;HealthState;
        source: "${source::monitors.blade.collect.sources.source(10)}"
        attributes:
          id: $1
        metrics:
          hw.status{hw.type="blade"}: $3
          hw.blade.power_state: $2
  other_device:
    discovery:
      sources:
        source(1):
          # Source(1) = ManagementModule 1
          # ModelNumber;SerialNumber;Manufacturer;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.2.1.1
          selectColumns: "2,3,5"
          computes:
            # Add a ManagementModule Number
            # DeviceID;DisplayID;Type;ModelNumber;SerialNumber;Manufacturer;
          - type: leftConcat
            column: 1
            value: MM-1;1 (Slot 0);Management Module;
        source(2):
          # Source(2) = ManagementModule 2
          # ModelNumber;SerialNumber;Manufacturer;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.2.2.1
          selectColumns: "2,3,5"
          computes:
            # Add a ManagementModule Number
            # DeviceID;DisplayID;Type;ModelNumber;SerialNumber;Manufacturer;
          - type: leftConcat
            column: 1
            value: MM-2;2 (Slot 1);ManagementModule;
        source(3):
          # Source(3) = SwitchModule 1
          # Type;ModelNumber;SerialNumber;Manufacturer;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.3.1.1
          selectColumns: "1,2,3,5"
          computes:
            # Add a SwitchModule Number
            # DeviceID;DisplayID;Type;ModelNumber;SerialNumber;Manufacturer;
          - type: leftConcat
            column: 1
            value: SM-1;1 (Slot 0);
        source(4):
          # Source(4) = SwitchModule 2
          # Type;ModelNumber;SerialNumber;Manufacturer;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.3.2.1
          selectColumns: "1,2,3,5"
          computes:
            # Add a SwitchModule Number
            # DeviceID;DisplayID;Type;ModelNumber;SerialNumber;Manufacturer;
          - type: leftConcat
            column: 1
            value: SM-2;2 (Slot 1);
        source(5):
          # Source(5) = SwitchModule 3
          # Type;ModelNumber;SerialNumber;Manufacturer;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.3.3.1
          selectColumns: "1,2,3,5"
          computes:
            # Add a SwitchModule Number
            # DeviceID;DisplayID;Type;ModelNumber;SerialNumber;Manufacturer;
          - type: leftConcat
            column: 1
            value: SM-3;3 (Slot 2);
        source(6):
          # Source(6) = SwitchModule 4
          # Type;ModelNumber;SerialNumber;Manufacturer;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.3.4.1
          selectColumns: "1,2,3,5"
          computes:
            # Add a SwitchModule Number
            # DeviceID;DisplayID;Type;ModelNumber;SerialNumber;Manufacturer;
          - type: leftConcat
            column: 1
            value: SM-4;4 (Slot 3);
        source(7):
          # Source(7) = Partition 1
          # Valid;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.3.1.1
          selectColumns: 1
          computes:
            # Add a SwitchModule Number
            # DeviceID;DisplayID;Type;Valid;
          - type: leftConcat
            column: 1
            value: P-1;1;Partition;
        source(8):
          # Source(8) = Partition 2
          # Valid;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.3.2.1
          selectColumns: 1
          computes:
            # Add a SwitchModule Number
            # DeviceID;DisplayID;Type;Valid;
          - type: leftConcat
            column: 1
            value: P-2;2;Partition;
        source(9):
          # Source(9) = Partition 3
          # Valid;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.3.3.1
          selectColumns: 1
          computes:
            # Add a SwitchModule Number
            # DeviceID;DisplayID;Type;Valid;
          - type: leftConcat
            column: 1
            value: P-3;3;Partition;
        source(10):
          # Source(10) = Partition 4
          # Valid;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.3.4.1
          selectColumns: 1
          computes:
            # Add a SwitchModule Number
            # DeviceID;DisplayID;Type;Valid;
          - type: leftConcat
            column: 1
            value: P-4;4;Partition;
        source(11):
          # Source(11) = Partition 5
          # Valid;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.3.5.1
          selectColumns: 1
          computes:
            # Add a SwitchModule Number
            # DeviceID;DisplayID;Type;Valid;
          - type: leftConcat
            column: 1
            value: P-5;5;Partition;
        source(12):
          # Source(12) = Partition 6
          # Valid;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.3.6.1
          selectColumns: 1
          computes:
            # Add a SwitchModule Number
            # DeviceID;DisplayID;Type;Valid;
          - type: leftConcat
            column: 1
            value: P-6;6;Partition;
        source(13):
          # Source(13) = Partition 7
          # Valid;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.3.7.1
          selectColumns: 1
          computes:
            # Add a SwitchModule Number
            # DeviceID;DisplayID;Type;Valid;
          - type: leftConcat
            column: 1
            value: P-7;7;Partition;
        source(14):
          # Source(14) = Partition 8
          # Valid;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.3.8.1
          selectColumns: 1
          computes:
            # Add a SwitchModule Number
            # DeviceID;DisplayID;Type;Valid;
          - type: leftConcat
            column: 1
            value: P-8;8;Partition;
        source(15):
          # Source(15) = Partition 1 Membership Table
          # SlotNum;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.3.1.1.20.3.1
          selectColumns: 2
          computes:
            # Add a Partition ID
            # PartitionID;SlotNum;
          - type: leftConcat
            column: 1
            value: P-1;
        source(16):
          # Source(16) = Partition 2 Membership Table
          # SlotNum;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.3.2.1.20.3.1
          selectColumns: 2
          computes:
            # Add a Partition ID
            # PartitionID;SlotNum;
          - type: leftConcat
            column: 1
            value: P-2;
        source(17):
          # Source(17) = Partition 3 Membership Table
          # SlotNum;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.3.3.1.20.3.1
          selectColumns: 2
          computes:
            # Add a Partition ID
            # PartitionID;SlotNum;
          - type: leftConcat
            column: 1
            value: P-3;
        source(18):
          # Source(18) = Partition 4 Membership Table
          # SlotNum;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.3.4.1.20.3.1
          selectColumns: 2
          computes:
            # Add a Partition ID
            # PartitionID;SlotNum;
          - type: leftConcat
            column: 1
            value: P-4;
        source(19):
          # Source(19) = Partition 5 Membership Table
          # SlotNum;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.3.5.1.20.3.1
          selectColumns: 2
          computes:
            # Add a Partition ID
            # PartitionID;SlotNum;
          - type: leftConcat
            column: 1
            value: P-5;
        source(20):
          # Source(20) = Partition 6 Membership Table
          # SlotNum;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.3.6.1.20.3.1
          selectColumns: 2
          computes:
            # Add a Partition ID
            # PartitionID;SlotNum;
          - type: leftConcat
            column: 1
            value: P-6;
        source(21):
          # Source(21) = Partition 7 Membership Table
          # SlotNum;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.3.7.1.20.3.1
          selectColumns: 2
          computes:
            # Add a Partition ID
            # PartitionID;SlotNum;
          - type: leftConcat
            column: 1
            value: P-7;
        source(22):
          # Source(22) = Partition 8 Membership Table
          # SlotNum;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.3.8.1.20.3.1
          selectColumns: 2
          computes:
            # Add a Partition ID
            # PartitionID;SlotNum;
          - type: leftConcat
            column: 1
            value: P-8;
        source(23):
          # Union Partition Membership Tables
          # PartitionID;SlotNum;
          type: tableUnion
          tables:
          - "${source::monitors.other_device.discovery.sources.source(15)}"
          - "${source::monitors.other_device.discovery.sources.source(16)}"
          - "${source::monitors.other_device.discovery.sources.source(17)}"
          - "${source::monitors.other_device.discovery.sources.source(18)}"
          - "${source::monitors.other_device.discovery.sources.source(19)}"
        source(24):
          type: tableUnion
          tables:
          - "${source::monitors.other_device.discovery.sources.source(23)}"
          - "${source::monitors.other_device.discovery.sources.source(20)}"
          - "${source::monitors.other_device.discovery.sources.source(21)}"
          - "${source::monitors.other_device.discovery.sources.source(22)}"
        source(25):
          # Match the SlotNum with the BladeName (from Blade Discovery 20)
          # PartitionID;SlotNum;BladeID;SlotNum;
          type: tableJoin
          leftTable: "${source::monitors.other_device.discovery.sources.source(24)}"
          rightTable: "${source::monitors.blade.discovery.sources.source(20)}"
          leftKeyColumn: 2
          rightKeyColumn: 2
          defaultRightLine: ;;
          computes:
            # Push this through an awk script to get one line per partition
            # PartitionID;Members;
          - type: awk
            script: "${file::embeddedFile-1}"
            keep: ^MSHW;
            separators: ;
            selectColumns: "2,3"
        source(26):
          # Union Partition Tables
          # DeviceID;DisplayID;Type;Valid;
          type: tableUnion
          tables:
          - "${source::monitors.other_device.discovery.sources.source(7)}"
          - "${source::monitors.other_device.discovery.sources.source(8)}"
          - "${source::monitors.other_device.discovery.sources.source(9)}"
          - "${source::monitors.other_device.discovery.sources.source(10)}"
          - "${source::monitors.other_device.discovery.sources.source(11)}"
        source(27):
          type: tableUnion
          tables:
          - "${source::monitors.other_device.discovery.sources.source(26)}"
          - "${source::monitors.other_device.discovery.sources.source(12)}"
          - "${source::monitors.other_device.discovery.sources.source(13)}"
          - "${source::monitors.other_device.discovery.sources.source(14)}"
        source(28):
          # Join the Partition Table with the Partition Membership Table
          # DeviceID;DisplayID;Type;Valid;PartitionID;Members;
          type: tableJoin
          leftTable: "${source::monitors.other_device.discovery.sources.source(27)}"
          rightTable: "${source::monitors.other_device.discovery.sources.source(25)}"
          leftKeyColumn: 1
          rightKeyColumn: 1
          defaultRightLine: ;;
          computes:
            # Keep only "Valid" partitions
            # DeviceID;DisplayID;Type;Valid;PartitionID;Members;
          - type: keepOnlyMatchingLines
            column: 4
            valueList: 2
            # Blank Columns 4 and 5
            # DeviceID;DisplayID;Type;;;Members;
          - type: replace
            column: 4
            existingValue: $4
            newValue: ""
          - type: replace
            column: 5
            existingValue: $5
            newValue: ""
        source(29):
          # Merge all Management Modules
          # DeviceID;DisplayID;Type;ModelNumber;SerialNumber;Manufacturer;
          type: tableUnion
          tables:
          - "${source::monitors.other_device.discovery.sources.source(1)}"
          - "${source::monitors.other_device.discovery.sources.source(2)}"
          computes:
            # Exclude Management Modules with a model of "Not Install"
            # DeviceID;DisplayID;Type;ModelNumber;SerialNumber;Manufacturer;
          - type: excludeMatchingLines
            column: 3
            valueList: Not Install
        source(30):
          # Merge all Switch Modules
          # DeviceID;DisplayID;Type;ModelNumber;SerialNumber;Manufacturer;
          type: tableUnion
          tables:
          - "${source::monitors.other_device.discovery.sources.source(3)}"
          - "${source::monitors.other_device.discovery.sources.source(4)}"
          - "${source::monitors.other_device.discovery.sources.source(5)}"
          - "${source::monitors.other_device.discovery.sources.source(6)}"
          computes:
            # Exclude Switch Modules with a model of "Not Install"
            # DeviceID;DisplayID;Type;ModelNumber;SerialNumber;Manufacturer;
          - type: excludeMatchingLines
            column: 3
            valueList: Not Install
        source(31):
          # Merge all other devices together
          # DeviceID;DisplayID;Type;ModelNumber;SerialNumber;Manufacturer;
          type: tableUnion
          tables:
          - "${source::monitors.other_device.discovery.sources.source(28)}"
          - "${source::monitors.other_device.discovery.sources.source(29)}"
          - "${source::monitors.other_device.discovery.sources.source(30)}"
          computes:
          - type: leftConcat
            column: 4
            value: "Model: "
          - type: leftConcat
            column: 5
            value: "Serial Number: "
          - type: leftConcat
            column: 6
            value: "Vendor: "
      mapping:
        # The Instance Table
        # DeviceID;DisplayID;Type;ModelNumber;SerialNumber;Manufacturer;
        source: "${source::monitors.other_device.discovery.sources.source(31)}"
        attributes:
          id: $1
          __display_id: $2
          device_type: $3
          info: "${awk::join(\" \", $4, $5, $6)}"
          hw.parent.type: enclosure
          name: "${awk::sprintf(\"%s: %s\", $3, $2)}"
    collect:
      # Collect type is "multi-instance
      type: multiInstance
      keys:
      - id
      sources:
        source(1):
          # Source 1 = Management Module 1
          # Health
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.2.1.4.3.0
          computes:
            # Add a ManagementModule Number
            # DeviceID;Health
          - type: leftConcat
            column: 1
            value: MM-1;
        source(2):
          # Source 2 = Management Module 2
          # Health
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.2.2.4.3.0
          computes:
            # Add a ManagementModule Number
            # DeviceID;Health
          - type: leftConcat
            column: 1
            value: MM-2;
        source(3):
          # Source 3 = Switch Module 1
          # Health
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.3.1.4.3.0
          computes:
            # Add a SwitchModule Number
            # DeviceID;Health
          - type: leftConcat
            column: 1
            value: SM-1;
        source(4):
          # Source 4 = Switch Module 2
          # Health
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.3.2.4.3.0
          computes:
            # Add a SwitchModule Number
            # DeviceID;Health
          - type: leftConcat
            column: 1
            value: SM-2;
        source(5):
          # Source 5 = Switch Module 3
          # Health
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.3.3.4.3.0
          computes:
            # Add a SwitchModule Number
            # DeviceID;Health
          - type: leftConcat
            column: 1
            value: SM-3;
        source(6):
          # Source 6 = Switch Module 4
          # Health
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.3.4.4.3.0
          computes:
            # Add a SwitchModule Number
            # DeviceID;Health
          - type: leftConcat
            column: 1
            value: SM-4;
        source(7):
          # Source 7 = Parition 1
          # Health
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.3.1.4.2.0
          computes:
            # Add a SwitchModule Number
            # DeviceID;Health
          - type: leftConcat
            column: 1
            value: P-1;
        source(8):
          # Source 8 = Parition 2
          # Health
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.3.2.4.2.0
          computes:
            # Add a SwitchModule Number
            # DeviceID;Health
          - type: leftConcat
            column: 1
            value: P-2;
        source(9):
          # Source 9 = Parition 3
          # Health
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.3.3.4.2.0
          computes:
            # Add a SwitchModule Number
            # DeviceID;Health
          - type: leftConcat
            column: 1
            value: P-3;
        source(10):
          # Source 10 = Parition 4
          # Health
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.3.4.4.2.0
          computes:
            # Add a SwitchModule Number
            # DeviceID;Health
          - type: leftConcat
            column: 1
            value: P-4;
        source(11):
          # Source 11 = Parition 5
          # Health
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.3.5.4.2.0
          computes:
            # Add a SwitchModule Number
            # DeviceID;Health
          - type: leftConcat
            column: 1
            value: P-5;
        source(12):
          # Source 12 = Parition 6
          # Health
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.3.6.4.2.0
          computes:
            # Add a SwitchModule Number
            # DeviceID;Health
          - type: leftConcat
            column: 1
            value: P-6;
        source(13):
          # Source 13 = Parition 7
          # Health
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.3.7.4.2.0
          computes:
            # Add a SwitchModule Number
            # DeviceID;Health
          - type: leftConcat
            column: 1
            value: P-7;
        source(14):
          # Source X = Parition X
          # Health
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.3.8.4.2.0
          computes:
            # Add a SwitchModule Number
            # DeviceID;Health
          - type: leftConcat
            column: 1
            value: P-8;
        source(15):
          # Merge all Management Modules
          # DeviceID;Health
          type: tableUnion
          tables:
          - "${source::monitors.other_device.collect.sources.source(1)}"
          - "${source::monitors.other_device.collect.sources.source(2)}"
        source(16):
          # Merge all Switch Modules
          # DeviceID;Health
          type: tableUnion
          tables:
          - "${source::monitors.other_device.collect.sources.source(3)}"
          - "${source::monitors.other_device.collect.sources.source(4)}"
          - "${source::monitors.other_device.collect.sources.source(5)}"
          - "${source::monitors.other_device.collect.sources.source(6)}"
        source(17):
          # Merge all Partitions
          # DeviceID;Health
          type: tableUnion
          tables:
          - "${source::monitors.other_device.collect.sources.source(7)}"
          - "${source::monitors.other_device.collect.sources.source(8)}"
          - "${source::monitors.other_device.collect.sources.source(9)}"
          - "${source::monitors.other_device.collect.sources.source(10)}"
          - "${source::monitors.other_device.collect.sources.source(11)}"
        source(18):
          type: tableUnion
          tables:
          - "${source::monitors.other_device.collect.sources.source(17)}"
          - "${source::monitors.other_device.collect.sources.source(12)}"
          - "${source::monitors.other_device.collect.sources.source(13)}"
          - "${source::monitors.other_device.collect.sources.source(14)}"
        source(19):
          # Merge all Other Devices
          # DeviceID;Health;
          type: tableUnion
          tables:
          - "${source::monitors.other_device.collect.sources.source(15)}"
          - "${source::monitors.other_device.collect.sources.source(16)}"
          - "${source::monitors.other_device.collect.sources.source(18)}"
          computes:
            # Translate the State
            # DeviceID;HealthState;
          - type: translate
            column: 2
            translationTable: "${translation::statusTranslationTable}"
      mapping:
        # The ValueTable
        # DeviceID;HealthState;
        source: "${source::monitors.other_device.collect.sources.source(19)}"
        attributes:
          id: $1
        metrics:
          hw.status{hw.type="other_device"}: $2
  fan:
    discovery:
      sources:
        source(1):
          # Source 1 = Fan Module 1
          # Power
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.4.1.4.2.0
          computes:
            # Add a Fan Number
            # ID;Power;
          - type: leftConcat
            column: 1
            value: FM-1;
        source(2):
          # Source 2 = Fan Module 2
          # Power
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.4.2.4.2.0
          computes:
            # Add a Fan Number
            # ID;Power;
          - type: leftConcat
            column: 1
            value: FM-2;
        source(3):
          # Source 3 = Fan Module 3
          # Power
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.4.3.4.2.0
          computes:
            # Add a Fan Number
            # ID;Power;
          - type: leftConcat
            column: 1
            value: FM-3;
        source(4):
          # Source 4 = Fan Module 4
          # Power
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.4.4.4.2.0
          computes:
            # Add a Fan Number
            # ID;Power;
          - type: leftConcat
            column: 1
            value: FM-4;
        source(5):
          # Source 5 = Fan Module 5
          # Power
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.4.5.4.2.0
          computes:
            # Add a Fan Number
            # ID;Power;
          - type: leftConcat
            column: 1
            value: FM-5;
        source(6):
          # Source 6 = Fan Module 6
          # Power
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.4.6.4.2.0
          computes:
            # Add a Fan Number
            # ID;Power;
          - type: leftConcat
            column: 1
            value: FM-6;
        source(7):
          # Merge all Fan Modules
          # ID;Power;
          type: tableUnion
          tables:
          - "${source::monitors.fan.discovery.sources.source(1)}"
          - "${source::monitors.fan.discovery.sources.source(2)}"
          - "${source::monitors.fan.discovery.sources.source(3)}"
          - "${source::monitors.fan.discovery.sources.source(4)}"
          - "${source::monitors.fan.discovery.sources.source(5)}"
        source(8):
          type: tableUnion
          tables:
          - "${source::monitors.fan.discovery.sources.source(7)}"
          - "${source::monitors.fan.discovery.sources.source(6)}"
          computes:
            # Keep only Powered On Fans
            # ID;Power;
          - type: keepOnlyMatchingLines
            column: 2
            valueList: "2,3,5,6"
            # Add a Type
            # Type;ID;Power;
          - type: leftConcat
            column: 1
            value: Fan Module;
        source(9):
          # Fan Module 1 Fans
          # ID;Status;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.4.1.4.10.1
          selectColumns: "2,4"
          computes:
            # Add Module ID
            # ID;Status;
          - type: leftConcat
            column: 1
            value: FM1-FAN
        source(10):
          # Fan Module 2 Fans
          # ID;Status;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.4.2.4.10.1
          selectColumns: "2,4"
          computes:
            # Add Module ID
            # ID;Status;
          - type: leftConcat
            column: 1
            value: FM2-FAN
        source(11):
          # Fan Module 3 Fans
          # ID;Status;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.4.3.4.10.1
          selectColumns: "2,4"
          computes:
            # Add Module ID
            # ID;Status;
          - type: leftConcat
            column: 1
            value: FM3-FAN
        source(12):
          # Fan Module 4 Fans
          # ID;Status;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.4.4.4.10.1
          selectColumns: "2,4"
          computes:
            # Add Module ID
            # ID;Status;
          - type: leftConcat
            column: 1
            value: FM4-FAN
        source(13):
          # Fan Module 5 Fans
          # ID;Status;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.4.5.4.10.1
          selectColumns: "2,4"
          computes:
            # Add Module ID
            # ID;Status;
          - type: leftConcat
            column: 1
            value: FM5-FAN
        source(14):
          # Fan Module 6 Fans
          # ID;Status;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.4.6.4.10.1
          selectColumns: "2,4"
          computes:
            # Add Module ID
            # ID;Status;
          - type: leftConcat
            column: 1
            value: FM6-FAN
        source(15):
          # Merge all Individual Fans
          # ID;Status;
          type: tableUnion
          tables:
          - "${source::monitors.fan.discovery.sources.source(9)}"
          - "${source::monitors.fan.discovery.sources.source(10)}"
          - "${source::monitors.fan.discovery.sources.source(11)}"
          - "${source::monitors.fan.discovery.sources.source(12)}"
          - "${source::monitors.fan.discovery.sources.source(13)}"
        source(16):
          type: tableUnion
          tables:
          - "${source::monitors.fan.discovery.sources.source(15)}"
          - "${source::monitors.fan.discovery.sources.source(14)}"
          computes:
            # Keep only Fans that are valid or invalid (not unknown)
            # ID;Status;
          - type: keepOnlyMatchingLines
            column: 2
            valueList: "1,2"
            # Add a Type
            # Type;ID;Status;
          - type: leftConcat
            column: 1
            value: Fan;
        source(17):
          # Unite the Fan Modules and Fan Individual
          # Type;ID;Power/Status;
          type: tableUnion
          tables:
          - "${source::monitors.fan.discovery.sources.source(8)}"
          - "${source::monitors.fan.discovery.sources.source(16)}"
      mapping:
        # InstanceTable = Source(17)
        # Type;ID;Power;
        source: "${source::monitors.fan.discovery.sources.source(17)}"
        attributes:
          id: $2
          sensor_location: $1
          hw.parent.type: enclosure
          name: "${awk::sprintf(\"%s (%s)\", $2, $1)}"
    collect:
      # Collect type is "multi-instance
      type: multiInstance
      keys:
      - id
      sources:
        source(1):
          # Source 1 = Fan Module 1
          # Health
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.4.1.4.3.0
          computes:
            # Add a Fan Number
            # ID;Health;
          - type: leftConcat
            column: 1
            value: FM-1;
        source(2):
          # Source 2 = Fan Module 2
          # Health
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.4.2.4.3.0
          computes:
            # Add a Fan Number
            # ID;Health;
          - type: leftConcat
            column: 1
            value: FM-2;
        source(3):
          # Source 3 = Fan Module 3
          # Health
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.4.3.4.3.0
          computes:
            # Add a Fan Number
            # ID;Health;
          - type: leftConcat
            column: 1
            value: FM-3;
        source(4):
          # Source 4 = Fan Module 4
          # Health
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.4.4.4.3.0
          computes:
            # Add a Fan Number
            # ID;Health;
          - type: leftConcat
            column: 1
            value: FM-4;
        source(5):
          # Source 5 = Fan Module 5
          # Health
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.4.5.4.3.0
          computes:
            # Add a Fan Number
            # ID;Health;
          - type: leftConcat
            column: 1
            value: FM-5;
        source(6):
          # Source 6 = Fan Module 6
          # Health
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.4.6.4.3.0
          computes:
            # Add a Fan Number
            # ID;Health;
          - type: leftConcat
            column: 1
            value: FM-6;
        source(7):
          # Merge all Fan Modules
          # ID;Health;
          type: tableUnion
          tables:
          - "${source::monitors.fan.collect.sources.source(1)}"
          - "${source::monitors.fan.collect.sources.source(2)}"
          - "${source::monitors.fan.collect.sources.source(3)}"
          - "${source::monitors.fan.collect.sources.source(4)}"
          - "${source::monitors.fan.collect.sources.source(5)}"
        source(8):
          type: tableUnion
          tables:
          - "${source::monitors.fan.collect.sources.source(7)}"
          - "${source::monitors.fan.collect.sources.source(6)}"
          computes:
            # Translate the State
            # ID;HealthState;
          - type: translate
            column: 2
            translationTable: "${translation::statusTranslationTable}"
        source(9):
          # Fan Module 1 Fans
          # ID;Status;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.4.1.4.10.1
          selectColumns: "2,4"
          computes:
            # Add Module ID
            # ID;Status;
          - type: leftConcat
            column: 1
            value: FM1-FAN
        source(10):
          # Fan Module 2 Fans
          # ID;Status;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.4.2.4.10.1
          selectColumns: "2,4"
          computes:
            # Add Module ID
            # ID;Status;
          - type: leftConcat
            column: 1
            value: FM2-FAN
        source(11):
          # Fan Module 3 Fans
          # ID;Status;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.4.3.4.10.1
          selectColumns: "2,4"
          computes:
            # Add Module ID
            # ID;Status;
          - type: leftConcat
            column: 1
            value: FM3-FAN
        source(12):
          # Fan Module 4 Fans
          # ID;Status;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.4.4.4.10.1
          selectColumns: "2,4"
          computes:
            # Add Module ID
            # ID;Status;
          - type: leftConcat
            column: 1
            value: FM4-FAN
        source(13):
          # Fan Module 5 Fans
          # ID;Status;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.4.5.4.10.1
          selectColumns: "2,4"
          computes:
            # Add Module ID
            # ID;Status;
          - type: leftConcat
            column: 1
            value: FM5-FAN
        source(14):
          # Fan Module 6 Fans
          # ID;Status;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.4.6.4.10.1
          selectColumns: "2,4"
          computes:
            # Add Module ID
            # ID;Status;
          - type: leftConcat
            column: 1
            value: FM6-FAN
        source(15):
          # Merge all Individual Fans
          # ID;Status;
          type: tableUnion
          tables:
          - "${source::monitors.fan.collect.sources.source(9)}"
          - "${source::monitors.fan.collect.sources.source(10)}"
          - "${source::monitors.fan.collect.sources.source(11)}"
          - "${source::monitors.fan.collect.sources.source(12)}"
          - "${source::monitors.fan.collect.sources.source(13)}"
        source(16):
          type: tableUnion
          tables:
          - "${source::monitors.fan.collect.sources.source(15)}"
          - "${source::monitors.fan.collect.sources.source(14)}"
          computes:
            # Translate the State
            # ID;Status;
          - type: translate
            column: 2
            translationTable: "${translation::validStatusTranslationTable}"
        source(17):
          # Unite the Fan Modules and Fan Individual
          # ID;Status;
          type: tableUnion
          tables:
          - "${source::monitors.fan.collect.sources.source(8)}"
          - "${source::monitors.fan.collect.sources.source(16)}"
      mapping:
        # ValueTable = Source(17)
        # ID;PatrolStatus;
        source: "${source::monitors.fan.collect.sources.source(17)}"
        attributes:
          id: $1
        metrics:
          hw.status{hw.type="fan"}: $2
  power_supply:
    discovery:
      sources:
        source(1):
          # Source 1 = PowerSupply Module 1
          # Power
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.5.1.4.2.0
          computes:
            # Add a PowerSupply Number
            # ID;Power;
          - type: leftConcat
            column: 1
            value: PS-1;
        source(2):
          # Source 2 = PowerSupply Module 2
          # Power
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.5.2.4.2.0
          computes:
            # Add a PowerSupply Number
            # ID;Power;
          - type: leftConcat
            column: 1
            value: PS-2;
        source(3):
          # Source 3 = PowerSupply Module 3
          # Power
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.5.3.4.2.0
          computes:
            # Add a PowerSupply Number
            # ID;Power;
          - type: leftConcat
            column: 1
            value: PS-3;
        source(4):
          # Source 4 = PowerSupply Module 4
          # Power
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.5.4.4.2.0
          computes:
            # Add a PowerSupply Number
            # ID;Power;
          - type: leftConcat
            column: 1
            value: PS-4;
        source(5):
          # Merge all Fan Modules
          # ID;Power;
          type: tableUnion
          tables:
          - "${source::monitors.power_supply.discovery.sources.source(1)}"
          - "${source::monitors.power_supply.discovery.sources.source(2)}"
          - "${source::monitors.power_supply.discovery.sources.source(3)}"
          - "${source::monitors.power_supply.discovery.sources.source(4)}"
          computes:
            # Keep only Powered On Fans
            # ID;Power;
          - type: keepOnlyMatchingLines
            column: 2
            valueList: 2
      mapping:
        # InstanceTable = Source(8)
        # ID;Power;
        source: "${source::monitors.power_supply.discovery.sources.source(5)}"
        attributes:
          id: $1
          hw.parent.type: enclosure
          name: $1
    collect:
      # Collect type is "multi-instance
      type: multiInstance
      keys:
      - id
      sources:
        source(1):
          # Source 1 = PowerSupply Module 1
          # Health
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.5.1.4.3.0
          computes:
            # Add a PowerSupply Number
            # ID;Health;
          - type: leftConcat
            column: 1
            value: PS-1;
        source(2):
          # Source 2 = PowerSupply Module 2
          # Health
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.5.2.4.3.0
          computes:
            # Add a PowerSupply Number
            # ID;Health;
          - type: leftConcat
            column: 1
            value: PS-2;
        source(3):
          # Source 3 = PowerSupply Module 3
          # Health
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.5.3.4.3.0
          computes:
            # Add a PowerSupply Number
            # ID;Health;
          - type: leftConcat
            column: 1
            value: PS-3;
        source(4):
          # Source 4 = PowerSupply Module 4
          # Health
          type: snmpGet
          oid: 1.3.6.1.4.1.116.5.52.1.2.5.4.4.3.0
          computes:
            # Add a PowerSupply Number
            # ID;Health;
          - type: leftConcat
            column: 1
            value: PS-4;
        source(5):
          # Merge all PowerSupply Modules
          # ID;Health;
          type: tableUnion
          tables:
          - "${source::monitors.power_supply.collect.sources.source(1)}"
          - "${source::monitors.power_supply.collect.sources.source(2)}"
          - "${source::monitors.power_supply.collect.sources.source(3)}"
          - "${source::monitors.power_supply.collect.sources.source(4)}"
          computes:
            # Translate the State
            # ID;HealthState;
          - type: translate
            column: 2
            translationTable: "${translation::statusTranslationTable}"
      mapping:
        # ValueTable = Source(4)
        # ID;PatrolStatus;
        source: "${source::monitors.power_supply.collect.sources.source(5)}"
        attributes:
          id: $1
        metrics:
          hw.status{hw.type="power_supply"}: $2
  voltage:
    discovery:
      sources:
        source(1):
          # Blade Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.1.4.40.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade1-
        source(2):
          # Blade Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.2.4.40.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade2-
        source(3):
          # Blade Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.3.4.40.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade3-
        source(4):
          # Blade Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.4.4.40.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade4-
        source(5):
          # Blade Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.5.4.40.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade5-
        source(6):
          # Blade Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.6.4.40.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade6-
        source(7):
          # Blade Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.7.4.40.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade7-
        source(8):
          # Blade Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.8.4.40.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade8-
        source(9):
          # ManagementModule Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.2.1.4.30.1
          selectColumns: "2,4,3"
          computes:
            # Add ManagementModule ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: ManagementModule1-
        source(10):
          # ManagementModule Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.2.2.4.30.1
          selectColumns: "2,4,3"
          computes:
            # Add ManagementModule ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: ManagementModule2-
        source(11):
          # SwitchModule Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.3.1.4.30.1
          selectColumns: "2,4,3"
          computes:
            # Add SwitchModule ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: SwitchModule1-
        source(12):
          # SwitchModule Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.3.2.4.30.1
          selectColumns: "2,4,3"
          computes:
            # Add SwitchModule ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: SwitchModule2-
        source(13):
          # SwitchModule Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.3.3.4.30.1
          selectColumns: "2,4,3"
          computes:
            # Add SwitchModule ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: SwitchModule3-
        source(14):
          # SwitchModule Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.3.4.4.30.1
          selectColumns: "2,4,3"
          computes:
            # Add SwitchModule ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: SwitchModule4-
        source(15):
          # Unite the Voltages
          # ID;Status;Value;
          type: tableUnion
          tables:
          - "${source::monitors.voltage.discovery.sources.source(1)}"
          - "${source::monitors.voltage.discovery.sources.source(2)}"
          - "${source::monitors.voltage.discovery.sources.source(3)}"
          - "${source::monitors.voltage.discovery.sources.source(4)}"
          - "${source::monitors.voltage.discovery.sources.source(5)}"
        source(16):
          type: tableUnion
          tables:
          - "${source::monitors.voltage.discovery.sources.source(6)}"
          - "${source::monitors.voltage.discovery.sources.source(7)}"
          - "${source::monitors.voltage.discovery.sources.source(8)}"
          - "${source::monitors.voltage.discovery.sources.source(9)}"
          - "${source::monitors.voltage.discovery.sources.source(10)}"
        source(17):
          type: tableUnion
          tables:
          - "${source::monitors.voltage.discovery.sources.source(11)}"
          - "${source::monitors.voltage.discovery.sources.source(12)}"
          - "${source::monitors.voltage.discovery.sources.source(13)}"
          - "${source::monitors.voltage.discovery.sources.source(14)}"
        source(18):
          type: tableUnion
          tables:
          - "${source::monitors.voltage.discovery.sources.source(15)}"
          - "${source::monitors.voltage.discovery.sources.source(16)}"
          - "${source::monitors.voltage.discovery.sources.source(17)}"
          computes:
            # Keep only Voltage that are valid or invalid (not unknown)
            # ID;Status;Value;
          - type: keepOnlyMatchingLines
            column: 2
            valueList: "1,2"
            # Remove Voltages of 0
            # ID;Status;Value;
          - type: leftConcat
            column: 3
            value: MSHW_
          # Remove 0 value
          - type: replace
            column: 3
            existingValue: MSHW_0
            newValue: ""
          # Remove MSHW_ for non 0 values
          - type: replace
            column: 3
            existingValue: MSHW_
            newValue: ""
      mapping:
        # InstanceTable = Source(18)
        # ID;Status;Value;
        source: "${source::monitors.voltage.discovery.sources.source(18)}"
        attributes:
          id: $1
          __display_id: $1
          hw.parent.type: enclosure
          name: $1
        conditionalCollection:
          hw.voltage: $3
    collect:
      # Collect type is "multi-instance
      type: multiInstance
      keys:
      - id
      sources:
        source(1):
          # Blade Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.1.4.40.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade1-
        source(2):
          # Blade Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.2.4.40.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade2-
        source(3):
          # Blade Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.3.4.40.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade3-
        source(4):
          # Blade Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.4.4.40.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade4-
        source(5):
          # Blade Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.5.4.40.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade5-
        source(6):
          # Blade Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.6.4.40.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade6-
        source(7):
          # Blade Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.7.4.40.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade7-
        source(8):
          # Blade Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.8.4.40.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade8-
        source(9):
          # ManagementModule Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.2.1.4.30.1
          selectColumns: "2,4,3"
          computes:
            # Add ManagementModule ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: ManagementModule1-
        source(10):
          # ManagementModule Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.2.2.4.30.1
          selectColumns: "2,4,3"
          computes:
            # Add ManagementModule ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: ManagementModule2-
        source(11):
          # SwitchModule Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.3.1.4.30.1
          selectColumns: "2,4,3"
          computes:
            # Add SwitchModule ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: SwitchModule1-
        source(12):
          # SwitchModule Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.3.2.4.30.1
          selectColumns: "2,4,3"
          computes:
            # Add SwitchModule ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: SwitchModule2-
        source(13):
          # SwitchModule Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.3.3.4.30.1
          selectColumns: "2,4,3"
          computes:
            # Add SwitchModule ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: SwitchModule3-
        source(14):
          # SwitchModule Voltage
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.3.4.4.30.1
          selectColumns: "2,4,3"
          computes:
            # Add SwitchModule ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: SwitchModule4-
        source(15):
          # Unite the Voltages
          # ID;Status;
          type: tableUnion
          tables:
          - "${source::monitors.voltage.collect.sources.source(1)}"
          - "${source::monitors.voltage.collect.sources.source(2)}"
          - "${source::monitors.voltage.collect.sources.source(3)}"
          - "${source::monitors.voltage.collect.sources.source(4)}"
          - "${source::monitors.voltage.collect.sources.source(5)}"
        source(16):
          type: tableUnion
          tables:
          - "${source::monitors.voltage.collect.sources.source(6)}"
          - "${source::monitors.voltage.collect.sources.source(7)}"
          - "${source::monitors.voltage.collect.sources.source(8)}"
          - "${source::monitors.voltage.collect.sources.source(9)}"
          - "${source::monitors.voltage.collect.sources.source(10)}"
        source(17):
          type: tableUnion
          tables:
          - "${source::monitors.voltage.collect.sources.source(11)}"
          - "${source::monitors.voltage.collect.sources.source(12)}"
          - "${source::monitors.voltage.collect.sources.source(13)}"
          - "${source::monitors.voltage.collect.sources.source(14)}"
        source(18):
          type: tableUnion
          tables:
          - "${source::monitors.voltage.collect.sources.source(15)}"
          - "${source::monitors.voltage.collect.sources.source(16)}"
          - "${source::monitors.voltage.collect.sources.source(17)}"
          computes:
            # Translate the State
            # ID;Status;Value;
          - type: translate
            column: 2
            translationTable: "${translation::validStatusTranslationTable}"
          # Multiply Voltage By 100
          - type: multiply
            column: 3
            value: 100
      mapping:
        # ValueTable = Source(18)
        # ID;PatrolStatus;
        source: "${source::monitors.voltage.collect.sources.source(18)}"
        attributes:
          id: $1
        metrics:
          hw.status{hw.type="voltage"}: $2
          hw.voltage: $3
  temperature:
    discovery:
      sources:
        source(1):
          # Blade Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.1.4.41.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade1-
        source(2):
          # Blade Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.2.4.41.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade2-
        source(3):
          # Blade Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.3.4.41.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade3-
        source(4):
          # Blade Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.4.4.41.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade4-
        source(5):
          # Blade Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.5.4.41.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade5-
        source(6):
          # Blade Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.6.4.41.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade6-
        source(7):
          # Blade Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.7.4.41.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade7-
        source(8):
          # Blade Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.8.4.41.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade8-
        source(9):
          # ManagementModule Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.2.1.4.31.1
          selectColumns: "2,4,3"
          computes:
            # Add ManagementModule ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: ManagementModule1-
        source(10):
          # ManagementModule Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.2.2.4.31.1
          selectColumns: "2,4,3"
          computes:
            # Add ManagementModule ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: ManagementModule2-
        source(11):
          # SwitchModule Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.3.1.4.31.1
          selectColumns: "2,4,3"
          computes:
            # Add SwitchModule ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: SwitchModule1-
        source(12):
          # SwitchModule Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.3.2.4.31.1
          selectColumns: "2,4,3"
          computes:
            # Add SwitchModule ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: SwitchModule2-
        source(13):
          # SwitchModule Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.3.3.4.31.1
          selectColumns: "2,4,3"
          computes:
            # Add SwitchModule ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: SwitchModule3-
        source(14):
          # SwitchModule Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.3.4.4.31.1
          selectColumns: "2,4,3"
          computes:
            # Add SwitchModule ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: SwitchModule4-
        source(15):
          # Unite the Temperatures
          # ID;Status;Value;
          type: tableUnion
          tables:
          - "${source::monitors.temperature.discovery.sources.source(1)}"
          - "${source::monitors.temperature.discovery.sources.source(2)}"
          - "${source::monitors.temperature.discovery.sources.source(3)}"
          - "${source::monitors.temperature.discovery.sources.source(4)}"
          - "${source::monitors.temperature.discovery.sources.source(5)}"
        source(16):
          type: tableUnion
          tables:
          - "${source::monitors.temperature.discovery.sources.source(6)}"
          - "${source::monitors.temperature.discovery.sources.source(7)}"
          - "${source::monitors.temperature.discovery.sources.source(8)}"
          - "${source::monitors.temperature.discovery.sources.source(9)}"
          - "${source::monitors.temperature.discovery.sources.source(10)}"
        source(17):
          type: tableUnion
          tables:
          - "${source::monitors.temperature.discovery.sources.source(11)}"
          - "${source::monitors.temperature.discovery.sources.source(12)}"
          - "${source::monitors.temperature.discovery.sources.source(13)}"
          - "${source::monitors.temperature.discovery.sources.source(14)}"
        source(18):
          type: tableUnion
          tables:
          - "${source::monitors.temperature.discovery.sources.source(15)}"
          - "${source::monitors.temperature.discovery.sources.source(16)}"
          - "${source::monitors.temperature.discovery.sources.source(17)}"
          computes:
            # Keep only Temperature that are valid or invalid (not unknown)
            # ID;Status;Value;
          - type: keepOnlyMatchingLines
            column: 2
            valueList: "1,2"
            # Remove Temperatures of 0
            # ID;Status;Value;
          - type: leftConcat
            column: 3
            value: MSHW_
          # Remove 0 value
          - type: replace
            column: 3
            existingValue: MSHW_0
            newValue: ""
          # Remove MSHW_ for non 0 values
          - type: replace
            column: 3
            existingValue: MSHW_
            newValue: ""
      mapping:
        # InstanceTable = Source(18)
        # ID;Status;Value;
        source: "${source::monitors.temperature.discovery.sources.source(18)}"
        attributes:
          id: $1
          __display_id: $1
          hw.parent.type: enclosure
          name: $1
        conditionalCollection:
          hw.temperature: $3
    collect:
      # Collect type is "multi-instance
      type: multiInstance
      keys:
      - id
      sources:
        source(1):
          # Blade Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.1.4.41.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade1-
        source(2):
          # Blade Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.2.4.41.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade2-
        source(3):
          # Blade Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.3.4.41.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade3-
        source(4):
          # Blade Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.4.4.41.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade4-
        source(5):
          # Blade Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.5.4.41.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade5-
        source(6):
          # Blade Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.6.4.41.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade6-
        source(7):
          # Blade Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.7.4.41.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade7-
        source(8):
          # Blade Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.1.8.4.41.1
          selectColumns: "2,4,3"
          computes:
            # Add Blade ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: Blade8-
        source(9):
          # ManagementModule Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.2.1.4.31.1
          selectColumns: "2,4,3"
          computes:
            # Add ManagementModule ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: ManagementModule1-
        source(10):
          # ManagementModule Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.2.2.4.31.1
          selectColumns: "2,4,3"
          computes:
            # Add ManagementModule ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: ManagementModule2-
        source(11):
          # SwitchModule Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.3.1.4.31.1
          selectColumns: "2,4,3"
          computes:
            # Add SwitchModule ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: SwitchModule1-
        source(12):
          # SwitchModule Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.3.2.4.31.1
          selectColumns: "2,4,3"
          computes:
            # Add SwitchModule ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: SwitchModule2-
        source(13):
          # SwitchModule Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.3.3.4.31.1
          selectColumns: "2,4,3"
          computes:
            # Add SwitchModule ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: SwitchModule3-
        source(14):
          # SwitchModule Temperature
          # ID;Status;Value;
          type: snmpTable
          oid: 1.3.6.1.4.1.116.5.52.1.2.3.4.4.31.1
          selectColumns: "2,4,3"
          computes:
            # Add SwitchModule ID
            # ID;Status;Value;
          - type: leftConcat
            column: 1
            value: SwitchModule4-
        source(15):
          # Unite the Temperatures
          # ID;Status;
          type: tableUnion
          tables:
          - "${source::monitors.temperature.collect.sources.source(1)}"
          - "${source::monitors.temperature.collect.sources.source(2)}"
          - "${source::monitors.temperature.collect.sources.source(3)}"
          - "${source::monitors.temperature.collect.sources.source(4)}"
          - "${source::monitors.temperature.collect.sources.source(5)}"
        source(16):
          type: tableUnion
          tables:
          - "${source::monitors.temperature.collect.sources.source(6)}"
          - "${source::monitors.temperature.collect.sources.source(7)}"
          - "${source::monitors.temperature.collect.sources.source(8)}"
          - "${source::monitors.temperature.collect.sources.source(9)}"
          - "${source::monitors.temperature.collect.sources.source(10)}"
        source(17):
          type: tableUnion
          tables:
          - "${source::monitors.temperature.collect.sources.source(11)}"
          - "${source::monitors.temperature.collect.sources.source(12)}"
          - "${source::monitors.temperature.collect.sources.source(13)}"
          - "${source::monitors.temperature.collect.sources.source(14)}"
        source(18):
          type: tableUnion
          tables:
          - "${source::monitors.temperature.collect.sources.source(15)}"
          - "${source::monitors.temperature.collect.sources.source(16)}"
          - "${source::monitors.temperature.collect.sources.source(17)}"
          computes:
            # Translate the State
            # ID;Status;Value;
          - type: translate
            column: 2
            translationTable: "${translation::validStatusTranslationTable}"
          # Divide Temp By 10
          - type: divide
            column: 3
            value: 10
      mapping:
        # ValueTable = Source(18)
        # ID;PatrolStatus;
        source: "${source::monitors.temperature.collect.sources.source(18)}"
        attributes:
          id: $1
        metrics:
          hw.status{hw.type="temperature"}: $2
          hw.temperature: $3
translations:
  bladeStatusTranslationTable:
    "1": ok
    "2": failed
    "3": UNKNOWN
    Default: UNKNOWN
  statusTranslationTable:
    "1": ok
    "2": failed
    "3": UNKNOWN
    Default: UNKNOWN
  validStatusTranslationTable:
    "1": failed
    "2": ok
    "3": UNKNOWN
    Default: UNKNOWN
  PowerStateTranslationTable:
    "1": "off"
    "2": "off"
    "3": "on"
    "4": ""
    "5": "off"
    "6": "off"
    Default: ""
