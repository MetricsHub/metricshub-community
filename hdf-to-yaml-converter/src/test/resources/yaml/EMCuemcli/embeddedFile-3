$1 ~ /[0-9]+:/ && $2 ~ /[Ii][Dd]/ {
    DeviceID = $1 ;DeviceID = $1 ; gsub (/:/,"",DeviceID) ;
    DisplayID[DeviceID] = $NF
    }

$1 ~ /[Hh]ealth/ && $2 ~ /[Ss]tate/ {
    HealthValue[DeviceID] = $NF ; gsub(/[()]/,"",HealthValue[DeviceID]) ;
      }

$1 ~ /[Uu]ser/ && $2 ~ /[Cc]apacity/ { Size[DeviceID] = $4 ; Size[DeviceID] = Size[DeviceID] / 1073741824 }

$1 ~ /[Pp]ool/ && $2 ~ /=/ { Pool[DeviceID] = $0 ; gsub (/.*= ?/,"",Pool[DeviceID]); Pool[DeviceID] = "Pool: " Pool[DeviceID] }

$1 ~ /[Mm]anufacturer/ && $NF !~ /=/ { Manufacturer[DeviceID] = $NF }

$1 ~ /[Mm]odel/ { Model[DeviceID] = $0 ; gsub (/.*= ?/,"",Model[DeviceID]); gsub (/ *$/,"",Model[DeviceID]); }

$1 ~ /[Pp]art/ && $2 ~ /[Nn]umber/ { PartNumber[DeviceID] = $0 ; gsub (/.*= ?/,"",PartNumber[DeviceID]);}

$1 ~ /[Ss]erial/ && $2 ~ /[Nn]umber/ { SerialNumber[DeviceID] = $NF }

$1 ~ /[Ff]irmware/ { Firmware[DeviceID] = $NF }

END { for (DeviceID in DisplayID) {
           if (DeviceID != "" && Size[DeviceID] != "0" ) {
             print "MSHW;" DeviceID ";" DisplayID[DeviceID] ";" HealthValue[DeviceID] ";" Size[DeviceID] ";"Pool[DeviceID] ";" Manufacturer[DeviceID] ";" Model[DeviceID] ";Part Number: " PartNumber[DeviceID] ";" SerialNumber[DeviceID] ";" Firmware[DeviceID] ";"
        }
        }
      }