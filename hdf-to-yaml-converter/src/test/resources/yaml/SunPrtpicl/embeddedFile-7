BEGIN { DeviceID = ""; Status = ""; Name = ""; ModelName = ""; Color = ""; Description = ""; OperationalStatus=""; Status = ""; }
($2 == "(led,") { DeviceID = substr($3, 1, length($3) - 1); }
($1 == ":Color") { Color = $2 }
($1 == ":ModelName") { ModelName = $2 }
($1 == ":Description") { Description = $2; for (i=3 ; i<=NF ; i++) { Description = Description " " $i; } }
($1 == ":OperationalStatus") { OperationalStatus = $2 }
($1 == ":State") { Status = $2; }
($1 == ":name") {
    Name = $2;

    if (Color == "<ERROR:")
    {
        Color = "";
    }
    if (Status == "<ERROR:")
    {
        Status = "UNKNOWN";
    }

    if (Color == "")
    {
        if (ModelName != "")
        {
            Color = ModelName;
        }
        else
        {
            Color = Name;
        }
    }
    if (Color ~ /FAULT/ || Color ~ /FAIL/) { Color = "FAULT"; }
    else if (Color ~ /ACT$/) { Color = "ACTIVITY"; }
    else if (Color ~ /LOCATE/) { Color = "LOCATE"; }
    else if (Color ~ /SERVICE/) { Color = "SERVICE"; }
    else if (Color ~ /OK/) { Color = "OK"; }

    if (Description == "" || Description ~ /Indicator/)
    {
        Description = Name;
    }

    if ((Status != "") && (DeviceID != "") && (OperationalStatus != "disabled"))
    {
        print "MSHW;" DeviceID ";" Description ";" Color ";" Status;
    }

    DeviceID = ""; Status = ""; Name = ""; ModelName = ""; Color = ""; Description = ""; OperationalStatus=""; Status = "";
}