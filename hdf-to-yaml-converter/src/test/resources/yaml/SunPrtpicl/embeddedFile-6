BEGIN {
    path = "";
      }
{
    name = $1;
    ID = substr($3, 1, length($3) - 1);
    className = substr($2, 2, length($2) - 2);

    depth = (index($0, name) - 1) / 4;
    if (depth < 0) { indent = 0; }

    split(path, pathArray, "/");
    path = "";
    for (i=1 ; i<depth ; i++)
    {
        path = path pathArray[i] "/";
    }
    path = path name;
    Output[path] = "MSHW;" ID ";" className ";" path ";"
        classNameArray[path] = className
        # Now build the rootpath for each class (but ensure that we have at least two strings and one slash in the eventual path).
        if ( rootpathindex[className] == "" ) {
                                               initialrootpath = path ; gsub("[^/]+/[^/]+$","",initialrootpath);
                                               rootpathindex[className] = length(initialrootpath);
                                               rootpath[className] = substr(path,1,rootpathindex[className]);
                                              }
                                         else { while ( substr(path,rootpathindex[className],1) != substr(rootpath[className],rootpathindex[className],1) ) {
                                                        rootpathindex[className] = rootpathindex[className] - 1
                                                        }
                                              }

}

END {
     for (path in Output) {
                           className=classNameArray[path];
                           displayID = substr(path,rootpathindex[className]+1);
                           print Output[path] displayID ";"
                          }
    }