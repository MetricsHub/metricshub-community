BEGIN {valid=""}

# Process instances
valid != "" && NF > 4 && $1 ~ /[A-Za-z]+[0-9]+/ {
    device = substr($0,deviceStart,deviceLength) ; gsub(/ +$/,"",device );
    up = substr($0,upStart,upLength) ; gsub(/ +$/,"",up);
    speed = substr($0,speedStart,speedLength ) ; gsub(/ +$/,"",speed);
    if (speed ~ /Mbit/) {  gsub(/ Mbit.*/,"",speed);  }
    else if (speed ~ /Gbit/) {  gsub(/ Gbit.*/,"",speed); speed = speed * 1000  }
    mac= substr($0,macStart) ; gsub(/ +$/,"",mac); gsub(/:/,"",mac); mac = toupper(mac);
    print "MSHW;" device ";" mac";" speed ";" device ";IP target;" up ";MAC;"
    }

# Check for header
$0 ~ /^ *DEVICE +UP +SPEED +MAC/ {
     valid="1"
     deviceStart = index($0,"DEVICE")
     upStart = index($0,"UP")
     speedStart = index($0,"SPEED")
     macStart = index($0,"MAC")
     deviceLength = upStart - deviceStart - 1
     upLength = speedStart - upStart - 1
     speedLength = macStart - speedStart - 1
    };