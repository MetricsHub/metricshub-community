echo "Retrieving disk devices"
diskList=`/usr/sbin/ioscan -kfnC disk|/bin/grep -e DEVICE -e /dev|/bin/awk '{
    if ($1 == "disk")
    {
        diskNumber = $2
        hardwarePath = $3
        rawDevicePath = ""
    }
    if ($2 ~ "^/dev/rdsk/")
    {
        deviceID = substr($2, 11)
        controllerIndex = match(hardwarePath, "\.[0-9]+\.[0-9]+$")
        if (diskNumber != "" && hardwarePath != "" && controllerIndex > 0)
        {
            controllerID = substr(hardwarePath, 1, controllerIndex - 1)
            print diskNumber ";" controllerID ";" deviceID
        }
        deviceID = ""
        deviceNumber = ""
        hardwarePath = ""
    }
}'`

for diskInformation in $diskList
do
deviceID=`/bin/echo $diskInformation|/bin/awk -F";" '{print $3}'`
%{SUDO:/usr/sbin/diskinfo}/usr/sbin/diskinfo /dev/rdsk/$deviceID|/bin/awk -v diskInformation=$diskInformation '{
    if ($0 ~ "^SCSI describe of /dev/rdsk")
    {
        vendor = ""
        productID = ""
        type = "";
        size = "";
    }

    if ($1 == "vendor:")
    {
        vendor = $2
    }

    if ($1 == "product" && $2 == "id:")
    {
        productID = $3
    }

    if ($1 == "type:")
    {
        type = $2 " " $3
    }

    if ($1 == "size:")
    {
        size = $2
        if (type == "direct access" && vendor != "" && productID != "" && size > 0)
        {
            printf("MSHW;%s;%s;%.0f\n", diskInformation, vendor " " productID, size*1024)
        }
    }
}'
done