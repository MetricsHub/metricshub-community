<?xml version="1.0" encoding="UTF-8"?>
<Configuration status="WARN">
	<Properties>
		<Property name="baseDir">logs</Property>
	</Properties>
	<Appenders>
		<Console name="Console" target="SYSTEM_OUT">
			<PatternLayout disableAnsi="false"
				pattern="%highlight{[%date{ISO8601}][%-5level][%logger{1.}] %m%n}{FATAL=red blink, ERROR=red, WARN=yellow bold, INFO=cyan, DEBUG=green bold, TRACE=blue}" />
		</Console>
		<Routing name="Routing">
			<Routes pattern="$${ctx:debugMode}">
				<!-- This route is chosen if ThreadContext has debugMode = true. -->
				<Route key="true">
					<RollingFile name="Rolling-${ctx:targetId}"
						fileName="${baseDir}/hardware-sentry-prometheus-${ctx:port}-${ctx:targetId}-${date:yyyy-MM-dd}.log"
						filePattern="${baseDir}/${date:yyyy-MM}/hardware-sentry-prometheus-${ctx:port}-${ctx:targetId}-%d{yyyy-MM-dd}-%i.log.gz">
						<PatternLayout pattern="[%date{ISO8601}][%-5level][%logger{1.}] %m%n" />
						<Policies>
							<TimeBasedTriggeringPolicy />
							<SizeBasedTriggeringPolicy size="30 MB" />
						</Policies>
						<DefaultRolloverStrategy>
							<Delete basePath="${baseDir}" maxDepth="3">
								<IfFileName glob="*/*hardware-sentry-prometheus*.log.gz" />
								<IfLastModified age="2d" />
							</Delete>
						</DefaultRolloverStrategy>
					</RollingFile>
				</Route>
			</Routes>
		</Routing>
	</Appenders>
	<Loggers>
		<logger name="com.sentrysoftware" level="trace">
			<appender-ref ref="Routing" />
		</logger>
		<Root level="info">
			<AppenderRef ref="Console" />
		</Root>
	</Loggers>
</Configuration>